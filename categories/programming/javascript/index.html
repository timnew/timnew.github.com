<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Catégorie: JavaScript | ThoughtWorkshop</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="timnew programming code software">
<meta property="og:type" content="website">
<meta property="og:title" content="ThoughtWorkshop">
<meta property="og:url" content="http://timnew.me/categories/programming/javascript/index.html">
<meta property="og:site_name" content="ThoughtWorkshop">
<meta property="og:description" content="timnew programming code software">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ThoughtWorkshop">
<meta name="twitter:description" content="timnew programming code software">
<meta name="twitter:creator" content="@timnew">
<link rel="publisher" href="108780866821209050000">
  
    <link rel="alternate" href="/atom.xml" title="ThoughtWorkshop" type="application/atom+xml">
  
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
<link rel="icon" type="image/png" href="/favicon-196x196.png" sizes="196x196">
<link rel="icon" type="image/png" href="/favicon-160x160.png" sizes="160x160">
<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-TileImage" content="/mstile-144x144.png">

  <!-- <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css"> -->
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-30567867-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">ThoughtWorkshop</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Digital Bigs in my thought</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/#main">Home</a>
        
          <a class="main-nav-link" href="/archives/">Archives</a>
        
          <a class="main-nav-link" href="/photos/500px.html">Photos</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="Flux RSS"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Rechercher"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://timnew.me"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-a-clean-way-to-test-rejected-promise" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2015/08/14/a-clean-way-to-test-rejected-promise/" class="article-date">
  <time datetime="2015-08-14T08:08:53.000Z" itemprop="datePublished">2015-08-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/javascript/">JavaScript</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2015/08/14/a-clean-way-to-test-rejected-promise/">A clean way to test rejected promise</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>To test the the exception in a rejected promise could be a little bit painful.</p>
<p>And <a href="https://mochajs.org/" target="_blank" rel="external">Mocha</a> is Promise-friendly, which means it fails the test if exception is not caught.</p>
<p>So as a result, here is a simple code example to explain how it is being done:</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">it <span class="string">'should throw session-expired exception'</span></span><br><span class="line">  <span class="keyword">new</span> Session().generateId().bindUserFromRedis()</span><br><span class="line">  .<span class="keyword">then</span> -&gt;</span><br><span class="line">    <span class="literal">null</span></span><br><span class="line">  .<span class="keyword">catch</span> (ex) -&gt;</span><br><span class="line">    ex</span><br><span class="line">  .<span class="keyword">then</span> (ex) -&gt;</span><br><span class="line">    expect(ex).to.be.<span class="keyword">instanceof</span>(ResponseError)</span><br><span class="line">              .<span class="keyword">and</span>.that.have.property(<span class="string">'errorName'</span>, <span class="string">'session-expired'</span>)</span><br></pre></td></tr></table></figure>
<hr>

<p><strong>Update:</strong> A Chai Plugin can mitigate the pain</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'should throw session-expired exception'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> expect(<span class="keyword">new</span> Session().generateId().bindUserFromRedis())</span><br><span class="line">           .to.evetually.rejected</span><br><span class="line">              .and.that.have.property(<span class="string">'errorName'</span>, <span class="string">'session-expired'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><strong>Update 2:</strong> With async, it can be converted into normal test<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'should throw session-expired exception'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> expect(<span class="keyword">async</span> () =&gt; <span class="keyword">await</span> <span class="keyword">new</span> Session().generateId().bindUserFromRedis())</span><br><span class="line">          .to.throw</span><br><span class="line">             .and.that.have.property(<span class="string">'errorName'</span>, <span class="string">'session-expired'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2015/08/14/a-clean-way-to-test-rejected-promise/" data-id="cinedk75w009ochsi769t2qkr" class="article-share-link">Partager</a>
      
        <a href="http://timnew.me/blog/2015/08/14/a-clean-way-to-test-rejected-promise/#disqus_thread" class="article-comment-link">Commentaires</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mocha/">Mocha</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/promise/">Promise</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/test/">Test</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-javascript-prototype-chain-mutator" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2014/07/30/javascript-prototype-chain-mutator/" class="article-date">
  <time datetime="2014-07-30T00:00:00.000Z" itemprop="datePublished">2014-07-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/javascript/">JavaScript</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2014/07/30/javascript-prototype-chain-mutator/">JavaScript Prototype Chain Mutator</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>In JavaScript world, JSON serialization is widely used. When fetching data from server via Ajax, the data is usually represented in JSON; or loading configuration/data from file in Node.js application, the configuration/data is usually in JSON format.</p>
<p>JSON serialization is powerful and convenient, but there is limitation. For security and other reason, behavior and type information are forbidden in JSON. Functions members are removed when stringify a JavaScript object, also functions are not allowed in JSON.</p>
<p>Comparing Yaml to Ruby, this limitation isn’t that convenient when writing JavaScript application. For example, to consume the JSON data fetched via ajax from server, I really wish I can invoke some method on the deserialized model.</p>
<p>Here is simple example:</p>
<figure class="highlight coffeescript"><figcaption><span>Ideal World</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rect</span></span></span><br><span class="line">  constructor: <span class="function"><span class="params">(width, height)</span> -&gt;</span></span><br><span class="line">    @width = width <span class="keyword">if</span> width?</span><br><span class="line">    @height = height <span class="keyword">if</span> height?</span><br><span class="line"></span><br><span class="line">  area: <span class="function">-&gt;</span></span><br><span class="line">    @width * @height</span><br><span class="line"></span><br><span class="line">$.get <span class="string">'/rect/latest'</span>, <span class="function"><span class="params">(rectJSON)</span> -&gt;</span>  </span><br><span class="line">  rect = JSON.parse(rectJSON)</span><br><span class="line">  <span class="built_in">console</span>.log rect.area() <span class="comment"># This code doesn't work because there is rect is a plain object</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>The code doesn’t work, because <code>rect</code> in a plain object, which doesn’t contains any behavior. Someone called the rect <code>DTO</code>, Data Transfer Object, or POJO, Plain Old Java Object, a concept borrowed from Java world. Here we call it <code>DTO</code>.</p>
<p>To add behaviors to <code>DTO</code>, there are variant approaches. Such as create a behavior wrapper around the <code>DTO</code>, or create a new model with behavior and copy all the data from <code>DTO</code> to model. These practices are borrowed from Java world, or traditional Object Oriented world.</p>
<p>In fact, in JavaScript, there could be a better and smarter way to achieve that: <code>Object Mutation</code>, altering object prototype chain on the fly to convert a object into the instance of a specific type. The process is really similar to biologic genetic mutation, converting a species into another by altering the gene, so I borrow the term <code>mutation</code>.</p>
<p>With the idea, we can achieve this:</p>
<figure class="highlight coffeescript"><figcaption><span>Mutate rect with Mutator</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rect</span></span></span><br><span class="line">  constructor: <span class="function"><span class="params">(width, height)</span> -&gt;</span></span><br><span class="line">    @width = width <span class="keyword">if</span> width?</span><br><span class="line">    @height = height <span class="keyword">if</span> height?</span><br><span class="line"></span><br><span class="line">  area: <span class="function">-&gt;</span></span><br><span class="line">    @width * @height</span><br><span class="line"></span><br><span class="line">$.get <span class="string">'/rect/latest'</span>, <span class="function"><span class="params">(rectJSON)</span> -&gt;</span>  </span><br><span class="line">  rect = JSON.parse(rectJSON)</span><br><span class="line"></span><br><span class="line">  mutate(rect, Rect)</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log rect.area()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>The key to implement <code>mutate</code> function is to simulate <code>new</code> operator behavior, alerting <code>object.__proto__</code> and apply <code>constructor</code> to the instance! For more detail, check out the library <a href="https://github.com/timnew/mutator" target="_blank" rel="external">mutator</a> <a href="https://github.com/timnew/mutator" target="_blank" rel="external"><img src="https://badge.fury.io/bo/widget.coffee.svg" alt="Bower version"></a> <a href="https://www.npmjs.org/package/mutator" target="_blank" rel="external"><img src="http://img.shields.io/npm/v/mutator.svg" alt="NPM version"></a>, which is available as both <code>NPM</code> package and <code>bower</code> package.</p>
<p>When implementing the <code>mutator</code>, in IE, again, in the evil IE, the idea doesn’t work. Before IE 11, JavaScript prototype chain for instance is not accessible. There is nothing equivalent to <code>object.__proto__</code> in IE 10 and prior. The most similar workaround is doing a hard-copy of all the members, but it still fails in type check and some dynamical usage.</p>
<p><strong>Background</strong></p>
<blockquote>
<p><code>object.__proto__</code> is a Mozilla “private” implementation until EcmaScript 6.<br>It is interesting that most JavaScript support it except IE.<br>Luckily, IE 11 introduced some features in EcmaScript 6, <code>object.__proto__</code> is one of them.</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2014/07/30/javascript-prototype-chain-mutator/" data-id="cinedk74r007ochsi1dh8h5tf" class="article-share-link">Partager</a>
      
        <a href="http://timnew.me/blog/2014/07/30/javascript-prototype-chain-mutator/#disqus_thread" class="article-comment-link">Commentaires</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ajax/">ajax</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bower/">bower</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/browser/">browser</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/class/">class</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/inheritance/">inheritance</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/json/">json</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mutation/">mutation</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mutator/">mutator</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/node-js/">node.js</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/npm/">npm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/prototype/">prototype</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-upgrading-dsl-from-coffeescript-to-json-part-1-migrator" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2014/05/11/upgrading-dsl-from-coffeescript-to-json-part-1-migrator/" class="article-date">
  <time datetime="2014-05-11T00:00:00.000Z" itemprop="datePublished">2014-05-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/javascript/">JavaScript</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2014/05/11/upgrading-dsl-from-coffeescript-to-json-part-1-migrator/">Upgrading DSL from CoffeeScript to JSON: Part.1. Migrator</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>I’m working on the Harvester-AdKiller version 2 recently. Version 2 dropped the idea “Code as Configuration”, because the nature of Chrome Extension. Recompiling and reloading the extension every time when configuration changed is the pain in the ass for me as an user.</p>
<p>For security reason, Chrome Extension disabled all the Javascript runtime evaluation features, such as <code>eval</code> or <code>new Function(&#39;code&#39;)</code>. So that it become almost impossible to edit code as data, and later applied it on the fly.</p>
<p>Thanks to the version 1, the feature and DSL has almost fully settled, little updates needed in the near future. So I can use a less flexible language as the DSL instead of CoffeeScript.</p>
<p>Finally I decided to replace CoffeeScript to JSON, which can be easily edited and applied on the fly.</p>
<p>After introducing JSON DSL, to enable DSL upgrading in the future, an migration system become important and urgent. (Actually, this prediction is so solid. I have changed the JSON schema once today.) So I come up a new migration system:</p>
<figure class="highlight coffeescript"><figcaption><span>Upgrader</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Upgrader</span></span></span><br><span class="line">  constructor: <span class="function">-&gt;</span></span><br><span class="line">    @execute()</span><br><span class="line"></span><br><span class="line">  execute: <span class="function">=&gt;</span></span><br><span class="line">    <span class="built_in">console</span>.log <span class="string">"[Upgrader] Current Version: <span class="subst">#&#123;Configuration.version&#125;</span>"</span></span><br><span class="line">    migrationName = <span class="string">"<span class="subst">#&#123;Configuration.version&#125;</span>"</span></span><br><span class="line">    migration = <span class="keyword">this</span>[migrationName]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">unless</span> migration?</span><br><span class="line">      <span class="built_in">console</span>.log <span class="string">'[Upgrader] Latest version, no migration needed.'</span></span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log <span class="string">"[Upgrader] Migration needed..."</span></span><br><span class="line">    migration.call(<span class="keyword">this</span>, @execute)</span><br><span class="line"></span><br><span class="line">  <span class="string">'undefined'</span>: <span class="function"><span class="params">(done)</span> -&gt;</span></span><br><span class="line">    <span class="built_in">console</span>.log <span class="string">"[Upgrader] Load data from seed..."</span></span><br><span class="line">    Configuration.resetDataFromSeed(done)</span><br><span class="line"></span><br><span class="line">  <span class="string">'1.0'</span>: <span class="function"><span class="params">(done)</span> -&gt;</span></span><br><span class="line">    <span class="built_in">console</span>.log <span class="string">"[Upgrader] Migrating configuration schema from 1.0 to 1.1..."</span></span><br><span class="line">    <span class="comment"># Do the migration logic here</span></span><br><span class="line">    done()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>The <code>Upgrader</code> will be instantiate when extension started, after <code>Configuration</code> is initialized, which holds the DSL data for runtime usage.</p>
<p>When the <code>execute</code> method is invoked, it check the current version, and check is there a upgrading method match to this version. If yes, it triggers the migration; otherwise it succeed the migration. Each time a migration process is completed, it re-trigger <code>execute</code> method for another round of check.</p>
<p>Adding migration for a specific version of schema is quite simple. Just as method <code>1.0</code> does, declaring a method with the version number in the <code>Upgrader</code>.</p>
<p><code>&#39;undefined&#39;</code> method is a special migration method, which is invoked there is no previous configuration found. So I initialize the configuration from seed data json file, which is generated from the version 1 DSL.</p>
<p>The seed data generation is also an interesting topic. Please refer to <a href="/blog/2014/05/11/upgrading-dsl-from-coffeescript-to-json-part-dot-2-redefine-dsl-behavior">next post(Redfine DSL behavior)</a> of this series for details.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2014/05/11/upgrading-dsl-from-coffeescript-to-json-part-1-migrator/" data-id="cinedk741006lchsicrvkn47p" class="article-share-link">Partager</a>
      
        <a href="http://timnew.me/blog/2014/05/11/upgrading-dsl-from-coffeescript-to-json-part-1-migrator/#disqus_thread" class="article-comment-link">Commentaires</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/coffeescript/">coffeescript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dsl/">dsl</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/json/">json</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/language/">language</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/migration/">migration</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/schema/">schema</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/update/">update</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/upgrading/">upgrading</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-upgrading-dsl-from-coffeescript-to-json-part-2-redefine-dsl-behavior" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2014/05/11/upgrading-dsl-from-coffeescript-to-json-part-2-redefine-dsl-behavior/" class="article-date">
  <time datetime="2014-05-11T00:00:00.000Z" itemprop="datePublished">2014-05-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/javascript/">JavaScript</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2014/05/11/upgrading-dsl-from-coffeescript-to-json-part-2-redefine-dsl-behavior/">Upgrading DSL From CoffeeScript to JSON: Part.2. Redefine DSL behavior</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>This is the second post in this series, <a href="/blog/2014/05/11/upgrade-dsl-from-coffeescript-to-json-part-1-migrator">previous one</a> discussed the JSON schema migration mechanism.</p>
<p>After finish JSON DSL implementation, the No.1 problem I need to handle is how to upgrading the configuration in CoffeeScript to JSON format.</p>
<p>One of the solutions is to do it manually. Well, it is possible, but… JSON isn’t a language really designed for human, composing configuration for 50+ sites doesn’t sound like a pleasant work for me. Even when I finished it, how can I ensure all the configuration is properly upgraded? The sun is bright today, I don’t want to waste whole afternoon in front of the computer checking the JSON. In one word, I’m lazy…</p>
<p>Since most of the change of DSL is happened on representation instead of structure. So in most cases, there is 1-to-1 mapping between v1 DSL and v2 DSL. So maybe I can generate the most of v2 DSL by using V1 DSL! Then manually handle some exceptions.</p>
<p>Here is a snippet of V1 DSL</p>
<figure class="highlight coffeescript"><figcaption><span>Ver 1 DSL snippet</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">AdKiller.run -&gt;</span><br><span class="line"></span><br><span class="line">  @host <span class="string">'imagetwist.com'</span>, <span class="function">-&gt;</span></span><br><span class="line">    @clean(<span class="string">'#myad'</span>, <span class="string">'#popupOverlay'</span>)</span><br><span class="line">    @revealImg(<span class="string">'.pic'</span>)</span><br><span class="line"></span><br><span class="line">  @host <span class="string">'yankoimages.net'</span>, <span class="function">-&gt;</span></span><br><span class="line">    @clean(<span class="string">'#firopage'</span>)</span><br><span class="line">    @revealImg(<span class="string">'img'</span>)</span><br><span class="line"></span><br><span class="line">  @host <span class="string">'imageback.info'</span>, <span class="string">'imagepong.info'</span>, <span class="string">'imgking.us'</span>, <span class="string">'imgabc.us'</span>, <span class="function">-&gt;</span></span><br><span class="line">    @revealA(<span class="string">'.text_align_center a'</span>)</span><br><span class="line"></span><br><span class="line">  @host <span class="string">'imgserve.net'</span>,</span><br><span class="line">    <span class="string">'imgcloud.co'</span>,</span><br><span class="line">    <span class="string">'hosterbin.com'</span>,</span><br><span class="line">    <span class="string">'myhotimage.org'</span>,</span><br><span class="line">    <span class="string">'img-zone.com'</span>,</span><br><span class="line">    <span class="string">'imgtube.net'</span>,</span><br><span class="line">    <span class="string">'pixup.us'</span>,</span><br><span class="line">    <span class="string">'imgcandy.net'</span>,</span><br><span class="line">    <span class="string">'croftimage.com'</span>,</span><br><span class="line">    <span class="string">'www.imagefolks.com'</span>,</span><br><span class="line">    <span class="string">'imgcloud.co'</span>,</span><br><span class="line">    <span class="string">'imgmoney.com'</span>,</span><br><span class="line">    <span class="string">'imagepicsa.com'</span>,</span><br><span class="line">    <span class="string">'imagecorn.com'</span>,</span><br><span class="line">    <span class="string">'imgcorn.com'</span>,</span><br><span class="line">    <span class="string">"imgboo.me"</span>,</span><br><span class="line">    <span class="string">'imgrim.com'</span>,</span><br><span class="line">    <span class="string">'imgdig.com'</span>,</span><br><span class="line">    <span class="string">'imgnext.com'</span>,</span><br><span class="line">    <span class="string">'hosturimage.com'</span>,</span><br><span class="line">    <span class="string">'image-gallery.us'</span>,</span><br><span class="line">    <span class="string">'imgmaster.net'</span>,</span><br><span class="line">    <span class="string">'img.spicyzilla.com'</span>,</span><br><span class="line">    <span class="string">'bulkimg.info'</span>,</span><br><span class="line">    <span class="string">'pic.apollon-fervor.com'</span>,</span><br><span class="line">    <span class="string">'08lkk.com'</span>,</span><br><span class="line">    <span class="string">'damimage.com'</span>,</span><br><span class="line">    <span class="function">-&gt;</span></span><br><span class="line">      @click(<span class="string">'#continuetoimage input'</span>)</span><br><span class="line">      @clean(<span class="string">'#logo'</span>)</span><br><span class="line">      @safeRevealImg(<span class="string">'#container img[class]'</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>In version 1 implementation, <code>@host</code> defines the sites. And in the block of <code>@host</code> method, <code>@click</code>, <code>@clean</code>, <code>@revealImg</code> methods define the actions for the sites. The <code>@host</code> method instantiate new instance of <code>Cleaner</code>. The code block is invoked when cleaner is triggered, which does the actually cleaning.</p>
<p>Now I want to keep this file, since it shares the configuration between version 1 and version 2. And I redefine the behaviors of the cleaning method, such as <code>@clean</code>, <code>@click</code>, etc., I generate the JSON data when it is invoked instead of really altering the DOM. So I got this:</p>
<figure class="highlight coffeescript"><figcaption><span>seed_data_generator</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env coffee</span></span><br><span class="line"></span><br><span class="line">fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line">AdKiller =</span><br><span class="line">  run: <span class="function"><span class="params">(block)</span> -&gt;</span></span><br><span class="line">    @scripts = &#123;&#125;</span><br><span class="line">    @hosts = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    block.call(<span class="keyword">this</span>)</span><br><span class="line"></span><br><span class="line">    fs.writeFileSync <span class="string">'seed_data.json'</span>, JSON.stringify(&#123;version: <span class="number">1</span>, @hosts, @scripts&#125;)</span><br><span class="line"></span><br><span class="line">  host: <span class="function"><span class="params">(hosts..., block)</span> -&gt;</span></span><br><span class="line">    @currentScript = []</span><br><span class="line">    scriptId = hosts[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    @scripts[scriptId] = @currentScript</span><br><span class="line">    <span class="keyword">for</span> host <span class="keyword">in</span> hosts</span><br><span class="line">      @hosts[host] = scriptId</span><br><span class="line"></span><br><span class="line">    block.call(<span class="keyword">this</span>)</span><br><span class="line"></span><br><span class="line">  remove: <span class="function"><span class="params">(selectors...)</span> -&gt;</span></span><br><span class="line">    selectors.unshift <span class="string">'remove'</span></span><br><span class="line">    @currentScript.push selectors</span><br><span class="line"></span><br><span class="line">  clean: <span class="function"><span class="params">(selectors...)</span> -&gt;</span> <span class="comment"># Backward compatibility</span></span><br><span class="line">    selectors.unshift <span class="string">'remove'</span></span><br><span class="line">    @currentScript.push selectors</span><br><span class="line"></span><br><span class="line">  hide: <span class="function"><span class="params">(selectors...)</span> -&gt;</span></span><br><span class="line">    selectors.unshift <span class="string">'clean'</span></span><br><span class="line">    @currentScript.push selectors</span><br><span class="line"></span><br><span class="line">  click: <span class="function"><span class="params">(selector)</span> -&gt;</span></span><br><span class="line">    @currentScript.push [<span class="string">'click'</span>, selector]</span><br><span class="line"></span><br><span class="line">  revealA: <span class="function"><span class="params">(selector)</span> -&gt;</span></span><br><span class="line">    @currentScript.push [<span class="string">'revealA'</span>, selector]</span><br><span class="line"></span><br><span class="line">  revealImg: <span class="function"><span class="params">(selector)</span> -&gt;</span></span><br><span class="line">    @currentScript.push [<span class="string">'revealImg'</span>, selector]</span><br><span class="line"></span><br><span class="line">  safeRevealA: <span class="function"><span class="params">(selector)</span> -&gt;</span></span><br><span class="line">    @currentScript.push [<span class="string">'safeRevealA'</span>, selector]</span><br><span class="line"></span><br><span class="line">  safeRevealImg: <span class="function"><span class="params">(selector)</span> -&gt;</span></span><br><span class="line">    @currentScript.push [<span class="string">'safeRevealImg'</span>, selector]</span><br><span class="line"></span><br><span class="line">AdKiller.run -&gt;</span><br><span class="line">  @host <span class="string">'imagetwist.com'</span>, <span class="function">-&gt;</span></span><br><span class="line">    @clean(<span class="string">'#myad'</span>, <span class="string">'#popupOverlay'</span>)</span><br><span class="line">    @revealImg(<span class="string">'.pic'</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment"># ...</span></span><br></pre></td></tr></table></figure>
<p>So now I can easily invoking this piece of code, to convert verion 1 DSL to JSON format.</p>
<p>DSL behavior redefinition is a super powerful trick, we used it on JSON parsing, validation, and generation before on PlayUp project. Which saved us tons of time from writing boring code.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2014/05/11/upgrading-dsl-from-coffeescript-to-json-part-2-redefine-dsl-behavior/" data-id="cinedk742006ochsiffcm1t7u" class="article-share-link">Partager</a>
      
        <a href="http://timnew.me/blog/2014/05/11/upgrading-dsl-from-coffeescript-to-json-part-2-redefine-dsl-behavior/#disqus_thread" class="article-comment-link">Commentaires</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/coffeescript/">coffeescript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dsl/">dsl</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/json/">json</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/language/">language</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/upgrading/">upgrading</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-some-tricky-ways-to-calculate-integer-in-javascript" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2013/02/24/some-tricky-ways-to-calculate-integer-in-javascript/" class="article-date">
  <time datetime="2013-02-24T00:00:00.000Z" itemprop="datePublished">2013-02-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/javascript/">JavaScript</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2013/02/24/some-tricky-ways-to-calculate-integer-in-javascript/">Some tricky ways to calculate integer in javascript</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Javascript is famous for its lack of preciseness, so it always surprises and make joke with the developers by breaking the common sense or instinct.</p>
<p>Javascript doesn’t provide <code>integer</code> type, but in daily life, <code>integer</code> sometimes is necessary, then how can we convert a trim a float number into integer in Javascript?<br>Some very common answers might be <code>Math.floor</code>, <code>Math.round</code> or even <code>parseInt</code>. But besides calling Math functions, is there any other answer?</p>
<p>The answer is bitwise operations. Amazing? Yes. Because bitwise operations are usually only applied to integers, so Javascript will try to convert the <code>number</code> into <code>&quot;integer&quot;</code> internally when a bitwise operation is applied, even it is still represented in type of <code>number</code></p>
<p>Suppose <code>value = 3.1415926</code>, and we want <code>integer</code> is the trimmed value of <code>value</code>, then we can have:</p>
<figure class="highlight js"><figcaption><span>Trim Float Number</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> value = <span class="number">3.1415926</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> integer = <span class="built_in">Math</span>.floor(value);</span><br><span class="line">integer = <span class="built_in">Math</span>.round(value);</span><br><span class="line">integer = <span class="built_in">parseInt</span>(value);</span><br><span class="line">integer = ~~value; <span class="comment">// Bitwise NOT</span></span><br><span class="line">integer = value | <span class="number">0</span>; <span class="comment">// Bitwise OR</span></span><br><span class="line">integer = value &lt;&lt; <span class="number">0</span>; <span class="comment">// Left Shift</span></span><br><span class="line">integer = value &gt;&gt; <span class="number">0</span>; <span class="comment">// Sign-propagating Right Shift</span></span><br><span class="line">integer = value &gt;&gt;&gt; <span class="number">0</span>; <span class="comment">// Zero-fill Right Shift</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>For more detail information about bitwise operation in javascript, please check out the <a href="https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Bitwise_Operators" target="_blank" rel="external">MDN document</a></p>
<p>All approaches listed before are working, but with different performance. And according to the result from <a href="http://jsperf.com/math-floor-vs-math-round-vs-parseint/42" target="_blank" rel="external">JsPerf</a>, I sort the algorithms by performance from good to bad:</p>
<ol>
<li><code>integer = ~~value;</code></li>
<li><code>integer = value &gt;&gt;&gt; 0;</code> and <code>integer = value &lt;&lt; 0;</code></li>
<li><code>integer = Math.floor(value);</code></li>
<li><code>integer = value &gt;&gt; 0;</code></li>
<li><code>integer = value | 0;</code></li>
<li><code>integer = Math.round(value);</code></li>
<li><code>integer = parseInt(value);</code></li>
</ol>
<p>NOTE: The test cases are running in Chrome 24.0.1312.57 on Mac OS X 10.8.2</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2013/02/24/some-tricky-ways-to-calculate-integer-in-javascript/" data-id="cinedk72s004jchsibflk3aam" class="article-share-link">Partager</a>
      
        <a href="http://timnew.me/blog/2013/02/24/some-tricky-ways-to-calculate-integer-in-javascript/#disqus_thread" class="article-comment-link">Commentaires</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bitwise/">bitwise</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/calculation/">calculation</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/integer/">integer</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/trick/">trick</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-negative-index-in-coffee-script" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2012/05/29/negative-index-in-coffee-script/" class="article-date">
  <time datetime="2012-05-29T00:00:00.000Z" itemprop="datePublished">2012-05-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/javascript/">JavaScript</a>►<a class="article-category-link" href="/categories/programming/javascript/coffeescript/">CoffeeScript</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2012/05/29/negative-index-in-coffee-script/">Negative Index in Coffee-Script</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Coffee Script borrowed quite a lot syntax patterns from both Ruby and Python, especially from Ruby.<br>So people, like me, usually tends to write coffee-script in ruby way.</p>
<p>In ruby, we can retrieve the element in an array in reversed order by using a negative index, which means <code>array[-1]</code> returns the last element in the array. This grammar sugar is really convenient and powerful, so we can omit the code like this <code>array[array.length - 1]</code>.</p>
<p>But for some reason, coffee-script doesn’t inherit this syntax. To me, it is weird. But after analyze this problem in detail, I found the reason.<br>Coffee script announce it has a golden rule: “coffee-script is just javascript”. So all the coffee script must be able to compiled into javascript.</p>
<p>Let’s try to analyze how the coffee script is compiled into javascript:</p>
<figure class="highlight coffeescript"><figcaption><span>Coffee Script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">array = [<span class="number">1.</span><span class="number">.10</span>]</span><br><span class="line">second = array[<span class="number">1</span>]</span><br><span class="line">last = array[<span class="number">-1</span>] <span class="regexp">//</span> Psudocode</span><br></pre></td></tr></table></figure>
<p>Obviously, the previous code should be compiled as following:</p>
<figure class="highlight js"><figcaption><span>JavaScript</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> array, last, second;</span><br><span class="line">array = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>];</span><br><span class="line">second = array[<span class="number">1</span>];</span><br><span class="line">last = array[array.length - <span class="number">1</span>];</span><br></pre></td></tr></table></figure>
<p>The negative index should be processed specially, so we should check the index is negative or not while compiling. This translation seems easy but actually not, since we can and usually use variable as the index.</p>
<figure class="highlight coffeescript"><figcaption><span>Variable as index</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">array = [<span class="number">1.</span><span class="number">.10</span>]</span><br><span class="line">index = <span class="number">1</span></span><br><span class="line">second = array[index]</span><br><span class="line">index = -index</span><br><span class="line">last = array[index]</span><br></pre></td></tr></table></figure>
<p>In the previous code, because we use the variable as index, which cannot be verified in compile-time, which means we need to compile the array reference code as following:</p>
<figure class="highlight js"><figcaption><span>Compile Result</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> array, index, last, second;</span><br><span class="line">array = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>];</span><br><span class="line">index = <span class="number">1</span>;</span><br><span class="line">second = index &gt;=<span class="number">0</span> ? array[index] : array[array.length + index];</span><br><span class="line">index = -index;</span><br><span class="line">last = index &gt;=<span class="number">0</span> ? array[index] : array[array.length + index];</span><br></pre></td></tr></table></figure>
<p>So every time we reference the array, we need to check whether the index is negative or not. This approach absolutely hurts the performance a lot, which in basically unacceptable.<br>So that’s why coffee-script doesn’t support the negative index.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2012/05/29/negative-index-in-coffee-script/" data-id="cinedk71g002gchsipigam9bx" class="article-share-link">Partager</a>
      
        <a href="http://timnew.me/blog/2012/05/29/negative-index-in-coffee-script/#disqus_thread" class="article-comment-link">Commentaires</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/array/">array</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/coffeescript/">coffeescript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/index/">index</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/negative/">negative</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/slice/">slice</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-space-pitfall-in-coffee-script" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2012/05/14/space-pitfall-in-coffee-script/" class="article-date">
  <time datetime="2012-05-14T00:00:00.000Z" itemprop="datePublished">2012-05-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/javascript/">JavaScript</a>►<a class="article-category-link" href="/categories/programming/javascript/coffeescript/">CoffeeScript</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2012/05/14/space-pitfall-in-coffee-script/">Space Pitfall in coffee-script</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Coffee Script had fixed quite a lot of pitfalls in Javascript. But on another hand it also introduced some other pitfalls, the most common one is the space.</p>
<h3 id="Space-in-function-declaration"><a href="#Space-in-function-declaration" class="headerlink" title="Space in function declaration"></a>Space in function declaration</h3><p>Read the following code:</p>
<figure class="highlight coffeescript"><figcaption><span>Show Message:Coffee</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">show = message -&gt;</span><br><span class="line">	<span class="built_in">console</span>.log message</span><br><span class="line"></span><br><span class="line">show <span class="string">"space pitfall"</span></span><br></pre></td></tr></table></figure>
<p>This is a quite simple script, but it failed to run. And if you might also feel confused about the error message: “message is not defined”</p>
<p>What happened to the code? We indeed had declared the message as argument of function show. To reveal the answer, we should analyze the compiled javascript.<br>Here is the compiled code:</p>
<figure class="highlight js"><figcaption><span>Show Message:JS</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Generated by CoffeeScript 1.3.1</span></span><br><span class="line"><span class="keyword">var</span> show;</span><br><span class="line"></span><br><span class="line">show = message(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">console</span>.log(message);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">showe(<span class="string">"space pitfall"</span>);</span><br></pre></td></tr></table></figure>
<p>Look the fun declaration, you will see it is not a function declaration as we want but a function call.<br>The reason is that we omitted the parentheses around the argument and we add a new space between <code>message</code> and <code>-&gt;</code>. So the coffee-script compiler interpret message as a function call with a function as parameter.</p>
<p><strong>Soltuion</strong><br>To fix this problem, we can remove the space between <code>message</code> and <code>-&gt;</code> to enforce coffee-script compiler interpret them as a whole.</p>
<figure class="highlight coffeescript"><figcaption><span>Show Message:Fix</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">show = message-&gt;</span><br><span class="line">	<span class="built_in">console</span>.log message</span><br><span class="line"></span><br><span class="line">show <span class="string">"space pitfall"</span></span><br></pre></td></tr></table></figure>
<p><strong>Best Practise</strong><br>To avoid this pitfall, my suggestion is never omit the parentheses around the arguments, even there is only one argument.<br>And also including the function call, even coffee-script allow to omit the parentheses. Since you won’t able to chain the method call if you omit the parentheses.<br>So never omit parentheses, unless you are very certain that there is no any ambiguity and you won’t use method chain.</p>
<h3 id="The-space-in-array-index"><a href="#The-space-in-array-index" class="headerlink" title="The space in array index"></a>The space in array index</h3><p>Since coffee script doesn’t support the <a href="#">negative index</a>. So we should use following code as negative index:</p>
<figure class="highlight coffeescript"><figcaption><span>Last Hero:Coffee</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">heros = [<span class="string">"Egeal Eye"</span>, <span class="string">"XMen"</span>, <span class="string">"American Captain"</span>, <span class="string">"IronMan"</span>]</span><br><span class="line">lastHero = heros[heros <span class="number">-1</span>]</span><br><span class="line"><span class="built_in">console</span>.log lastHero</span><br></pre></td></tr></table></figure>
<p>This piece of code is also failed to run, and the error message is “property of object is not a function”.<br>Quite wield right?<br>Let’s see what is behind the scene, here is the compiled code:</p>
<figure class="highlight js"><figcaption><span>Last Hero:JS</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Generated by CoffeeScript 1.3.1</span></span><br><span class="line"><span class="keyword">var</span> heros, lastHero;</span><br><span class="line"></span><br><span class="line">heros = [<span class="string">"Egeal Eyr"</span>, <span class="string">"XMen"</span>, <span class="string">"American Captain"</span>, <span class="string">"IronMan"</span>];</span><br><span class="line"></span><br><span class="line">lastHero = heros[heros.length(<span class="number">-1</span>)];</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(lastHero);</span><br></pre></td></tr></table></figure>
<p>Same problem, <code>heros.length -1</code> is interpreted as <code>heros.length(-1)</code> instead of <code>heros.length -1</code>.<br>To fix this problem, we should write the code in following way:</p>
<figure class="highlight coffeescript"><figcaption><span>Last Hero:Fix1</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">heros = [<span class="string">"Egeal Eye"</span>, <span class="string">"XMen"</span>, <span class="string">"American Captain"</span>, <span class="string">"IronMan"</span>]</span><br><span class="line">lastHero = heros[heros - <span class="number">1</span>]</span><br><span class="line"><span class="built_in">console</span>.log lastHero</span><br></pre></td></tr></table></figure>
<p>Or</p>
<figure class="highlight coffeescript"><figcaption><span>Last Hero:Fix2</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">heros = [<span class="string">"Egeal Eye"</span>, <span class="string">"XMen"</span>, <span class="string">"American Captain"</span>, <span class="string">"IronMan"</span>]</span><br><span class="line">lastHero = heros[heros<span class="number">-1</span>]</span><br><span class="line"><span class="built_in">console</span>.log lastHero</span><br></pre></td></tr></table></figure>
<p>Both solution is try to enforce the compiler divid the component in correct way.</p>
<p>And unfortunately, there is no way to avoid this problem, the only thing you can do is always be aware the spaces in expression.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2012/05/14/space-pitfall-in-coffee-script/" data-id="cinedk71c002achsih4gycs1q" class="article-share-link">Partager</a>
      
        <a href="http://timnew.me/blog/2012/05/14/space-pitfall-in-coffee-script/#disqus_thread" class="article-comment-link">Commentaires</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/best-practice/">best-practice</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/coffee-script/">coffee-script</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/compile/">compile</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pitfall/">pitfall</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/space/">space</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-enhanced-typeof-operator-in-javascript" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2012/03/18/enhanced-typeof-operator-in-javascript/" class="article-date">
  <time datetime="2012-03-18T00:00:00.000Z" itemprop="datePublished">2012-03-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/javascript/">JavaScript</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2012/03/18/enhanced-typeof-operator-in-javascript/">Enhanced typeof() operator in JavaScript</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Javascript is weakly typed, and its type system always behaves different than your expectation.<br>Javascript provide typeof operator to test the type of a variable. it works fine generally. e.g.</p>
<figure class="highlight javascript"><figcaption><span>typeof default behaviors</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">typeof</span>(<span class="number">1</span>) === <span class="string">'number'</span></span><br><span class="line"><span class="keyword">typeof</span>(<span class="string">'hello'</span>) === <span class="string">'string'</span></span><br><span class="line"><span class="keyword">typeof</span>(&#123;&#125;) === <span class="string">'object'</span></span><br><span class="line"><span class="keyword">typeof</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;) === <span class="string">'function'</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>But it is not enough, it behaves stupid when you dealing with objects created by constructors. e.g.<br>if you expected<br><figure class="highlight javascript"><figcaption><span>Expected typeof behavior against object</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typeof</span>(<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'2012-12-12'</span>)) === <span class="string">'date'</span> <span class="comment">// Returns false</span></span><br></pre></td></tr></table></figure><br>Then you must be disappointed, since actually<br><figure class="highlight javascript"><figcaption><span>Actual typeof behavior against object</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typeof</span>(<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'2012-12-12'</span>)) === <span class="string">'object'</span> <span class="comment">// Returns true</span></span><br></pre></td></tr></table></figure><br>Yes, when you apply <code>typeof()</code> operator on any objects, it just yield the general type “object” rather than the more meaningful type “date”.</p>
<p>How can we make the <code>typeof()</code> operator works in the way as we expected?<br>As we know when we create a object, the special property of the object constructor will be set to the function that create the object. which means:</p>
<figure class="highlight javascript"><figcaption><span>Get constructor property of object</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'2012-1-1'</span>)).constructor <span class="comment">// Returns [Function Date]</span></span><br></pre></td></tr></table></figure>
<p>So ideally we can retrieve the name of the function as the type of the variable. And to be compatible with javascript’s native operator, we need to convert the name to lower case. So we got this expression:</p>
<figure class="highlight javascript"><figcaption><span>Simulate typeof operator behavior with constructor property</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">typeOf</span>(<span class="params">obj</span>) </span>&#123; <span class="comment">// Use capital O to differentiate this function from typeof operator</span></span><br><span class="line">	<span class="keyword">return</span> obj ? obj.constructor.name.toLowerCase() : <span class="keyword">typeof</span>(obj);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">typeOf(<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'2012-1-1'</span>)) === <span class="string">'date'</span> <span class="comment">// Returns true</span></span><br></pre></td></tr></table></figure>
<p>And luckily, we can also apply this to other primitive types, e.g:</p>
<figure class="highlight javascript"><figcaption><span>Apply typeOf to primitive types</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">typeOf(<span class="number">123</span>) === <span class="string">'number'</span>; <span class="comment">// Returns true</span></span><br><span class="line">typeOf(<span class="string">'hello'</span>) === <span class="string">'string'</span>; <span class="comment">// Returns true</span></span><br><span class="line">typeOf(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;) === <span class="string">'function'</span>;  <span class="comment">// Returns true</span></span><br></pre></td></tr></table></figure>
<p>or even</p>
<figure class="highlight javascript"><figcaption><span>Apply typeOf to anonymous object</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">typeOf(&#123;&#125;) === <span class="string">'object'</span>; <span class="comment">// Returns true</span></span><br></pre></td></tr></table></figure>
<p>So in general, we use this expression as new implementation of the <code>typeof()</code> operator! <strong>EXCEPT One case</strong>!</p>
<p>If someone declare the object constructor in this way, our new <code>typeof()</code> implementation will work improperly!</p>
<figure class="highlight javascript"><figcaption><span>Closure encapsulated anonymous constructor</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> SomeClass = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.someProperty=<span class="string">'some value'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<p>or even define the constructor like this</p>
<figure class="highlight javascript"><figcaption><span>Anonymous Closure</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> SomeClass = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.someProperty = <span class="string">'some value'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>And we will find that</p>
<figure class="highlight javascript"><figcaption><span>Apply typeOf to object instantiated by anonymous constructor</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">typeOf(<span class="keyword">new</span> SomeClass) === <span class="string">''</span>; <span class="comment">// Returns true</span></span><br></pre></td></tr></table></figure>
<p>the reason behind this is because the real constructor of the SomeClass is actually an anonymous function, whose name is not set.</p>
<p>To solve this problem, we need to declare the name of the constructor:</p>
<figure class="highlight javascript"><figcaption><span>Closure encapsulated named constructor</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> SomeClass = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">SomeClass</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.someProperty=<span class="string">'some value'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<p>or even define the constructor like this</p>
<figure class="highlight javascript"><figcaption><span>Named constructor</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> SomeClass = <span class="function"><span class="keyword">function</span> <span class="title">SomeClass</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.someProperty = <span class="string">'some value'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2012/03/18/enhanced-typeof-operator-in-javascript/" data-id="cinedk6zw0010chsirj0a326c" class="article-share-link">Partager</a>
      
        <a href="http://timnew.me/blog/2012/03/18/enhanced-typeof-operator-in-javascript/#disqus_thread" class="article-comment-link">Commentaires</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/fix/">fix</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js/">js</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js-hack/">js hack</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pitfall/">pitfall</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/type/">type</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/typeof/">typeof</a></li></ul>

    </footer>
  </div>
  
</article>


  


</section>
        
          <aside id="sidebar">
  
    <div class="widget-wrap"><h3 class="widget-title">About Me</h3><div class="widget self-intro"><img src="/images/avatar.png"/><p>Tim is</p><ul class="description"><li>a<span>geek</span></li><li>an spare-time<span>web developer</span></li><li>a part-time<span>mobile developer</span></li><li>a night-time<span>photographer</span></li><li>an early-time<span>pcb solderer</span></li></ul><ul class="social-links"><li><a href="https://linkedin.com/in/timwen" target="_blank" class="linked-in"></a></li><li><a href="https://twitter.com/timnew" target="_blank" class="twitter"></a></li><li><a href="https://github.com/timnew" target="_blank" class="github"></a></li></ul></div></div>
  
    
  <div class="widget-wrap">
    <a href="/posts">
      <h3 class="widget-title">Articles récents</h3>
    </a>
    <div class="widget recent-posts">
      <ul>
        
          <li>
            <a href="/blog/2016/04/23/collection-filtering-algorithm-with-bit-operation-part-1/">Collection Filtering Algorithm with Bit Operation - Part.1</a>
          </li>
        
          <li>
            <a href="/blog/2015/08/14/a-clean-way-to-test-rejected-promise/">A clean way to test rejected promise</a>
          </li>
        
          <li>
            <a href="/blog/2014/12/06/typical-eventbus-design-patterns/">Typical EventBus Design Patterns</a>
          </li>
        
          <li>
            <a href="/blog/2014/11/09/understand-styles-in-android-part-1-what-it-is-for-and-how-to-used-it/">Understand Styles in Android - Part 1. What it is for and how to used it</a>
          </li>
        
          <li>
            <a href="/blog/2014/11/07/walkthrough-untrusted-the-continuing-adventures-of-dr-eval/">Walkthrough: Untrusted - the Continuing Adventures of Dr. Eval</a>
          </li>
        
      </ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <a href="/tags">
      <h3 class="widget-title">Nuage de mot-clés</h3>
    </a>
    <div class="widget tagcloud">
      <a href="/tags/net/" style="font-size: 10px;">.net</a> <a href="/tags/alfred/" style="font-size: 10px;">Alfred</a> <a href="/tags/algorithm/" style="font-size: 10px;">Algorithm</a> <a href="/tags/android/" style="font-size: 20px;">Android</a> <a href="/tags/android-studio/" style="font-size: 10px;">Android Studio</a> <a href="/tags/automation/" style="font-size: 10px;">Automation</a> <a href="/tags/binary/" style="font-size: 10px;">Binary</a> <a href="/tags/bit-operation/" style="font-size: 10px;">Bit Operation</a> <a href="/tags/bit-slicer/" style="font-size: 10px;">Bit Slicer</a> <a href="/tags/bloom-filter/" style="font-size: 10px;">Bloom Filter</a> <a href="/tags/boilerplate/" style="font-size: 10px;">Boilerplate</a> <a href="/tags/c/" style="font-size: 20px;">C#</a> <a href="/tags/ci/" style="font-size: 15px;">CI</a> <a href="/tags/css/" style="font-size: 10px;">CSS</a> <a href="/tags/cheat/" style="font-size: 10px;">Cheat</a> <a href="/tags/cheat-engine/" style="font-size: 10px;">Cheat Engine</a> <a href="/tags/class/" style="font-size: 10px;">Class</a> <a href="/tags/cocoa/" style="font-size: 10px;">Cocoa</a> <a href="/tags/collection/" style="font-size: 10px;">Collection</a> <a href="/tags/command/" style="font-size: 10px;">Command</a> <a href="/tags/continues-delivery/" style="font-size: 10px;">Continues Delivery</a> <a href="/tags/continues-integration/" style="font-size: 10px;">Continues Integration</a> <a href="/tags/crack/" style="font-size: 10px;">Crack</a> <a href="/tags/d/" style="font-size: 10px;">D</a> <a href="/tags/debugger/" style="font-size: 10px;">Debugger</a> <a href="/tags/deploy/" style="font-size: 10px;">Deploy</a> <a href="/tags/deployment/" style="font-size: 10px;">Deployment</a> <a href="/tags/design/" style="font-size: 10px;">Design</a> <a href="/tags/design-pattern/" style="font-size: 10px;">Design Pattern</a> <a href="/tags/event/" style="font-size: 10px;">Event</a>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <a href="/categories">
      <h3 class="widget-title">Catégories</h3>
    </a>
    <div class="widget category-list">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/cracking/">Cracking</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/cracking/game/">Game</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/design/">Design</a><span class="category-list-count">3</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/design/visual/">Visual</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/design/web/">Web</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/game/">Game</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/game/programming-game/">Programming Game</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/geek-toy/">Geek Toy</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/package/">Package</a><span class="category-list-count">4</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/package/chrome-extension/">Chrome Extension</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/package/hexo/">Hexo</a><span class="category-list-count">3</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/">Practice</a><span class="category-list-count">22</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/practice/atom/">Atom</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/chrome/">Chrome</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/continues-integration/">Continues Integration</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/devops/">DevOps</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/hexo/">Hexo</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/mac/">Mac</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/shell/">Shell</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/textmate/">TextMate</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/web/">Web</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/windows/">Windows</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/git/">git</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/">Programming</a><span class="category-list-count">73</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/programming/algorithm/">Algorithm</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/android/">Android</a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/arduino/">Arduino</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/c/">C#</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/chrome/">Chrome</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/design-patterns/">Design Patterns</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/java/">Java</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/javascript/">JavaScript</a><span class="category-list-count">8</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/programming/javascript/coffeescript/">CoffeeScript</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/postgressql/">PostgresSql</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/powershell/">PowerShell</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/regular-expression/">Regular Expression</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/ruby/">Ruby</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/shell/">Shell</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/wpf/">WPF</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/web/">Web</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/node-js/">node.js</a><span class="category-list-count">10</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/thinking/">Thinking</a><span class="category-list-count">5</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <a href="/archives">
      <h3 class="widget-title">Archives</h3>
    </a>
    <div class="widget archive-list">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">December 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">November 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10/">October 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">September 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/08/">August 2014</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/07/">July 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/06/">June 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/05/">May 2014</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/04/">April 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/12/">December 2013</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/10/">October 2013</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/07/">July 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/06/">June 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/04/">April 2013</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/03/">March 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/02/">February 2013</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/01/">January 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/11/">November 2012</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/10/">October 2012</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/08/">August 2012</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/07/">July 2012</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/06/">June 2012</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/05/">May 2012</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/04/">April 2012</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/03/">March 2012</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/02/">February 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/10/">October 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/09/">September 2011</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/05/">May 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/04/">April 2011</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/11/">November 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/09/">September 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/04/">April 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/03/">March 2010</a><span class="archive-list-count">2</span></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 TimNew<br>
      Propulsé by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/#main" class="mobile-nav-link">Home</a>
  
    <a href="/archives/" class="mobile-nav-link">Archives</a>
  
    <a href="/photos/500px.html" class="mobile-nav-link">Photos</a>
  
</nav>
    
<script>
  var disqus_shortname = 'timnew-github';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<!-- <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script> -->
<script src="//code.jquery.com/jquery-2.1.1.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>