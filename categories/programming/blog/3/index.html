<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Category: Programming | ThoughtWorkshop</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="timnew programming code software">
<meta property="og:type" content="website">
<meta property="og:title" content="ThoughtWorkshop">
<meta property="og:url" content="http://timnew.me/categories/programming/blog/3/index.html">
<meta property="og:site_name" content="ThoughtWorkshop">
<meta property="og:description" content="timnew programming code software">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ThoughtWorkshop">
<meta name="twitter:description" content="timnew programming code software">
<meta name="twitter:creator" content="@timnew">
<link rel="publisher" href="108780866821209050000">
  
    <link rel="alternate" href="/atom.xml" title="ThoughtWorkshop" type="application/atom+xml">
  
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
<link rel="icon" type="image/png" href="/favicon-196x196.png" sizes="196x196">
<link rel="icon" type="image/png" href="/favicon-160x160.png" sizes="160x160">
<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-TileImage" content="/mstile-144x144.png">

  <!-- <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css"> -->
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-30567867-1', 'auto');

  ga('require', 'displayfeatures');

ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">ThoughtWorkshop</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Digital Bigs in my thought</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/#main">Home</a>
        
          <a class="main-nav-link" href="/archives/">Archives</a>
        
          <a class="main-nav-link" href="/photos/500px.html">Photos</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://timnew.me"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-upgrading-dsl-from-coffeescript-to-json-part-2-redefine-dsl-behavior" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2014/05/11/upgrading-dsl-from-coffeescript-to-json-part-2-redefine-dsl-behavior/" class="article-date">
  <time datetime="2014-05-11T00:00:00.000Z" itemprop="datePublished">2014-05-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/javascript/">JavaScript</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2014/05/11/upgrading-dsl-from-coffeescript-to-json-part-2-redefine-dsl-behavior/">Upgrading DSL From CoffeeScript to JSON: Part.2. Redefine DSL behavior</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>This is the second post in this series, <a href="/blog/2014/05/11/upgrade-dsl-from-coffeescript-to-json-part-1-migrator">previous one</a> discussed the JSON schema migration mechanism.</p>
<p>After finish JSON DSL implementation, the No.1 problem I need to handle is how to upgrading the configuration in CoffeeScript to JSON format.</p>
<p>One of the solutions is to do it manually. Well, it is possible, but… JSON isn’t a language really designed for human, composing configuration for 50+ sites doesn’t sound like a pleasant work for me. Even when I finished it, how can I ensure all the configuration is properly upgraded? The sun is bright today, I don’t want to waste whole afternoon in front of the computer checking the JSON. In one word, I’m lazy…</p>
<p>Since most of the change of DSL is happened on representation instead of structure. So in most cases, there is 1-to-1 mapping between v1 DSL and v2 DSL. So maybe I can generate the most of v2 DSL by using V1 DSL! Then manually handle some exceptions.</p>
<p>Here is a snippet of V1 DSL</p>
<figure class="highlight coffeescript"><figcaption><span>Ver 1 DSL snippet</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line">AdKiller.run -&gt;</div><div class="line"></div><div class="line">  @host <span class="string">'imagetwist.com'</span>, <span class="function">-&gt;</span></div><div class="line">    @clean(<span class="string">'#myad'</span>, <span class="string">'#popupOverlay'</span>)</div><div class="line">    @revealImg(<span class="string">'.pic'</span>)</div><div class="line"></div><div class="line">  @host <span class="string">'yankoimages.net'</span>, <span class="function">-&gt;</span></div><div class="line">    @clean(<span class="string">'#firopage'</span>)</div><div class="line">    @revealImg(<span class="string">'img'</span>)</div><div class="line"></div><div class="line">  @host <span class="string">'imageback.info'</span>, <span class="string">'imagepong.info'</span>, <span class="string">'imgking.us'</span>, <span class="string">'imgabc.us'</span>, <span class="function">-&gt;</span></div><div class="line">    @revealA(<span class="string">'.text_align_center a'</span>)</div><div class="line"></div><div class="line">  @host <span class="string">'imgserve.net'</span>,</div><div class="line">    <span class="string">'imgcloud.co'</span>,</div><div class="line">    <span class="string">'hosterbin.com'</span>,</div><div class="line">    <span class="string">'myhotimage.org'</span>,</div><div class="line">    <span class="string">'img-zone.com'</span>,</div><div class="line">    <span class="string">'imgtube.net'</span>,</div><div class="line">    <span class="string">'pixup.us'</span>,</div><div class="line">    <span class="string">'imgcandy.net'</span>,</div><div class="line">    <span class="string">'croftimage.com'</span>,</div><div class="line">    <span class="string">'www.imagefolks.com'</span>,</div><div class="line">    <span class="string">'imgcloud.co'</span>,</div><div class="line">    <span class="string">'imgmoney.com'</span>,</div><div class="line">    <span class="string">'imagepicsa.com'</span>,</div><div class="line">    <span class="string">'imagecorn.com'</span>,</div><div class="line">    <span class="string">'imgcorn.com'</span>,</div><div class="line">    <span class="string">"imgboo.me"</span>,</div><div class="line">    <span class="string">'imgrim.com'</span>,</div><div class="line">    <span class="string">'imgdig.com'</span>,</div><div class="line">    <span class="string">'imgnext.com'</span>,</div><div class="line">    <span class="string">'hosturimage.com'</span>,</div><div class="line">    <span class="string">'image-gallery.us'</span>,</div><div class="line">    <span class="string">'imgmaster.net'</span>,</div><div class="line">    <span class="string">'img.spicyzilla.com'</span>,</div><div class="line">    <span class="string">'bulkimg.info'</span>,</div><div class="line">    <span class="string">'pic.apollon-fervor.com'</span>,</div><div class="line">    <span class="string">'08lkk.com'</span>,</div><div class="line">    <span class="string">'damimage.com'</span>,</div><div class="line">    <span class="function">-&gt;</span></div><div class="line">      @click(<span class="string">'#continuetoimage input'</span>)</div><div class="line">      @clean(<span class="string">'#logo'</span>)</div><div class="line">      @safeRevealImg(<span class="string">'#container img[class]'</span>)</div><div class="line"></div></pre></td></tr></table></figure>
<p>In version 1 implementation, <code>@host</code> defines the sites. And in the block of <code>@host</code> method, <code>@click</code>, <code>@clean</code>, <code>@revealImg</code> methods define the actions for the sites. The <code>@host</code> method instantiate new instance of <code>Cleaner</code>. The code block is invoked when cleaner is triggered, which does the actually cleaning.</p>
<p>Now I want to keep this file, since it shares the configuration between version 1 and version 2. And I redefine the behaviors of the cleaning method, such as <code>@clean</code>, <code>@click</code>, etc., I generate the JSON data when it is invoked instead of really altering the DOM. So I got this:</p>
<figure class="highlight coffeescript"><figcaption><span>seed_data_generator</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env coffee</span></div><div class="line"></div><div class="line">fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</div><div class="line"></div><div class="line">AdKiller =</div><div class="line">  run: <span class="function"><span class="params">(block)</span> -&gt;</span></div><div class="line">    @scripts = &#123;&#125;</div><div class="line">    @hosts = &#123;&#125;</div><div class="line"></div><div class="line">    block.call(<span class="keyword">this</span>)</div><div class="line"></div><div class="line">    fs.writeFileSync <span class="string">'seed_data.json'</span>, JSON.stringify(&#123;version: <span class="number">1</span>, @hosts, @scripts&#125;)</div><div class="line"></div><div class="line">  host: <span class="function"><span class="params">(hosts..., block)</span> -&gt;</span></div><div class="line">    @currentScript = []</div><div class="line">    scriptId = hosts[<span class="number">0</span>]</div><div class="line"></div><div class="line">    @scripts[scriptId] = @currentScript</div><div class="line">    <span class="keyword">for</span> host <span class="keyword">in</span> hosts</div><div class="line">      @hosts[host] = scriptId</div><div class="line"></div><div class="line">    block.call(<span class="keyword">this</span>)</div><div class="line"></div><div class="line">  remove: <span class="function"><span class="params">(selectors...)</span> -&gt;</span></div><div class="line">    selectors.unshift <span class="string">'remove'</span></div><div class="line">    @currentScript.push selectors</div><div class="line"></div><div class="line">  clean: <span class="function"><span class="params">(selectors...)</span> -&gt;</span> <span class="comment"># Backward compatibility</span></div><div class="line">    selectors.unshift <span class="string">'remove'</span></div><div class="line">    @currentScript.push selectors</div><div class="line"></div><div class="line">  hide: <span class="function"><span class="params">(selectors...)</span> -&gt;</span></div><div class="line">    selectors.unshift <span class="string">'clean'</span></div><div class="line">    @currentScript.push selectors</div><div class="line"></div><div class="line">  click: <span class="function"><span class="params">(selector)</span> -&gt;</span></div><div class="line">    @currentScript.push [<span class="string">'click'</span>, selector]</div><div class="line"></div><div class="line">  revealA: <span class="function"><span class="params">(selector)</span> -&gt;</span></div><div class="line">    @currentScript.push [<span class="string">'revealA'</span>, selector]</div><div class="line"></div><div class="line">  revealImg: <span class="function"><span class="params">(selector)</span> -&gt;</span></div><div class="line">    @currentScript.push [<span class="string">'revealImg'</span>, selector]</div><div class="line"></div><div class="line">  safeRevealA: <span class="function"><span class="params">(selector)</span> -&gt;</span></div><div class="line">    @currentScript.push [<span class="string">'safeRevealA'</span>, selector]</div><div class="line"></div><div class="line">  safeRevealImg: <span class="function"><span class="params">(selector)</span> -&gt;</span></div><div class="line">    @currentScript.push [<span class="string">'safeRevealImg'</span>, selector]</div><div class="line"></div><div class="line">AdKiller.run -&gt;</div><div class="line">  @host <span class="string">'imagetwist.com'</span>, <span class="function">-&gt;</span></div><div class="line">    @clean(<span class="string">'#myad'</span>, <span class="string">'#popupOverlay'</span>)</div><div class="line">    @revealImg(<span class="string">'.pic'</span>)</div><div class="line"></div><div class="line">  <span class="comment"># ...</span></div></pre></td></tr></table></figure>
<p>So now I can easily invoking this piece of code, to convert verion 1 DSL to JSON format.</p>
<p>DSL behavior redefinition is a super powerful trick, we used it on JSON parsing, validation, and generation before on PlayUp project. Which saved us tons of time from writing boring code.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2014/05/11/upgrading-dsl-from-coffeescript-to-json-part-2-redefine-dsl-behavior/" data-id="ciqg4g84b006k6nsiyo0ejdc9" class="article-share-link">Share</a>
      
        <a href="http://timnew.me/blog/2014/05/11/upgrading-dsl-from-coffeescript-to-json-part-2-redefine-dsl-behavior/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/coffeescript/">coffeescript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dsl/">dsl</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/json/">json</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/language/">language</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/upgrading/">upgrading</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-chrome-extension-rpc-router" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2014/05/11/chrome-extension-rpc-router/" class="article-date">
  <time datetime="2014-05-11T00:00:00.000Z" itemprop="datePublished">2014-05-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/chrome/">Chrome</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2014/05/11/chrome-extension-rpc-router/">Chrome Extension RPC Router</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>When developing chrome extension, communication between background script and content scripts is very typical use case. Chrome provides messaging APIs to achieve this goal. But this API has limitation that every message goes to the same listener.</p>
<p>Background script in Chrome extension usually works as a function hub for the whole extension, so background scripts usually required to process different types of messages. Then the limit of Chrome messaging API become an issue we need to face.</p>
<p>There are several approaches to resolve the limitation. Since API allow multiple listener, a simple and cheap solution is Responsibility Chain; adding listener for each message type, and checking message type at beginning of the listener.</p>
<figure class="highlight js"><figcaption><span>Responsbility Chain</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">chrome.runtime.onMessage.addListener(<span class="function"><span class="keyword">function</span>(<span class="params">message, sender, sendResponse</span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(message.type != <span class="string">'reloadData'</span>)</div><div class="line">    <span class="keyword">return</span>;</div><div class="line"></div><div class="line">  <span class="comment">// reload data logic here</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line">chrome.runtime.onMessage.addListener(<span class="function"><span class="keyword">function</span>(<span class="params">message, sender, sendResponse</span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(message.type != <span class="string">'updateBrowerAction'</span>)</div><div class="line">    <span class="keyword">return</span>;</div><div class="line"></div><div class="line">  <span class="comment">// update browser action logic here</span></div><div class="line">&#125;);</div><div class="line"></div></pre></td></tr></table></figure>
<p>This approach works, but not that graceful. And there is potential performance issue when message types increases.</p>
<p>So I come up a new more graceful solution: RPC Message Router</p>
<figure class="highlight coffeescript"><figcaption><span>RCPRouter</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="function"></span></div><div class="line"><span class="title">extractResponseHandler</span> = <span class="params">(args)</span> -&gt;</div><div class="line">  <span class="keyword">return</span> <span class="literal">undefined</span> <span class="keyword">if</span> args.length == <span class="number">0</span></div><div class="line"></div><div class="line">  last = args.pop()</div><div class="line"></div><div class="line">  <span class="keyword">if</span> <span class="keyword">typeof</span> last == <span class="string">'function'</span></div><div class="line">    <span class="keyword">return</span> last</div><div class="line">  <span class="keyword">else</span></div><div class="line">    args.push last</div><div class="line">    <span class="keyword">return</span> <span class="literal">undefined</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> @<span class="title">RPCRouter</span></span></div><div class="line">  constructor: <span class="function">-&gt;</span></div><div class="line">    chrome.runtime.onMessage.addListener @handleMassage</div><div class="line"></div><div class="line">  handleMassage: <span class="function"><span class="params">(message, sender, sendResponse)</span> =&gt;</span></div><div class="line">    &#123;method: methodName, args&#125; = message</div><div class="line">    method = <span class="keyword">this</span>[methodName]</div><div class="line"></div><div class="line">    <span class="keyword">unless</span> method?</div><div class="line">      <span class="built_in">console</span>.error <span class="string">"Unknown RPC method: %s"</span>, methodName</div><div class="line">      <span class="keyword">return</span></div><div class="line"></div><div class="line">    args.push sendResponse</div><div class="line"></div><div class="line">    <span class="built_in">console</span>.log <span class="string">"RPC Call: %s, args: %o"</span>, methodName, args</div><div class="line">    method.apply(<span class="keyword">this</span>, args)</div><div class="line"></div><div class="line">  callBackground: <span class="function"><span class="params">(method, args...)</span> -&gt;</span></div><div class="line">    responseHandler = extractResponseHandler(args)</div><div class="line">    <span class="built_in">console</span>.log <span class="string">"RPC Call to Background: %s, args: %o"</span>, method, args</div><div class="line">    chrome.runtime.sendMessage &#123;method, args&#125;, responseHandler</div><div class="line"></div><div class="line">  callTab: <span class="function"><span class="params">(tabId, method, args...)</span> -&gt;</span></div><div class="line">    responseHandler = extractResponseHandler(args)</div><div class="line">    <span class="built_in">console</span>.log <span class="string">"RPC Call to Tab \"%s\": %s, args: %o"</span>, tabId, method, args</div><div class="line">    chrome.tabs.sendMessage tabId, &#123;method, args&#125;, responseHandler</div><div class="line"></div></pre></td></tr></table></figure>
<p>So this new RPCRouter wraps the chrome original messaging API and provides a more convenient way to invoke a remote method. To create a specific RPC Router for background page or content page is quite easy.</p>
<figure class="highlight coffeescript"><figcaption><span>Responsbility Chain</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">BackgroundRPCRouter</span> <span class="keyword">extends</span> <span class="title">RPCRouter</span></span></div><div class="line">  refreshData: <span class="function"><span class="params">(isForceUpdate, dataLoadedCallback)</span> -&gt;</span></div><div class="line">    <span class="comment"># reload data logic here</span></div><div class="line"></div><div class="line">    dataLoadedCallback(data)</div><div class="line"></div><div class="line">  updateBrowerAction: <span class="function"><span class="params">(icon, hintText)</span> -&gt;</span></div><div class="line">    <span class="comment"># update browser action logic here</span></div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="literal">false</span> <span class="comment"># protection: avoid channel leak</span></div><div class="line"></div></pre></td></tr></table></figure>
<p><strong>HINT:</strong><br>Using messaging API in chrome here should be careful. Coffee script will return the last executed statement result as function result, which could be potentially truthy, such as non-zero number, object. The truthy return value will make the channel become a async channel, which won’t be closed until the <code>sendResponse</code> callback is invoked. But just as the handler <code>updateBrowserAction</code>, the handler doesn’t need a <code>sendResponse</code> callback, the issue will keep the channel alive forever. So do add <code>false</code> or <code>return false</code> at the end of the method unless you can ensure the function will never yield truthy value in last statement.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2014/05/11/chrome-extension-rpc-router/" data-id="ciqg4g849006c6nsibxma2zs2" class="article-share-link">Share</a>
      
        <a href="http://timnew.me/blog/2014/05/11/chrome-extension-rpc-router/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/rpc/">RPC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/chrome/">chrome</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/extension/">extension</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/messaging/">messaging</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/router/">router</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/routing/">routing</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-app-crash-issue-when-inflating-viewpager" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2014/04/22/app-crash-issue-when-inflating-viewpager/" class="article-date">
  <time datetime="2014-04-22T00:00:00.000Z" itemprop="datePublished">2014-04-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/android/">Android</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2014/04/22/app-crash-issue-when-inflating-viewpager/">App crash issue when inflating ViewPager</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>I wrote a very simple layout file with a <code>ViewPager</code>, but the app crashes when inflating it.</p>
<figure class="highlight xml"><figcaption><span>Layout file</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"utf-8"</span><span class="meta">?&gt;</span></span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">FrameLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></div><div class="line">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">ViewPager</span></span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/view_pager"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span> /&gt;</div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></div></pre></td></tr></table></figure>
<p>Here is the error message:</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div></pre></td><td class="code"><pre><div class="line"><span class="number">04</span>-<span class="number">22</span> <span class="number">22</span>:<span class="number">27</span>:<span class="number">00.828</span>    <span class="number">1128</span>-<span class="number">1479</span>/com.github.timnew.rubiktimer E/AndroidRuntime﹕ FATAL EXCEPTION: main</div><div class="line">    Process: com.github.timnew.rubiktimer, PID: <span class="number">1128</span></div><div class="line">    java.lang.RuntimeException: Unable to start activity ComponentInfo&#123;com.github.timnew.rubiktimer/com.github.timnew.rubiktimer.history.HistoryActivity_&#125;: android.<span class="built_in">view</span>.InflateException: Binary XML file line #<span class="number">7</span>: Error inflating class ViewPager</div><div class="line">            <span class="built_in">at</span> android.app.ActivityThread.performLaunchActivity(ActivityThread.java:<span class="number">2282</span>)</div><div class="line">            <span class="built_in">at</span> android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:<span class="number">2340</span>)</div><div class="line">            <span class="built_in">at</span> android.app.ActivityThread.access$<span class="number">800</span>(ActivityThread.java:<span class="number">157</span>)</div><div class="line">            <span class="built_in">at</span> android.app.ActivityThread$H.handleMessage(ActivityThread.java:<span class="number">1247</span>)</div><div class="line">            <span class="built_in">at</span> android.os.Handler.dispatchMessage(Handler.java:<span class="number">102</span>)</div><div class="line">            <span class="built_in">at</span> android.os.Looper.loop(Looper.java:<span class="number">157</span>)</div><div class="line">            <span class="built_in">at</span> android.app.ActivityThread.main(ActivityThread.java:<span class="number">5293</span>)</div><div class="line">            <span class="built_in">at</span> java.lang.reflect.Method.invokeNative(Native Method)</div><div class="line">            <span class="built_in">at</span> java.lang.reflect.Method.invoke(Method.java:<span class="number">515</span>)</div><div class="line">            <span class="built_in">at</span> com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:<span class="number">1265</span>)</div><div class="line">            <span class="built_in">at</span> com.android.internal.os.ZygoteInit.main(ZygoteInit.java:<span class="number">1081</span>)</div><div class="line">            <span class="built_in">at</span> dalvik.<span class="built_in">system</span>.NativeStart.main(Native Method)</div><div class="line">     Caused by: android.<span class="built_in">view</span>.InflateException: Binary XML file line #<span class="number">7</span>: Error inflating class ViewPager</div><div class="line">            <span class="built_in">at</span> android.<span class="built_in">view</span>.LayoutInflater.createViewFromTag(LayoutInflater.java:<span class="number">713</span>)</div><div class="line">            <span class="built_in">at</span> android.<span class="built_in">view</span>.LayoutInflater.rInflate(LayoutInflater.java:<span class="number">761</span>)</div><div class="line">            <span class="built_in">at</span> android.<span class="built_in">view</span>.LayoutInflater.inflate(LayoutInflater.java:<span class="number">498</span>)</div><div class="line">            <span class="built_in">at</span> android.<span class="built_in">view</span>.LayoutInflater.inflate(LayoutInflater.java:<span class="number">398</span>)</div><div class="line">            <span class="built_in">at</span> android.<span class="built_in">view</span>.LayoutInflater.inflate(LayoutInflater.java:<span class="number">354</span>)</div><div class="line">            <span class="built_in">at</span> com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:<span class="number">340</span>)</div><div class="line">            <span class="built_in">at</span> com.actionbarsherlock.internal.ActionBarSherlockNative.setContentView(ActionBarSherlockNative.java:<span class="number">134</span>)</div><div class="line">            <span class="built_in">at</span> com.actionbarsherlock.app.SherlockFragmentActivity.setContentView(SherlockFragmentActivity.java:<span class="number">262</span>)</div><div class="line">            <span class="built_in">at</span> com.github.timnew.rubiktimer.history.HistoryActivity_.setContentView(HistoryActivity_.java from OutputFileObject:<span class="number">44</span>)</div><div class="line">            <span class="built_in">at</span> com.github.timnew.rubiktimer.history.HistoryActivity_.onCreate(HistoryActivity_.java from OutputFileObject:<span class="number">34</span>)</div><div class="line">            <span class="built_in">at</span> android.app.Activity.performCreate(Activity.java:<span class="number">5389</span>)</div><div class="line">            <span class="built_in">at</span> android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:<span class="number">1105</span>)</div><div class="line">            <span class="built_in">at</span> android.app.ActivityThread.performLaunchActivity(ActivityThread.java:<span class="number">2246</span>)</div><div class="line">            <span class="built_in">at</span> android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:<span class="number">2340</span>)</div><div class="line">            <span class="built_in">at</span> android.app.ActivityThread.access$<span class="number">800</span>(ActivityThread.java:<span class="number">157</span>)</div><div class="line">            <span class="built_in">at</span> android.app.ActivityThread$H.handleMessage(ActivityThread.java:<span class="number">1247</span>)</div><div class="line">            <span class="built_in">at</span> android.os.Handler.dispatchMessage(Handler.java:<span class="number">102</span>)</div><div class="line">            <span class="built_in">at</span> android.os.Looper.loop(Looper.java:<span class="number">157</span>)</div><div class="line">            <span class="built_in">at</span> android.app.ActivityThread.main(ActivityThread.java:<span class="number">5293</span>)</div><div class="line">            <span class="built_in">at</span> java.lang.reflect.Method.invokeNative(Native Method)</div><div class="line">            <span class="built_in">at</span> java.lang.reflect.Method.invoke(Method.java:<span class="number">515</span>)</div><div class="line">            <span class="built_in">at</span> com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:<span class="number">1265</span>)</div><div class="line">            <span class="built_in">at</span> com.android.internal.os.ZygoteInit.main(ZygoteInit.java:<span class="number">1081</span>)</div><div class="line">            <span class="built_in">at</span> dalvik.<span class="built_in">system</span>.NativeStart.main(Native Method)</div><div class="line">     Caused by: java.lang.ClassNotFoundException: Didn't find class <span class="string">"android.view.ViewPager"</span> on path: DexPathList[[zip file <span class="string">"/data/app/com.github.timnew.rubiktimer-76.apk"</span>],nativeLibraryDirectories=[/data/app-lib/com.github.timnew.rubiktimer-<span class="number">76</span>, /vendor/lib, /<span class="built_in">system</span>/lib]]</div><div class="line">            <span class="built_in">at</span> dalvik.<span class="built_in">system</span>.BaseDexClassLoader.findClass(BaseDexClassLoader.java:<span class="number">67</span>)</div><div class="line">            <span class="built_in">at</span> java.lang.ClassLoader.loadClass(ClassLoader.java:<span class="number">497</span>)</div><div class="line">            <span class="built_in">at</span> java.lang.ClassLoader.loadClass(ClassLoader.java:<span class="number">457</span>)</div><div class="line">            <span class="built_in">at</span> android.<span class="built_in">view</span>.LayoutInflater.createView(LayoutInflater.java:<span class="number">565</span>)</div><div class="line">            <span class="built_in">at</span> android.<span class="built_in">view</span>.LayoutInflater.onCreateView(LayoutInflater.java:<span class="number">658</span>)</div><div class="line">            <span class="built_in">at</span> com.android.internal.policy.impl.PhoneLayoutInflater.onCreateView(PhoneLayoutInflater.java:<span class="number">66</span>)</div><div class="line">            <span class="built_in">at</span> android.<span class="built_in">view</span>.LayoutInflater.onCreateView(LayoutInflater.java:<span class="number">675</span>)</div><div class="line">            <span class="built_in">at</span> android.<span class="built_in">view</span>.LayoutInflater.createViewFromTag(LayoutInflater.java:<span class="number">700</span>)</div><div class="line">            <span class="built_in">at</span> android.<span class="built_in">view</span>.LayoutInflater.rInflate(LayoutInflater.java:<span class="number">761</span>)</div><div class="line">            <span class="built_in">at</span> android.<span class="built_in">view</span>.LayoutInflater.inflate(LayoutInflater.java:<span class="number">498</span>)</div><div class="line">            <span class="built_in">at</span> android.<span class="built_in">view</span>.LayoutInflater.inflate(LayoutInflater.java:<span class="number">398</span>)</div><div class="line">            <span class="built_in">at</span> android.<span class="built_in">view</span>.LayoutInflater.inflate(LayoutInflater.java:<span class="number">354</span>)</div><div class="line">            <span class="built_in">at</span> com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:<span class="number">340</span>)</div><div class="line">            <span class="built_in">at</span> com.actionbarsherlock.internal.ActionBarSherlockNative.setContentView(ActionBarSherlockNative.java:<span class="number">134</span>)</div><div class="line">            <span class="built_in">at</span> com.actionbarsherlock.app.SherlockFragmentActivity.setContentView(SherlockFragmentActivity.java:<span class="number">262</span>)</div><div class="line">            <span class="built_in">at</span> com.github.timnew.rubiktimer.history.HistoryActivity_.setContentView(HistoryActivity_.java from OutputFileObject:<span class="number">44</span>)</div><div class="line">            <span class="built_in">at</span> com.github.timnew.rubiktimer.history.HistoryActivity_.onCreate(HistoryActivity_.java from OutputFileObject:<span class="number">34</span>)</div><div class="line">            <span class="built_in">at</span> android.app.Activity.performCreate(Activity.java:<span class="number">5389</span>)</div><div class="line">            <span class="built_in">at</span> android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:<span class="number">1105</span>)</div><div class="line">            <span class="built_in">at</span> android.app.ActivityThread.performLaunchActivity(ActivityThread.java:<span class="number">2246</span>)</div><div class="line">            <span class="built_in">at</span> android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:<span class="number">2340</span>)</div><div class="line">            <span class="built_in">at</span> android.app.ActivityThread.access$<span class="number">800</span>(ActivityThread.java:<span class="number">157</span>)</div><div class="line">            <span class="built_in">at</span> android.app.ActivityThread$H.handleMessage(ActivityThread.java:<span class="number">1247</span>)</div><div class="line">            <span class="built_in">at</span> android.os.Handler.dispatchMessage(Handler.java:<span class="number">102</span>)</div><div class="line">            <span class="built_in">at</span> android.os.Looper.loop(Looper.java:<span class="number">157</span>)</div><div class="line">            <span class="built_in">at</span> android.app.ActivityThread.main(ActivityThread.java:<span class="number">5293</span>)</div><div class="line">            <span class="built_in">at</span> java.lang.reflect.Method.invokeNative(Native Method)</div><div class="line">            <span class="built_in">at</span> java.lang.reflect.Method.invoke(Method.java:<span class="number">515</span>)</div><div class="line">            <span class="built_in">at</span> com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:<span class="number">1265</span>)</div><div class="line">            <span class="built_in">at</span> com.android.internal.os.ZygoteInit.main(ZygoteInit.java:<span class="number">1081</span>)</div><div class="line">            <span class="built_in">at</span> dalvik.<span class="built_in">system</span>.NativeStart.main(Native Method)</div><div class="line"></div></pre></td></tr></table></figure>
<p>According to the message, we can figure out that the issue is caused because Android cannot found the class <code>android.view.ViewPager</code>.</p>
<p>If we’re careful enough, we can figure out that there is something wrong with the <code>ViewPager</code> fullname. Since <code>ViewPager</code> isn’t a standard widget, so it is provided in Support Library instead in the core SDK. So it is not in the package of <code>android.view</code>, it is in the pacakge <code>android.support.v4.view</code>.</p>
<p>To fix the issue, we should not reference the <code>ViewPager</code> with plain name but with the full name <code>android.support.v4.view.ViewPager</code>.</p>
<p>So this is the updated layout xml:</p>
<figure class="highlight xml"><figcaption><span>Fixed Lyaout</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"utf-8"</span><span class="meta">?&gt;</span></span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">FrameLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></div><div class="line">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">android.support.v4.view.ViewPager</span></span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/view_pager"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span> /&gt;</div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2014/04/22/app-crash-issue-when-inflating-viewpager/" data-id="ciqg4g84700646nsin0ltq046" class="article-share-link">Share</a>
      
        <a href="http://timnew.me/blog/2014/04/22/app-crash-issue-when-inflating-viewpager/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/crash/">crash</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/inflator/">inflator</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/view-pager/">view pager</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-start-acitivity-in-background-on-android-4-4-kitkat" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2013/12/19/start-acitivity-in-background-on-android-4-4-kitkat/" class="article-date">
  <time datetime="2013-12-19T00:00:00.000Z" itemprop="datePublished">2013-12-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/android/">Android</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2013/12/19/start-acitivity-in-background-on-android-4-4-kitkat/">Start Acitivity in background on Android 4.4 KitKat</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>For some reason, Android 4.4 KitKat has changed the implementation while starting activity.</p>
<p>In Android 4.3, <code>Activity</code> started from inactive <code>Activity</code> is also inactive.<br>But in Android 4.4, <code>Activity</code> started form inactive <code>Activity</code> will be brought to front.<br>Here, <code>Inactive Activity</code> means the activity paused by user pressing <code>Home</code> button or switch to another app.</p>
<p>This change won’t be felt in most sceanrios. But for activities that started from AsyncTask, it does have some significant impact on user experience.</p>
<p>I’m working on a app, that shows a Splash Screen when user logged in. And the Splash screen is implemented with activity.</p>
<p>It takes some time for app to communicate with backend server during the loggin in, and user might press “Home” button to temporarily leave the app during the time.</p>
<p>I don’t want the my splash screen to interrupt the user if the user returned to the home screen. So I wish to start the splash screen activity in the background if current acitivity has been brought to background.</p>
<p>It isn’t an issue on Android 4.3, but on Android 4.4 KitKat, it causes problem.<br>I googled this issue and tried the <code>FLAG_ACTIVITY_MULTIPLE_TASK</code>, and comfirmed that it is not helping to this issue.</p>
<p>So I have to come up some kind of “hacking” solution as described below:</p>
<p>I add a <code>isPaused</code> property to <code>BaseAcitity</code>, which is the base class of all activities in my app.</p>
<figure class="highlight java"><figcaption><span>Add isPaused to BaseActivity</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseActivity</span> <span class="keyword">extends</span> <span class="title">FragmentActivity</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String START_FROM_PAUSED_ACTIVITY_FLAG = <span class="string">"START_FROM_PAUSED_ACTIVITY_FLAG"</span>;</div><div class="line"></div><div class="line">    <span class="keyword">protected</span> <span class="keyword">boolean</span> paused = <span class="keyword">false</span>;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onPause</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onPause();</div><div class="line">        paused = <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onResume</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onResume();</div><div class="line">        paused = <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isPaused</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> paused;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div></pre></td></tr></table></figure>
<p>Then when I start the start the <code>SplashActivity</code>, I’ll put the <code>isPaused</code> value into the intent.</p>
<figure class="highlight java"><figcaption><span>Add flag when start activity</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Intent intent = <span class="keyword">new</span> Intent(activity, SplashActivity.class);</div><div class="line"></div><div class="line"><span class="keyword">boolean</span> isStartingFromBackgroundActivity = activity.isPaused();</div><div class="line">intent.putExtra(BaseActivity.START_FROM_PAUSED_ACTIVITY_FLAG, isStartingFromBackgroundActivity);</div><div class="line"></div><div class="line">startActivity(intent);</div><div class="line"></div></pre></td></tr></table></figure>
<p>And check isPaused value in <code>onCreate</code> callback in <code>SplashAcitivity</code>, and push the <code>SplashAcitivty</code> to background if the value is true.</p>
<figure class="highlight java"><figcaption><span>Check flag when activity is created</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (isStartedFromBackgroundActivity())</div><div class="line">        moveTaskToBack(<span class="keyword">true</span>);</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">isStartedFromBackgroundActivity</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> getIntent().getBooleanExtra(START_FROM_PAUSED_ACTIVITY_FLAG, <span class="keyword">false</span>);</div><div class="line">&#125;</div><div class="line"></div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2013/12/19/start-acitivity-in-background-on-android-4-4-kitkat/" data-id="ciqg4g84600616nsi0g6qmkkn" class="article-share-link">Share</a>
      
        <a href="http://timnew.me/blog/2013/12/19/start-acitivity-in-background-on-android-4-4-kitkat/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/activity/">activity</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/background/">background</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kitkat/">kitkat</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/movetasktoback/">moveTaskToBack</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-npmethod-called-on-non-npobject-wrapped-jsobject" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2013/12/16/npmethod-called-on-non-npobject-wrapped-jsobject/" class="article-date">
  <time datetime="2013-12-16T00:00:00.000Z" itemprop="datePublished">2013-12-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/android/">Android</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2013/12/16/npmethod-called-on-non-npobject-wrapped-jsobject/">NPMethod called on non-NPObject wrapped JSObject</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>I’m working on a “hybrid” android appilcation. In the app, part of the UI was written in HTML and hosted in a WebView. And I exposed several Java objects to JavaScript as <code>Java Script Interface</code>.</p>
<figure class="highlight java"><figcaption><span>Setup WebView</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">webView.getSettings().setJavaScriptEnabled(<span class="keyword">true</span>);</div><div class="line">webView.addJavascriptInterface(irBlaster, <span class="string">"irBlaster"</span>);</div></pre></td></tr></table></figure>
<p>The <code>irBlaster</code> object contains several methods, and js will invoke the specific method according to the data-attribute bound to the element.</p>
<figure class="highlight coffeescript"><figcaption><span>Script that handles the button click in HTML</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">onIrButtonClicked: <span class="function"><span class="params">(e)</span> =&gt;</span></div><div class="line">  $button = $(e.currentTarget)</div><div class="line">  type = $button.data(<span class="string">'irType'</span>)</div><div class="line"></div><div class="line">  sendFunc = irBlaster[type]</div><div class="line"></div><div class="line">  code = @parseCode($button.data(<span class="string">'irCode'</span>))</div><div class="line">  length = $button.data(<span class="string">'irLength'</span>)</div><div class="line"></div><div class="line">  sendFunc(length, code)</div></pre></td></tr></table></figure>
<p>The previous coffee-script works fine in my Jasmine tests with javascript mock version of irBlaster. When the button clicked, the proper method was invoked with proper arguments.<br>But when I run this code with real android app, WebView yields error says “NPMethod called on non-NPObject wrapped JSObject”.</p>
<p>The error message looks quite hard to understand the meaning, so I spent quite time to diagnose the code.</p>
<p>After several try, I found the following code works fine, but original one doesn’t:</p>
<figure class="highlight coffeescript"><figcaption><span>Code works</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">onIrButtonClicked: <span class="function"><span class="params">(e)</span> =&gt;</span></div><div class="line">  $button = $(e.currentTarget)</div><div class="line">  type = $button.data(<span class="string">'irType'</span>)</div><div class="line"></div><div class="line">  <span class="keyword">switch</span> irBlaster[type]</div><div class="line">    <span class="keyword">when</span> <span class="string">'NEC'</span></div><div class="line"></div><div class="line">      code = @parseCode($button.data(<span class="string">'irCode'</span>))</div><div class="line">      length = $button.data(<span class="string">'irLength'</span>)</div><div class="line"></div><div class="line">      irBlaster.NEC(length, code)</div><div class="line"></div><div class="line">    .</div><div class="line">    .</div><div class="line">    .</div><div class="line"></div></pre></td></tr></table></figure>
<p>So I realize the issue was occurd in the javascript contextual binding.</p>
<p>Javascript is function-first-citizen language, and method call on object was simulate by invoking the function with specific context, and the code behavior won’t change if there is no reference to this pointer in the method. So it is quite normal that fetch a method from a object than invoke it without context.</p>
<p>That is why the Jasmine tests passed successfully. But the <code>irBlaster</code> isn’t real or simple javascript, but a native java object provided by js binding interface, so there is a limitation that the method on it cannot be invoked without context. Or it causes error.</p>
<p>So the issue can be resolved as following code by invoking the method in a “reflection” flavor:</p>
<figure class="highlight coffeescript"><figcaption><span>Invoking native binding object with context provided in HTML</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">onIrButtonClicked: <span class="function"><span class="params">(e)</span> =&gt;</span></div><div class="line">  $button = $(e.currentTarget)</div><div class="line">  type = $button.data(<span class="string">'irType'</span>)</div><div class="line"></div><div class="line">  sendFunc = irBlaster[type]</div><div class="line"></div><div class="line">  code = @parseCode($button.data(<span class="string">'irCode'</span>))</div><div class="line">  length = $button.data(<span class="string">'irLength'</span>)</div><div class="line"></div><div class="line">  sendFunc.call(irBlaster, length, code)</div></pre></td></tr></table></figure>
<p>In previous code, I invoke the <code>sendFunc</code> with <code>call</code>, and provids irBlaster as the context as <code>this</code>. So the problem solved, the code runs smoothly without issue.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2013/12/16/npmethod-called-on-non-npobject-wrapped-jsobject/" data-id="ciqg4g844005x6nsi7ov34psq" class="article-share-link">Share</a>
      
        <a href="http://timnew.me/blog/2013/12/16/npmethod-called-on-non-npobject-wrapped-jsobject/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/npmethod/">NPMethod</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/npobject/">NPObject</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/webview/">WebView</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wrapper/">Wrapper</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/binding/">binding</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/browser/">browser</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js/">js</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-dynamically-inflates-ui-in-android-app" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2013/12/13/dynamically-inflates-ui-in-android-app/" class="article-date">
  <time datetime="2013-12-13T00:00:00.000Z" itemprop="datePublished">2013-12-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/android/">Android</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2013/12/13/dynamically-inflates-ui-in-android-app/">Dynamically inflates UI in Android App</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>There is a fascinating idea that inflates UI according to an android layout xml downloaded from server. According to the Android API, it looks quite feasible.</p>
<p>One of <code>LayoutInflate.inflate</code> <a href="http://developer.android.com/reference/android/view/LayoutInflater.html#inflate(org.xmlpull.v1.XmlPullParser, android.view.ViewGroup)" target="_blank" rel="external">method overloads</a> accept Layout Xml as <code>XmlPullParser</code>.</p>
<p>And <code>XmlPullParser</code> can wrap around an input stream, so as consequence, following code seems to be working:</p>
<figure class="highlight java"><figcaption><span>Inflate view on the fly</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DynamicView</span> <span class="keyword">extends</span> <span class="title">FrameLayout</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DynamicView</span><span class="params">(Context context, InputStream layoutData)</span> <span class="keyword">throws</span> XmlPullParserException </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context);</div><div class="line"></div><div class="line">        createView(context, layoutData);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">createView</span><span class="params">(Context context, InputStream layoutData)</span> <span class="keyword">throws</span> XmlPullParserException </span>&#123;</div><div class="line">        LayoutInflater inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);</div><div class="line"></div><div class="line">        XmlPullParserFactory factory = XmlPullParserFactory.newInstance();</div><div class="line">        factory.setNamespaceAware(<span class="keyword">true</span>);</div><div class="line">        XmlPullParser parser = factory.newPullParser();</div><div class="line"></div><div class="line">        parser.setInput(layoutData, <span class="string">"UTF-8"</span>);</div><div class="line"></div><div class="line">        inflater.inflate(parser, <span class="keyword">this</span>, <span class="keyword">true</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div></pre></td></tr></table></figure>
<p>The code looks great, compiling looks fine, but when the code excuted, an exception is thrown by the inflater.</p>
<p>According to the LayoutInflater document, this approach won’t work(at least for now, it won’t).</p>
<blockquote><p>For performance reasons, view inflation relies heavily on pre-processing of XML files that is done at build time. Therefore, it is not currently possible to use LayoutInflater with an XmlPullParser over a plain XML file at runtime.</p>
<footer><strong>LayoutInflater Document</strong><cite><a href="http://developer.android.com/reference/android/view/LayoutInflater.html" target="_blank" rel="external">developer.android.com</a></cite></footer></blockquote>
<p>Actually, Android compiler compiles the layout xml files into binary xml block, which has convert attributes into some special format. And in Android SDK, the <code>LayoutInflater</code> uses <code>XmlResourceParser</code> instead of plain <code>XmlPullParser</code>, which is created by <code>XmlBlock</code>.</p>
<p><code>XmlBlock</code> is an internal class used in <code>Resources</code> to cache the binary xml document.</p>
<p>And there is no way to create XmlResourceParser or other classes to inject custom behavior into this process. Personally assume that it is pretty much related to the Android Resource and Theming mechanism, there are quite a number cross references between resources. To make it works in a efficient way, Android Runtime did a lot work, such as cache and pre-processing. To override this behavior require quite a number of work and need to aware of potential performance issue. Since the inflating could happen quite often during navigation.</p>
<p>As a not that fansy alternative, UI based on HTML hosted in WebView could be considered.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2013/12/13/dynamically-inflates-ui-in-android-app/" data-id="ciqg4g843005v6nsi8052522j" class="article-share-link">Share</a>
      
        <a href="http://timnew.me/blog/2013/12/13/dynamically-inflates-ui-in-android-app/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dynamic/">dynamic</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/inflate/">inflate</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/layout-inflater/">layout inflater</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/on-the-fly/">on the fly</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/runtime/">runtime</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ui/">ui</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/xml/">xml</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-asset-path-in-android-stuidio" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2013/12/13/asset-path-in-android-stuidio/" class="article-date">
  <time datetime="2013-12-13T00:00:00.000Z" itemprop="datePublished">2013-12-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/android/">Android</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2013/12/13/asset-path-in-android-stuidio/">Asset path in Android Stuidio</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>According to <a href="https://developer.android.com/tools/projects/index.html#ApplicationProjects" target="_blank" rel="external">Android guideline document</a>, the assets folder is created automatically and is positioned under the root of the project folder.  </p>
<p>So the assets folder should be located at <code>&lt;project root&gt;/assets</code></p>
<p>But according to my experience, I found it is not true, or is partially true.</p>
<p>The path to assets folder varies according to the build system being used. So it could be very confusing and sometimes make things too complicated.</p>
<h3 id="ADT"><a href="#ADT" class="headerlink" title="ADT"></a>ADT</h3><p>For the very traditional ADT build system, then the assets folder is located at <code>&lt;project root&gt;/assets</code></p>
<h3 id="Gradle"><a href="#Gradle" class="headerlink" title="Gradle"></a>Gradle</h3><p>For new Gradle build system, it changed the project structure definition, which is slightly different to the ADT one.</p>
<p>Gradle build system requires the assets folder is part of the “source code” so the asset folder should located at <code>&lt;project root&gt;/src/main/assets/</code>.</p>
<p>For more detailed information, check out this <a href="http://tools.android.com/tech-docs/new-build-system/user-guide#TOC-Project-Structure" target="_blank" rel="external">document</a>.</p>
<h3 id="Android-Studio"><a href="#Android-Studio" class="headerlink" title="Android Studio"></a>Android Studio</h3><p>In Android Studio (also apply to IntelliJ IDEA), things get a little bit more complicated. The assets path could be configured in project.</p>
<p>Android Studio store this path in project file (*.iml), which is an xml file. In the project file, under the XPath <code>/module/component@name=&quot;FacetManager&quot;/facet@type=&quot;android&quot;/configuration</code>, there could be a <code>&lt;option&gt;</code> node with name <code>ASSETS_FOLDER_RELATIVE_PATH</code> to descript the path.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">option</span> <span class="attr">name</span>=<span class="string">"ASSETS_FOLDER_RELATIVE_PATH"</span> <span class="attr">value</span>=<span class="string">"/assets"</span> /&gt;</span></div></pre></td></tr></table></figure>
<p>If the option element with specific name doesn’t exist, please manully create it.</p>
<h3 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h3><ul>
<li><p>Using Eclipse + ADT, place the assets at <code>&lt;project root&gt;/assets</code></p>
</li>
<li><p>Using Android Studio (or IntelliJ) with Ant or Maven, place the assets at <code>&lt;project root&gt;/assets</code>. And set <code>ASSETS_FOLDER_RELATIVE_PATH</code> to <code>/assets</code></p>
</li>
<li><p>Using Android Studio with Gradle, place the assets at <code>&lt;project root&gt;/src/main/assets/</code>. And set <code>ASSETS_FOLDER_RELATIVE_PATH</code> to <code>/src/main/assets</code>. And invoke <code>mergeAssets</code> during build.</p>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2013/12/13/asset-path-in-android-stuidio/" data-id="ciqg4g840005p6nsilc6dzhts" class="article-share-link">Share</a>
      
        <a href="http://timnew.me/blog/2013/12/13/asset-path-in-android-stuidio/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android-studio/">android studio</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/assets/">assets</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/build/">build</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/folder/">folder</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/gradle/">gradle</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/idea/">idea</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/intellij/">intellij</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/path/">path</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/resource/">resource</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-reuse-android-built-in-bluetooth-device-picker" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2013/12/11/reuse-android-built-in-bluetooth-device-picker/" class="article-date">
  <time datetime="2013-12-11T00:00:00.000Z" itemprop="datePublished">2013-12-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/android/">Android</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2013/12/11/reuse-android-built-in-bluetooth-device-picker/">Reuse Android built-in Bluetooth Device Picker</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Most Android devices support Bluetooth, and most Android ROMs has built-in bluetooth device picker, which is available to other system apps to select a bluetooth device. Theoretically the Bluetooth Device Picker could be reuse in any apps. But for some reasons, the API is not documented, and not published to everyone.</p>
<p>But it is possible to reuse such resources, so I wrote the following code. But due to the using of undocumented API, so it is not garenteed to work on all android devices.</p>
<p><a href="https://gist.github.com/timnew/7908603" target="_blank" rel="external">Code is available as Gist</a></p>
<script src="//gist.github.com/7908603.js"></script>
<p>In the code I uses the <a href="https://github.com/excilys/androidannotations" target="_blank" rel="external">Android Annotations</a>, but it should be easy to remove the dependency on <code>Android Annotations</code> by adding a constructor to BluetoothDeviceManager that accepts <code>Context</code>.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2013/12/11/reuse-android-built-in-bluetooth-device-picker/" data-id="ciqg4g83p005d6nsi7px0c299" class="article-share-link">Share</a>
      
        <a href="http://timnew.me/blog/2013/12/11/reuse-android-built-in-bluetooth-device-picker/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/activity/">activity</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bluetooth/">bluetooth</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/built-in/">built-in</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/device/">device</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/picker/">picker</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/reuse/">reuse</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/system/">system</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-arduino-ide-1-5-3-is-too-buggy-to-use-and-work-arounds" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2013/10/27/arduino-ide-1-5-3-is-too-buggy-to-use-and-work-arounds/" class="article-date">
  <time datetime="2013-10-27T00:00:00.000Z" itemprop="datePublished">2013-10-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/arduino/">Arduino</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2013/10/27/arduino-ide-1-5-3-is-too-buggy-to-use-and-work-arounds/">Arduino IDE 1.5.3 is too buggy to use and work arounds</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>The Arduino IDE 1.5.3 introduced some new features, such as support latest board Yun, or introduces new libraries and samples. But I found it is too buggy to use.</p>
<h2 id="1-Compile-code-against-Arduino-Nano-fails-due-to-parameter-mcu-passed-to-avrdude-is-missing"><a href="#1-Compile-code-against-Arduino-Nano-fails-due-to-parameter-mcu-passed-to-avrdude-is-missing" class="headerlink" title="1. Compile code against Arduino Nano fails due to parameter mcu passed to avrdude is missing."></a>1. Compile code against Arduino Nano fails due to parameter <code>mcu</code> passed to <code>avrdude</code> is missing.</h2><p><strong>Reason:</strong><br>The issue seems caused because the new IDE merged the menu items for Nano board. But for some reason, the configuration haven’t been updated accordingly.</p>
<p><strong>Workaround:</strong><br>Choose <code>Arduino Duemilanove and Diecimila</code> instead of <code>Arduino Nano</code>. Nano uses same chip as Duemilanove(ATmega328) and Diecimila(ATmega168), but uses a different PCB design. So the binary should be compatible.</p>
<h2 id="2-Compile-String-100-DEC-throws-ambiguous-matching-error"><a href="#2-Compile-String-100-DEC-throws-ambiguous-matching-error" class="headerlink" title="2. Compile String(100, DEC) throws ambiguous matching error"></a>2. Compile <code>String(100, DEC)</code> throws <code>ambiguous matching</code> error</h2><p><strong>Reason:</strong><br>The issue is caused because the API signature updated to <code>String(*, unsigned char)</code>, but constants are still declared as <code>int</code>.</p>
<p><strong>Workaround:</strong><br>Add force cast <code>DEC</code>, <code>HEX</code>, <code>BIN</code> to <code>byte</code> instead of <code>int</code>.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2013/10/27/arduino-ide-1-5-3-is-too-buggy-to-use-and-work-arounds/" data-id="ciqg4g83o005a6nsi2tjf7q1u" class="article-share-link">Share</a>
      
        <a href="http://timnew.me/blog/2013/10/27/arduino-ide-1-5-3-is-too-buggy-to-use-and-work-arounds/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ide/">IDE</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/string/">String</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/arduino/">arduino</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/buggy/">buggy</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/compile/">compile</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/error/">error</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nano/">nano</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/solution/">solution</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/workaround/">workaround</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-pitfall-in-isenum-method-in-java" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2013/07/18/pitfall-in-isenum-method-in-java/" class="article-date">
  <time datetime="2013-07-18T00:00:00.000Z" itemprop="datePublished">2013-07-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/java/">Java</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2013/07/18/pitfall-in-isenum-method-in-java/">Pitfall in isEnum method in Java</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>I found a very interesting phenomenon in Java type reflection when building an Android app.<br>I’m trying to build a common mechanism to serialize Enum into integer when writing it into database. To make it more flexible so I fetch the value type dynamically by using reflection. So I have the following code to check whether the value to be written is an enumeration:</p>
<figure class="highlight java"><figcaption><span>Code to check enumeration</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">CONVERTERS.add(<span class="keyword">new</span> ValueConverter() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">match</span><span class="params">(Object value)</span> </span>&#123;</div><div class="line">        Class type = value.getType();</div><div class="line">        <span class="keyword">return</span> type.isEnum(); <span class="comment">// Doesn't work</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">convert</span><span class="params">(Object value)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> String.valueOf(((Enum) value).ordinal());</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div></pre></td></tr></table></figure>
<p>I built the converters into a <code>responsibility chain</code>. The converter is applied only when <code>match</code> method returns true.</p>
<p>In the converter, I check the type with <code>isEnum</code> method. I expects the method yields true when the value is a enumeration. But later I found it doesn’t work as expected. And the behavior of this method is really confusing!</p>
<p>Here is how it works:</p>
<figure class="highlight java"><figcaption><span>How isEnum works</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">enum</span> ServiceStatus &#123;</div><div class="line">  NOT_COVERED,</div><div class="line">  PARTIAL,</div><div class="line">  FULL</div><div class="line">&#125;</div><div class="line"></div><div class="line">assertThat(ServiceStatus.class.isEnum()).isTrue();</div><div class="line">assertThat(ServiceStatus.FULL.class.isEnum()).isFalse();</div><div class="line">assertThat(ServiceStatus.FULL.getType().isEnum()).isFalse();</div><div class="line"></div></pre></td></tr></table></figure>
<p>Due to the implementation of Java Enumeration, the definition of enumeration value could be understood as the following code:</p>
<figure class="highlight java"><figcaption><span>Java Enumeration psudo-code</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ServiceStatus</span>$2 <span class="keyword">extends</span> <span class="title">ServiceStatus</span> </span>&#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> ServiceStatus FULL = <span class="keyword">new</span> ServiceStatus$<span class="number">2</span>();</div><div class="line"></div></pre></td></tr></table></figure>
<p>So the value <code>FULL</code> has a different type than <code>ServiceStatus</code> as I expected, the type of <code>FULL</code> is actually a subclass of <code>ServiceStatus</code>. And the enumeration value <code>FULL</code> is a singleton instance of the anonymous sub-class.</p>
<p>The the most unexpected behavior is that the <code>isEnum</code> method only returns true on Enumeration class itself, not its subclass!</p>
<p>To resolve this issue gracefully, I changed my implementation a little bit. Here is the updated implementation:</p>
<figure class="highlight java"><figcaption><span>Updated implementation</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">CONVERTERS.add(<span class="keyword">new</span> ValueConverter() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">match</span><span class="params">(Object value)</span> </span>&#123;</div><div class="line">        Class type = value.getType();</div><div class="line">        <span class="keyword">return</span> Enum.class.isAssignableFrom(type);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">convert</span><span class="params">(Object value)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> String.valueOf(((Enum) value).ordinal());</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div></pre></td></tr></table></figure>
<p>I uses <code>isAssignableFrom</code> to check whether value is the subclass of Enum or could be casted into Enum. I found this approach solved the issue gracefully.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2013/07/18/pitfall-in-isenum-method-in-java/" data-id="ciqg4g83q005g6nsicd7fp0hf" class="article-share-link">Share</a>
      
        <a href="http://timnew.me/blog/2013/07/18/pitfall-in-isenum-method-in-java/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/enumeration/">enumeration</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/isenum/">isEnum()</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/">java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/reflection/">reflection</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <a class="extend prev" rel="prev" href="/categories/programming/blog/2/">&laquo; __('prev')</a><a class="page-number" href="/categories/programming/">1</a><a class="page-number" href="/categories/programming/blog/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/categories/programming/blog/4/">4</a><a class="page-number" href="/categories/programming/blog/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/categories/programming/blog/8/">8</a><a class="extend next" rel="next" href="/categories/programming/blog/4/">__('next') &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    <div class="widget-wrap"><h3 class="widget-title">About Me</h3><div class="widget self-intro"><img src="/images/avatar.png"/><p>Tim is</p><ul class="description"><li>a<span>geek</span></li><li>an spare-time<span>web developer</span></li><li>a part-time<span>mobile developer</span></li><li>a night-time<span>photographer</span></li><li>an early-time<span>pcb solderer</span></li></ul><ul class="social-links"><li><a href="https://linkedin.com/in/timwen" target="_blank" class="linked-in"></a></li><li><a href="https://twitter.com/timnew" target="_blank" class="twitter"></a></li><li><a href="https://github.com/timnew" target="_blank" class="github"></a></li></ul></div></div>
  
    
  <div class="widget-wrap">
    <a href="/posts">
      <h3 class="widget-title">Recent Posts</h3>
    </a>
    <div class="widget recent-posts">
      <ul>
        
          <li>
            <a href="/blog/2016/04/23/collection-filtering-algorithm-with-bit-operation-part-1/">Collection Filtering Algorithm with Bit Operation - Part.1</a>
          </li>
        
          <li>
            <a href="/blog/2015/08/14/a-clean-way-to-test-rejected-promise/">A clean way to test rejected promise</a>
          </li>
        
          <li>
            <a href="/blog/2014/12/06/typical-eventbus-design-patterns/">Typical EventBus Design Patterns</a>
          </li>
        
          <li>
            <a href="/blog/2014/11/09/understand-styles-in-android-part-1-what-it-is-for-and-how-to-used-it/">Understand Styles in Android - Part 1. What it is for and how to used it</a>
          </li>
        
          <li>
            <a href="/blog/2014/11/07/walkthrough-untrusted-the-continuing-adventures-of-dr-eval/">Walkthrough: Untrusted - the Continuing Adventures of Dr. Eval</a>
          </li>
        
      </ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <a href="/tags">
      <h3 class="widget-title">Tag Cloud</h3>
    </a>
    <div class="widget tagcloud">
      <a href="/tags/net/" style="font-size: 10px;">.net</a> <a href="/tags/alfred/" style="font-size: 10px;">Alfred</a> <a href="/tags/algorithm/" style="font-size: 10px;">Algorithm</a> <a href="/tags/android/" style="font-size: 20px;">Android</a> <a href="/tags/android-studio/" style="font-size: 10px;">Android Studio</a> <a href="/tags/automation/" style="font-size: 10px;">Automation</a> <a href="/tags/binary/" style="font-size: 10px;">Binary</a> <a href="/tags/bit-operation/" style="font-size: 10px;">Bit Operation</a> <a href="/tags/bit-slicer/" style="font-size: 10px;">Bit Slicer</a> <a href="/tags/bloom-filter/" style="font-size: 10px;">Bloom Filter</a> <a href="/tags/boilerplate/" style="font-size: 10px;">Boilerplate</a> <a href="/tags/c/" style="font-size: 20px;">C#</a> <a href="/tags/ci/" style="font-size: 15px;">CI</a> <a href="/tags/css/" style="font-size: 10px;">CSS</a> <a href="/tags/cheat/" style="font-size: 10px;">Cheat</a> <a href="/tags/cheat-engine/" style="font-size: 10px;">Cheat Engine</a> <a href="/tags/class/" style="font-size: 10px;">Class</a> <a href="/tags/cocoa/" style="font-size: 10px;">Cocoa</a> <a href="/tags/collection/" style="font-size: 10px;">Collection</a> <a href="/tags/command/" style="font-size: 10px;">Command</a> <a href="/tags/continues-delivery/" style="font-size: 10px;">Continues Delivery</a> <a href="/tags/continues-integration/" style="font-size: 10px;">Continues Integration</a> <a href="/tags/crack/" style="font-size: 10px;">Crack</a> <a href="/tags/d/" style="font-size: 10px;">D</a> <a href="/tags/debugger/" style="font-size: 10px;">Debugger</a> <a href="/tags/deploy/" style="font-size: 10px;">Deploy</a> <a href="/tags/deployment/" style="font-size: 10px;">Deployment</a> <a href="/tags/design/" style="font-size: 10px;">Design</a> <a href="/tags/design-pattern/" style="font-size: 10px;">Design Pattern</a> <a href="/tags/event/" style="font-size: 10px;">Event</a>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <a href="/categories">
      <h3 class="widget-title">Categories</h3>
    </a>
    <div class="widget category-list">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/cracking/">Cracking</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/cracking/game/">Game</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/design/">Design</a><span class="category-list-count">3</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/design/visual/">Visual</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/design/web/">Web</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/game/">Game</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/game/programming-game/">Programming Game</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/geek-toy/">Geek Toy</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/package/">Package</a><span class="category-list-count">4</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/package/chrome-extension/">Chrome Extension</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/package/hexo/">Hexo</a><span class="category-list-count">3</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/">Practice</a><span class="category-list-count">22</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/practice/atom/">Atom</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/chrome/">Chrome</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/continues-integration/">Continues Integration</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/devops/">DevOps</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/hexo/">Hexo</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/mac/">Mac</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/shell/">Shell</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/textmate/">TextMate</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/web/">Web</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/windows/">Windows</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/git/">git</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/">Programming</a><span class="category-list-count">73</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/programming/algorithm/">Algorithm</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/android/">Android</a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/arduino/">Arduino</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/c/">C#</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/chrome/">Chrome</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/design-patterns/">Design Patterns</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/java/">Java</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/javascript/">JavaScript</a><span class="category-list-count">8</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/programming/javascript/coffeescript/">CoffeeScript</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/postgressql/">PostgresSql</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/powershell/">PowerShell</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/regular-expression/">Regular Expression</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/ruby/">Ruby</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/shell/">Shell</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/wpf/">WPF</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/web/">Web</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/node-js/">node.js</a><span class="category-list-count">10</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/thinking/">Thinking</a><span class="category-list-count">5</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <a href="/archives">
      <h3 class="widget-title">Archives</h3>
    </a>
    <div class="widget archive-list">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">December 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">November 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10/">October 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">September 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/08/">August 2014</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/07/">July 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/06/">June 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/05/">May 2014</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/04/">April 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/12/">December 2013</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/10/">October 2013</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/07/">July 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/06/">June 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/04/">April 2013</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/03/">March 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/02/">February 2013</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/01/">January 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/11/">November 2012</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/10/">October 2012</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/08/">August 2012</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/07/">July 2012</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/06/">June 2012</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/05/">May 2012</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/04/">April 2012</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/03/">March 2012</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/02/">February 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/10/">October 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/09/">September 2011</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/05/">May 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/04/">April 2011</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/11/">November 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/09/">September 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/04/">April 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/03/">March 2010</a><span class="archive-list-count">2</span></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 TimNew<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/#main" class="mobile-nav-link">Home</a>
  
    <a href="/archives/" class="mobile-nav-link">Archives</a>
  
    <a href="/photos/500px.html" class="mobile-nav-link">Photos</a>
  
</nav>
    
<script>
  var disqus_shortname = 'timnew-github';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<!-- <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script> -->
<script src="//code.jquery.com/jquery-2.1.1.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>