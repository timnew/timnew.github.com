<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Catégorie: Programming | ThoughtWorkshop</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="timnew programming code software">
<meta property="og:type" content="website">
<meta property="og:title" content="ThoughtWorkshop">
<meta property="og:url" content="http://timnew.me/categories/programming/blog/7/index.html">
<meta property="og:site_name" content="ThoughtWorkshop">
<meta property="og:description" content="timnew programming code software">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ThoughtWorkshop">
<meta name="twitter:description" content="timnew programming code software">
<meta name="twitter:creator" content="@timnew">
<link rel="publisher" href="108780866821209050000">
  
    <link rel="alternate" href="/atom.xml" title="ThoughtWorkshop" type="application/atom+xml">
  
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
<link rel="icon" type="image/png" href="/favicon-196x196.png" sizes="196x196">
<link rel="icon" type="image/png" href="/favicon-160x160.png" sizes="160x160">
<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-TileImage" content="/mstile-144x144.png">

  <!-- <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css"> -->
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-30567867-1', 'auto');

  ga('require', 'displayfeatures');

ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">ThoughtWorkshop</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Digital Bigs in my thought</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/#main">Home</a>
        
          <a class="main-nav-link" href="/archives/">Archives</a>
        
          <a class="main-nav-link" href="/photos/500px.html">Photos</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="Flux RSS"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Rechercher"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://timnew.me"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-exports-vs-module-exports-in-node-js" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2012/04/20/exports-vs-module-exports-in-node-js/" class="article-date">
  <time datetime="2012-04-20T00:00:00.000Z" itemprop="datePublished">2012-04-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/node-js/">node.js</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2012/04/20/exports-vs-module-exports-in-node-js/">exports vs module.exports in node.js</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>I was confused about how require function works in node.js for a long time. I found when I require a module, sometimes I can get the object I want, but sometimes, I don’t I just got an empty object, which give an <a href="/blog/2012/03/21/a-way-to-expose-singleton-object-and-its-constructor-in-nodejs">imagination</a> that we cannot export the object by assigning it to exports, but it seems somehow we can export a function by assignment.</p>
<p>Today, I re-read the <a href="http://docs.nodejs.org/api/modules.html#modules_the_module_object" target="_blank" rel="external">document</a> again, and I finally make clear that I misunderstood the “require” mechanism and how I did that.</p>
<p>I clearly remember this sentence in the <a href="http://docs.nodejs.org/api/modules.html#modules_the_module_object" target="_blank" rel="external">doc</a></p>
<blockquote>
<p> In particular <strong>module.exports</strong> is the <strong>same</strong> as the <strong>exports</strong> object.</p>
</blockquote>
<p>So I believed that the exports is just a shortcut alias to module.exports, we can use one instead of another without worrying about the differences between them two.<br>But this understanding is proved to be wrong. exports and module.exports are different.</p>
<p>Today I found this in the <a href="http://docs.nodejs.org/api/modules.html#modules_module_exports" target="_blank" rel="external">doc</a>:</p>
<blockquote>
<p>The <strong>exports</strong> object is <strong>created by</strong> the <strong>Module system</strong>. Sometimes this is <strong>not acceptable</strong>, many want their module to be an instance of some class. <strong>To do this assign the desired export object to module.exports.</strong></p>
</blockquote>
<p>So it says that module.exports is different from exports. And it you exports something by assignment, you need to assign it to module.exports.</p>
<p>Let’s try to understand these sentences deeper by code examples.</p>
<p>In the saying</p>
<blockquote>
<p>The <strong>exports</strong> object is <strong>created by</strong> the <strong>Module system</strong>.</p>
</blockquote>
<p>The word “created by” actually means when node.js try to load a javascript file, before executing any line of code in your file, the module system executes the following code first for you:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> exports = <span class="built_in">module</span>.exports</span><br></pre></td></tr></table></figure>
<p>So the actual interface in node.js’s module system is module object. the actual exported object is <code>module.exports</code> not <code>exports</code>.<br>And the <code>exports</code> is just a normal variable, and there is not “magic” in it. So if you assign something to it, it is replaced absolutely.</p>
<p>That’s why I failed to get the exported object I want when I assign the it to exports variable.</p>
<p>So to export some variable as a whole, we should always assign it to <code>module.exports</code>.<br>And at same time, if there is no good excuse, we’d better to keep the convention that <code>exports</code> is the shortcut alias to <code>module.exports</code>. So we should also assign the module.exports to exports.</p>
<p>As a conclusion, to export something in node.js by assignment, we should always follow the following pattern:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">exports = <span class="built_in">module</span>.exports = &#123;</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2012/04/20/exports-vs-module-exports-in-node-js/" data-id="cinedk70q001ochsigwqsu0h4" class="article-share-link">Partager</a>
      
        <a href="http://timnew.me/blog/2012/04/20/exports-vs-module-exports-in-node-js/#disqus_thread" class="article-comment-link">Commentaires</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/exports/">exports</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/module/">module</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/node-js/">node.js</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-powershell-script-to-serialize-and-deserialize-hash-object-to-and-from-ini-like-text" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2012/04/13/powershell-script-to-serialize-and-deserialize-hash-object-to-and-from-ini-like-text/" class="article-date">
  <time datetime="2012-04-13T00:00:00.000Z" itemprop="datePublished">2012-04-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/powershell/">PowerShell</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2012/04/13/powershell-script-to-serialize-and-deserialize-hash-object-to-and-from-ini-like-text/">Powershell script to serialize and deserialize hash-object to and from ini-like text</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Powershell and .net fx provides a dozen of approaches to manipulate hash-object. And it is really easy and convenient to initialize hash-object with values from environment variables, registry or cli arguments.<br>And Hash-Object can be accessed and built into hierarchy easily, so to use powershell hash-object as deploy configuration is really powerful and convenient.</p>
<p>But in our system, the application uses the ini-like key-value pair plain text as the initial configuration file. So our deploy script need the ability to serialize and deserialize hash-object to and from ini-like config.</p>
<p>So I composed this piece of script.</p>
<script src="//gist.github.com/2373809.js"></script>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2012/04/13/powershell-script-to-serialize-and-deserialize-hash-object-to-and-from-ini-like-text/" data-id="cinedk70n001jchsirsqd3aml" class="article-share-link">Partager</a>
      
        <a href="http://timnew.me/blog/2012/04/13/powershell-script-to-serialize-and-deserialize-hash-object-to-and-from-ini-like-text/#disqus_thread" class="article-comment-link">Commentaires</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/configuration/">configuration</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hash/">hash</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ini/">ini</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/powershell/">powershell</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/script/">script</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/serialization/">serialization</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-powershell-script-for-environment-provision-and-auto-deploy" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2012/04/05/powershell-script-for-environment-provision-and-auto-deploy/" class="article-date">
  <time datetime="2012-04-05T00:00:00.000Z" itemprop="datePublished">2012-04-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/powershell/">PowerShell</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2012/04/05/powershell-script-for-environment-provision-and-auto-deploy/">Powershell Script for Environment Provision and Auto Deploy</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>I’ve been working on MetaPaas project for a while. And composing deploy script is one of the my major tasks.<br>Here are some script snippets I found or I compose, which could be very useful in my daily work.</p>
<h3 id="Download-File-from-Web"><a href="#Download-File-from-Web" class="headerlink" title="Download File from Web"></a>Download File from Web</h3><p>This piece of script is useful when the script need to download package from CI server or configuration from configuration server etc.<br>Especially when wget or curl available.</p>
<p><strong>NOTICE: </strong> This piece of script enable you to download the file from web in Powershell without any 3rd party dependences. But its performance is not as good as wget. Wget is still recommended if there are quite a lot of files to be downloaded.</p>
<p><a href="http://huddledmasses.org/wget-2-for-powershell/" target="_blank" rel="external">Original Source</a></p>
<figure class="highlight powershell"><figcaption><span>Get-WebFile</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">## Get-WebFile (aka wget for PowerShell)</span></span><br><span class="line"><span class="comment">##############################################################################################################</span></span><br><span class="line"><span class="comment">## Downloads a file or page from the web</span></span><br><span class="line"><span class="comment">## History:</span></span><br><span class="line"><span class="comment">## v3.6 - Add -Passthru switch to output TEXT files</span></span><br><span class="line"><span class="comment">## v3.5 - Add -Quiet switch to turn off the progress reports ...</span></span><br><span class="line"><span class="comment">## v3.4 - Add progress report for files which don't report size</span></span><br><span class="line"><span class="comment">## v3.3 - Add progress report for files which report their size</span></span><br><span class="line"><span class="comment">## v3.2 - Use the pure Stream object because StreamWriter is based on TextWriter:</span></span><br><span class="line"><span class="comment">##        it was messing up binary files, and making mistakes with extended characters in text</span></span><br><span class="line"><span class="comment">## v3.1 - Unwrap the filename when it has quotes around it</span></span><br><span class="line"><span class="comment">## v3   - rewritten completely using HttpWebRequest + HttpWebResponse to figure out the file name, if possible</span></span><br><span class="line"><span class="comment">## v2   - adds a ton of parsing to make the output pretty</span></span><br><span class="line"><span class="comment">##        added measuring the scripts involved in the command, (uses Tokenizer)</span></span><br><span class="line"><span class="comment">##############################################################################################################</span></span><br><span class="line"><span class="keyword">function</span> Get-WebFile &#123;</span><br><span class="line">   <span class="keyword">param</span>(</span><br><span class="line">      <span class="variable">$url</span> = (<span class="built_in">Read-Host</span> <span class="string">"The URL to download"</span>),</span><br><span class="line">      <span class="variable">$fileName</span> = <span class="literal">$null</span>,</span><br><span class="line">      [switch]<span class="variable">$Passthru</span>,</span><br><span class="line">      [switch]<span class="variable">$quiet</span></span><br><span class="line">   )</span><br><span class="line"></span><br><span class="line">   <span class="variable">$req</span> = [System.Net.HttpWebRequest]::Create(<span class="variable">$url</span>);</span><br><span class="line">   <span class="variable">$res</span> = <span class="variable">$req</span>.GetResponse();</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span>(<span class="variable">$fileName</span> -and !(<span class="built_in">Split-Path</span> <span class="variable">$fileName</span>)) &#123;</span><br><span class="line">      <span class="variable">$fileName</span> = <span class="built_in">Join-Path</span> (<span class="built_in">Get-Location</span> -PSProvider <span class="string">"FileSystem"</span>) <span class="variable">$fileName</span></span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">elseif</span>((!<span class="variable">$Passthru</span> -and (<span class="variable">$fileName</span> <span class="nomarkup">-eq</span> <span class="literal">$null</span>)) -or ((<span class="variable">$fileName</span> <span class="nomarkup">-ne</span> <span class="literal">$null</span>) -and (<span class="built_in">Test-Path</span> -PathType <span class="string">"Container"</span> <span class="variable">$fileName</span>)))</span><br><span class="line">   &#123;</span><br><span class="line">      [string]<span class="variable">$fileName</span> = ([regex]<span class="string">'(?i)filename=(.*)$'</span>).Match(<span class="variable">$res</span>.Headers[<span class="string">"Content-Disposition"</span>] ).Groups[<span class="number">1</span>].Value</span><br><span class="line">      <span class="variable">$fileName</span> = <span class="variable">$fileName</span>.trim(<span class="string">"\/"</span><span class="string">"'"</span>)</span><br><span class="line">      <span class="keyword">if</span>(!<span class="variable">$fileName</span>) &#123;</span><br><span class="line">         <span class="variable">$fileName</span> = <span class="variable">$res</span>.ResponseUri.Segments[-<span class="number">1</span>]</span><br><span class="line">         <span class="variable">$fileName</span> = <span class="variable">$fileName</span>.trim(<span class="string">"\/"</span>)</span><br><span class="line">         <span class="keyword">if</span>(!<span class="variable">$fileName</span>) &#123;</span><br><span class="line">            <span class="variable">$fileName</span> = <span class="built_in">Read-Host</span> <span class="string">"Please provide a file name"</span></span><br><span class="line">         &#125;</span><br><span class="line">         <span class="variable">$fileName</span> = <span class="variable">$fileName</span>.trim(<span class="string">"\/"</span>)</span><br><span class="line">         <span class="keyword">if</span>(!([IO.FileInfo]<span class="variable">$fileName</span>).Extension) &#123;</span><br><span class="line">            <span class="variable">$fileName</span> = <span class="variable">$fileName</span> + <span class="string">"."</span> + <span class="variable">$res</span>.ContentType.Split(<span class="string">";"</span>)[<span class="number">0</span>].Split(<span class="string">"/"</span>)[<span class="number">1</span>]</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="variable">$fileName</span> = <span class="built_in">Join-Path</span> (<span class="built_in">Get-Location</span> -PSProvider <span class="string">"FileSystem"</span>) <span class="variable">$fileName</span></span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">if</span>(<span class="variable">$Passthru</span>) &#123;</span><br><span class="line">      <span class="variable">$encoding</span> = [System.Text.Encoding]::GetEncoding(<span class="variable">$res</span>.CharacterSet )</span><br><span class="line">      [string]<span class="variable">$output</span> = <span class="string">""</span></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span>(<span class="variable">$res</span>.StatusCode <span class="nomarkup">-eq</span> <span class="number">200</span>) &#123;</span><br><span class="line">      [int]<span class="variable">$goal</span> = <span class="variable">$res</span>.ContentLength</span><br><span class="line">      <span class="variable">$reader</span> = <span class="variable">$res</span>.GetResponseStream()</span><br><span class="line">      <span class="keyword">if</span>(<span class="variable">$fileName</span>) &#123;</span><br><span class="line">         <span class="variable">$writer</span> = <span class="built_in">new-object</span> System.IO.FileStream <span class="variable">$fileName</span>, <span class="string">"Create"</span></span><br><span class="line">      &#125;</span><br><span class="line">      [byte[]]<span class="variable">$buffer</span> = <span class="built_in">new-object</span> byte[] <span class="number">4096</span></span><br><span class="line">      [int]<span class="variable">$total</span> = [int]<span class="variable">$count</span> = <span class="number">0</span></span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">         <span class="variable">$count</span> = <span class="variable">$reader</span>.Read(<span class="variable">$buffer</span>, <span class="number">0</span>, <span class="variable">$buffer</span>.Length);</span><br><span class="line">         <span class="keyword">if</span>(<span class="variable">$fileName</span>) &#123;</span><br><span class="line">            <span class="variable">$writer</span>.Write(<span class="variable">$buffer</span>, <span class="number">0</span>, <span class="variable">$count</span>);</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">if</span>(<span class="variable">$Passthru</span>)&#123;</span><br><span class="line">            <span class="variable">$output</span> += <span class="variable">$encoding</span>.GetString(<span class="variable">$buffer</span>,<span class="number">0</span>,<span class="variable">$count</span>)</span><br><span class="line">         &#125; <span class="keyword">elseif</span>(!<span class="variable">$quiet</span>) &#123;</span><br><span class="line">            <span class="variable">$total</span> += <span class="variable">$count</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$goal</span> <span class="nomarkup">-gt</span> <span class="number">0</span>) &#123;</span><br><span class="line">               <span class="built_in">Write-Progress</span> <span class="string">"Downloading <span class="variable">$url</span>"</span> <span class="string">"Saving <span class="variable">$total</span> of <span class="variable">$goal</span>"</span> -id <span class="number">0</span> -percentComplete ((<span class="variable">$total</span>/<span class="variable">$goal</span>)*<span class="number">100</span>)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">               <span class="built_in">Write-Progress</span> <span class="string">"Downloading <span class="variable">$url</span>"</span> <span class="string">"Saving <span class="variable">$total</span> bytes..."</span> -id <span class="number">0</span></span><br><span class="line">            &#125;</span><br><span class="line">         &#125;</span><br><span class="line">      &#125; <span class="keyword">while</span> (<span class="variable">$count</span> <span class="nomarkup">-gt</span> <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">      <span class="variable">$reader</span>.Close()</span><br><span class="line">      <span class="keyword">if</span>(<span class="variable">$fileName</span>) &#123;</span><br><span class="line">         <span class="variable">$writer</span>.Flush()</span><br><span class="line">         <span class="variable">$writer</span>.Close()</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(<span class="variable">$Passthru</span>)&#123;</span><br><span class="line">         <span class="variable">$output</span></span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="variable">$res</span>.Close();</span><br><span class="line">   <span class="keyword">if</span>(<span class="variable">$fileName</span>) &#123;</span><br><span class="line">      ls <span class="variable">$fileName</span></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="Extract-File-with-Windows-Explorer"><a href="#Extract-File-with-Windows-Explorer" class="headerlink" title="Extract File with Windows Explorer"></a>Extract File with Windows Explorer</h3><p>This piece of code enable you to extract zip package without any 3rd party dependencies. It is useful environment provision script, which is usually executed on a Windows without anything being installed.</p>
<figure class="highlight powershell"><figcaption><span>Extract-Zip</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">Function</span> Extract-Zip ([string] <span class="variable">$zipPath</span>, [string]<span class="variable">$destination</span>) &#123;</span><br><span class="line">	<span class="variable">$progressbar</span> = <span class="number">4</span></span><br><span class="line">	<span class="variable">$shellApplication</span> = <span class="built_in">New-Object</span> -com shell.application</span><br><span class="line">	<span class="variable">$zipPackage</span> = <span class="variable">$shellApplication</span>.NameSpace(<span class="variable">$zipPath</span>)</span><br><span class="line">	<span class="variable">$destinationFolderName</span> = <span class="built_in">Join-Path</span> <span class="variable">$destination</span> <span class="string">"tiger"</span></span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">Test-Path</span> <span class="variable">$destinationFolderName</span> ) &#123;</span><br><span class="line">		<span class="built_in">Remove-Item</span> <span class="variable">$destinationFolderName</span> -Recurse -Force</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">New-Item</span> <span class="variable">$destinationFolderName</span> -type directory</span><br><span class="line">	<span class="variable">$destinationFolder</span> = <span class="variable">$shellApplication</span>.NameSpace(<span class="variable">$destinationFolderName</span>)</span><br><span class="line">	<span class="variable">$destinationFolder</span>.CopyHere(<span class="variable">$zipPackage</span>.Items(), <span class="variable">$progressbar</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="Interpolate-value-into-configuration"><a href="#Interpolate-value-into-configuration" class="headerlink" title="Interpolate value into configuration"></a>Interpolate value into configuration</h3><p>This piece of script enable you to replace the place-holders in configuration text with actual values.</p>
<figure class="highlight powershell"><figcaption><span>Apply-Config</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">Function</span> Apply-Config([hashtable]<span class="variable">$config</span>) &#123;</span><br><span class="line">	<span class="keyword">foreach</span>(<span class="variable">$line</span> <span class="keyword">in</span> <span class="variable">$input</span>) &#123;</span><br><span class="line">		<span class="keyword">foreach</span>(<span class="variable">$key</span> <span class="keyword">in</span> <span class="variable">$config</span>.Keys) &#123;</span><br><span class="line">			<span class="variable">$line</span> = <span class="variable">$line</span> <span class="nomarkup">-replace</span> <span class="variable">$key</span>, <span class="variable">$config</span>[<span class="variable">$key</span>]</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="variable">$line</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>This piece of script can be used in different scenarios:</p>
<h4 id="Prepare-Configuration"><a href="#Prepare-Configuration" class="headerlink" title="Prepare Configuration"></a>Prepare Configuration</h4><figure class="highlight powershell"><figcaption><span>Config</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$configuration</span> = @&#123;</span><br><span class="line">	<span class="string">"initialCatalog"</span> = <span class="string">"lion"</span></span><br><span class="line">	<span class="string">"logInitialCatalog"</span> = <span class="string">"lion_log"</span></span><br><span class="line"></span><br><span class="line">	<span class="string">"webServers"</span> = @(<span class="string">"192.168.122.46"</span>)</span><br><span class="line">	<span class="string">"dbServer"</span> = <span class="string">"192.168.122.65"</span></span><br><span class="line">	<span class="string">"SQLServerDataDir"</span> = <span class="string">"C:\Program Files\Microsoft SQL Server\MSSQL10_50.MSSQLSERVER\MSSQL\DATA"</span></span><br><span class="line">	<span class="string">"SQLServerDataFileSize"</span> = <span class="string">"10MB"</span></span><br><span class="line">	<span class="string">"dataset"</span> = <span class="string">"prod"</span></span><br><span class="line"></span><br><span class="line">	<span class="string">"appPoolUser"</span> = <span class="string">"$(<span class="variable">$env:COMPUTERNAME</span>)\Lion"</span></span><br><span class="line">	<span class="string">"appPoolPassword"</span> = <span class="string">"1zhlmcl..oostp"</span></span><br><span class="line">	<span class="string">"createAppPoolUser"</span> = <span class="literal">$true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Apply-config-to-in-memory-configuration-template"><a href="#Apply-config-to-in-memory-configuration-template" class="headerlink" title="Apply config to in-memory configuration template"></a>Apply config to in-memory configuration template</h4><figure class="highlight powershell"><figcaption><span>Apply config to string in memory</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="variable">$configurationText</span> = <span class="variable">$configurationTemplate</span> | Apply-Config(<span class="variable">$configuration</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="Create-configuration-file-according-to-template"><a href="#Create-configuration-file-according-to-template" class="headerlink" title="Create configuration file according to template"></a>Create configuration file according to template</h4><figure class="highlight powershell"><figcaption><span>Apply config to file</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">cat <span class="variable">$configurationTemplateFile</span> | Apply-Config(<span class="variable">$configuration</span>) &gt; <span class="variable">$configurationFile</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="Download-and-apply-configuration-from-configuration-server"><a href="#Download-and-apply-configuration-from-configuration-server" class="headerlink" title="Download and apply configuration from configuration server"></a>Download and apply configuration from configuration server</h4><figure class="highlight powershell"><figcaption><span>Download and apply config</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Get-WebFile -url <span class="variable">$configTemplateUrl</span> -Passthru | Apply-Config(<span class="variable">$configuration</span>) &gt; <span class="variable">$configurationFile</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2012/04/05/powershell-script-for-environment-provision-and-auto-deploy/" data-id="cinedk70a0016chsi2e60q91e" class="article-share-link">Partager</a>
      
        <a href="http://timnew.me/blog/2012/04/05/powershell-script-for-environment-provision-and-auto-deploy/#disqus_thread" class="article-comment-link">Commentaires</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/automation/">Automation</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ci/">CI</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/continues-delivery/">Continues Delivery</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/continues-integration/">Continues Integration</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/deploy/">Deploy</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/deployment/">Deployment</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/powershell/">Powershell</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/remote/">Remote</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/script/">Script</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-a-way-to-expose-singleton-object-and-its-constructor-in-node-js" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2012/03/21/a-way-to-expose-singleton-object-and-its-constructor-in-node-js/" class="article-date">
  <time datetime="2012-03-21T00:00:00.000Z" itemprop="datePublished">2012-03-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/node-js/">node.js</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2012/03/21/a-way-to-expose-singleton-object-and-its-constructor-in-node-js/">A way to expose singleton object and its constructor in node.js</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>In <a href="nodejs.org">Node.js</a> world, we usually encapsulate a service into a module, which means the module need to export the façade of the service. In most case the service could be a singleton, all apps use the same service.</p>
<p>But in some rare cases, people might would like to create several instances of the service ,which means the module also need to also export the service constructor.</p>
<p>A very natural idea is to export the default service, and expose the constructor as a method of the default instance. So we could consume the service in this way:</p>
<figure class="highlight js"><figcaption><span>Ideal Usage</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> defaultService = <span class="built_in">require</span>(<span class="string">'service'</span>);</span><br><span class="line"><span class="keyword">var</span> anotherService = service.newService();</span><br></pre></td></tr></table></figure>
<p>So we need to write the module in this way:</p>
<figure class="highlight js"><figcaption><span>Ideal Export</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Service</span>(<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="keyword">new</span> Service();</span><br><span class="line">moudle.exports.newService = Service;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><del>But for some reason, node.js doesn’t allow module to expose object by assigning the a object to module.exports.<br>To export a whole object, it is required to copy all the members of the object to <code>moudle.exports</code>, which drives out all kinds of tricky code.</del><br><ins>I misunderstood how node.js require works, and <a href="/blog/2012/04/20/exports_vs_module_exports_in_node_js">HERE</a> is the right understanding. Even I misunderstood the mechanism, but the conclusion of this post is still correct. To export function is still a more convenient way to export both default instance and the constructor.</ins></p>
<p>And things can become much worse when there are backward reference from the object property to itself.<br>So to solve this problem gracefully, we need to change our mind.<br>Since it is proved that it is tricky to export a object, can we try to expose the constructor instead?</p>
<p>Then answer is yes. And Node.js does allow we to assign a function to the module.exports to exports the function.<br>So we got this code.</p>
<figure class="highlight js"><figcaption><span>Export Constructor</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Service</span>(<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line"><span class="built_in">module</span>.exports = Service;</span><br></pre></td></tr></table></figure>
<p>So we can use create service instance in this way:</p>
<figure class="highlight js"><figcaption><span>Create Service</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Service = <span class="built_in">require</span>(<span class="string">'service'</span>);</span><br><span class="line"><span class="keyword">var</span> aService = <span class="keyword">new</span> Service();</span><br></pre></td></tr></table></figure>
<p>As you see, since the one we exported is constructor so we need to create a instance manually before we can use it. Another problem is that we lost the shared instance between module users, and it is a common requirement to share the same service instance between users.</p>
<p>How to solve this problem? Since as we know, function is also kind of object in javascript, so we can kind of add a member to the constructor called default, which holds the shared instance of the service.</p>
<p>This solution works but not in a graceful way! A crazy but fancy idea is that can we transform the constructor itself into kind of singleton instance??!! Which means you can do this:</p>
<figure class="highlight js"><figcaption><span>Export Singleton</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> defaultService = <span class="built_in">require</span>(<span class="string">'service'</span>);</span><br><span class="line">defaultService.foo();</span><br><span class="line"><span class="keyword">var</span> anotherService = service();</span><br><span class="line">anotherService.foo();</span><br></pre></td></tr></table></figure>
<p>The code style looks familiar? Yes, jQuery, and many other well-designed js libraries are designed to work in this way.<br>So our idea is kind of feasible but how?</p>
<p>Great thank to Javascript’s prototype system (or maybe SELF’s prototype system is more accurate.), we can simply make a service instance to be the constructor’s prototype.</p>
<figure class="highlight js"><figcaption><span>Actual Export</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Service</span>(<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line"><span class="built_in">module</span>.exports = Service;</span><br><span class="line">Service.__proto__ = <span class="keyword">new</span> Serivce;</span><br></pre></td></tr></table></figure>
<p>Sounds crazy, but works, and gracefully! That’s the beauty of Javascript.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2012/03/21/a-way-to-expose-singleton-object-and-its-constructor-in-node-js/" data-id="cinedk7080012chsiqbn2l0oq" class="article-share-link">Partager</a>
      
        <a href="http://timnew.me/blog/2012/03/21/a-way-to-expose-singleton-object-and-its-constructor-in-node-js/#disqus_thread" class="article-comment-link">Commentaires</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/exports/">exports</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js/">js</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js-hack/">js hack</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/module/">module</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/node-js/">node.js</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pattern/">pattern</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/singleton/">singleton</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-enhanced-typeof-operator-in-javascript" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2012/03/18/enhanced-typeof-operator-in-javascript/" class="article-date">
  <time datetime="2012-03-18T00:00:00.000Z" itemprop="datePublished">2012-03-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/javascript/">JavaScript</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2012/03/18/enhanced-typeof-operator-in-javascript/">Enhanced typeof() operator in JavaScript</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Javascript is weakly typed, and its type system always behaves different than your expectation.<br>Javascript provide typeof operator to test the type of a variable. it works fine generally. e.g.</p>
<figure class="highlight javascript"><figcaption><span>typeof default behaviors</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">typeof</span>(<span class="number">1</span>) === <span class="string">'number'</span></span><br><span class="line"><span class="keyword">typeof</span>(<span class="string">'hello'</span>) === <span class="string">'string'</span></span><br><span class="line"><span class="keyword">typeof</span>(&#123;&#125;) === <span class="string">'object'</span></span><br><span class="line"><span class="keyword">typeof</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;) === <span class="string">'function'</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>But it is not enough, it behaves stupid when you dealing with objects created by constructors. e.g.<br>if you expected<br><figure class="highlight javascript"><figcaption><span>Expected typeof behavior against object</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typeof</span>(<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'2012-12-12'</span>)) === <span class="string">'date'</span> <span class="comment">// Returns false</span></span><br></pre></td></tr></table></figure><br>Then you must be disappointed, since actually<br><figure class="highlight javascript"><figcaption><span>Actual typeof behavior against object</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typeof</span>(<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'2012-12-12'</span>)) === <span class="string">'object'</span> <span class="comment">// Returns true</span></span><br></pre></td></tr></table></figure><br>Yes, when you apply <code>typeof()</code> operator on any objects, it just yield the general type “object” rather than the more meaningful type “date”.</p>
<p>How can we make the <code>typeof()</code> operator works in the way as we expected?<br>As we know when we create a object, the special property of the object constructor will be set to the function that create the object. which means:</p>
<figure class="highlight javascript"><figcaption><span>Get constructor property of object</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'2012-1-1'</span>)).constructor <span class="comment">// Returns [Function Date]</span></span><br></pre></td></tr></table></figure>
<p>So ideally we can retrieve the name of the function as the type of the variable. And to be compatible with javascript’s native operator, we need to convert the name to lower case. So we got this expression:</p>
<figure class="highlight javascript"><figcaption><span>Simulate typeof operator behavior with constructor property</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">typeOf</span>(<span class="params">obj</span>) </span>&#123; <span class="comment">// Use capital O to differentiate this function from typeof operator</span></span><br><span class="line">	<span class="keyword">return</span> obj ? obj.constructor.name.toLowerCase() : <span class="keyword">typeof</span>(obj);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">typeOf(<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'2012-1-1'</span>)) === <span class="string">'date'</span> <span class="comment">// Returns true</span></span><br></pre></td></tr></table></figure>
<p>And luckily, we can also apply this to other primitive types, e.g:</p>
<figure class="highlight javascript"><figcaption><span>Apply typeOf to primitive types</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">typeOf(<span class="number">123</span>) === <span class="string">'number'</span>; <span class="comment">// Returns true</span></span><br><span class="line">typeOf(<span class="string">'hello'</span>) === <span class="string">'string'</span>; <span class="comment">// Returns true</span></span><br><span class="line">typeOf(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;) === <span class="string">'function'</span>;  <span class="comment">// Returns true</span></span><br></pre></td></tr></table></figure>
<p>or even</p>
<figure class="highlight javascript"><figcaption><span>Apply typeOf to anonymous object</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">typeOf(&#123;&#125;) === <span class="string">'object'</span>; <span class="comment">// Returns true</span></span><br></pre></td></tr></table></figure>
<p>So in general, we use this expression as new implementation of the <code>typeof()</code> operator! <strong>EXCEPT One case</strong>!</p>
<p>If someone declare the object constructor in this way, our new <code>typeof()</code> implementation will work improperly!</p>
<figure class="highlight javascript"><figcaption><span>Closure encapsulated anonymous constructor</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> SomeClass = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.someProperty=<span class="string">'some value'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<p>or even define the constructor like this</p>
<figure class="highlight javascript"><figcaption><span>Anonymous Closure</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> SomeClass = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.someProperty = <span class="string">'some value'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>And we will find that</p>
<figure class="highlight javascript"><figcaption><span>Apply typeOf to object instantiated by anonymous constructor</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">typeOf(<span class="keyword">new</span> SomeClass) === <span class="string">''</span>; <span class="comment">// Returns true</span></span><br></pre></td></tr></table></figure>
<p>the reason behind this is because the real constructor of the SomeClass is actually an anonymous function, whose name is not set.</p>
<p>To solve this problem, we need to declare the name of the constructor:</p>
<figure class="highlight javascript"><figcaption><span>Closure encapsulated named constructor</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> SomeClass = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">SomeClass</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.someProperty=<span class="string">'some value'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<p>or even define the constructor like this</p>
<figure class="highlight javascript"><figcaption><span>Named constructor</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> SomeClass = <span class="function"><span class="keyword">function</span> <span class="title">SomeClass</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.someProperty = <span class="string">'some value'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2012/03/18/enhanced-typeof-operator-in-javascript/" data-id="cinedk6zw0010chsirj0a326c" class="article-share-link">Partager</a>
      
        <a href="http://timnew.me/blog/2012/03/18/enhanced-typeof-operator-in-javascript/#disqus_thread" class="article-comment-link">Commentaires</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/fix/">fix</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js/">js</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js-hack/">js hack</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pitfall/">pitfall</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/type/">type</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/typeof/">typeof</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-distribute-files-to-multiple-servers-via-scp" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2012/03/15/distribute-files-to-multiple-servers-via-scp/" class="article-date">
  <time datetime="2012-03-15T00:00:00.000Z" itemprop="datePublished">2012-03-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/shell/">Shell</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2012/03/15/distribute-files-to-multiple-servers-via-scp/">Distribute files to multiple servers via scp</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>The most common task when operating the servers is to distribute a file to multiple servers.<br>So I wrote a piece of shell script to solve this problem:</p>
<figure class="highlight bash"><figcaption><span>mscp</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash  </span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"mscp &lt;source file&gt; &lt;target dir&gt;"</span>  </span><br><span class="line">SourceFile=<span class="variable">$1</span>  </span><br><span class="line">TargetDir=<span class="variable">$2</span>  </span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Copy <span class="variable">$SourceFile</span> to <span class="variable">$TargetDir</span> as <span class="variable">$RemoteUser</span>"</span>  </span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Enter the servers:"</span>  </span><br><span class="line"><span class="keyword">if</span> [<span class="_">-f</span> <span class="variable">$SourceFile</span> ]  </span><br><span class="line"><span class="keyword">then</span>  </span><br><span class="line">  <span class="built_in">printf</span> <span class="string">"File found, preparing to transfer\n"</span>  </span><br><span class="line">  <span class="keyword">while</span> <span class="built_in">read</span> server  </span><br><span class="line">  <span class="keyword">do</span>  </span><br><span class="line">  scp -p <span class="variable">$SourceFile</span> <span class="variable">$&#123;server&#125;</span>:<span class="variable">$TargetDir</span>  </span><br><span class="line">  <span class="keyword">done</span>  </span><br><span class="line"><span class="keyword">else</span>  </span><br><span class="line">  <span class="built_in">printf</span> <span class="string">"File \"<span class="variable">$SourceFile</span>\"not found\n"</span>  </span><br><span class="line">  <span class="built_in">exit</span> 1  </span><br><span class="line"><span class="keyword">fi</span>  </span><br><span class="line"><span class="built_in">exit</span> 0</span><br></pre></td></tr></table></figure>
<p>call the script <code>mscp &lt;source file&gt; &lt;target dir&gt;</code>, then the script will ask you the list of target servers. So you can type them one by one. If the remote user is different than you current user, you can also explicitly identify it by typeing user@server</p>
<p>Beside the previous scenario, there is a more common sceanrio, that you have got a server list stored in afile already. Then instead of type the servers line by line, you can pipe the file content to the script.<br>e.g:</p>
<figure class="highlight bash"><figcaption><span>Read server list from file</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat server_list.txt &gt; mscp src_files dest_path</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2012/03/15/distribute-files-to-multiple-servers-via-scp/" data-id="cinedk6zs000schsio2tv7c27" class="article-share-link">Partager</a>
      
        <a href="http://timnew.me/blog/2012/03/15/distribute-files-to-multiple-servers-via-scp/#disqus_thread" class="article-comment-link">Commentaires</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bash/">bash</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/scp/">scp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/server-management/">server management</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ssh/">ssh</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-html-codes-to-put-special-characters-on-your-web-page" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2012/02/04/html-codes-to-put-special-characters-on-your-web-page/" class="article-date">
  <time datetime="2012-02-04T00:00:00.000Z" itemprop="datePublished">2012-02-04</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/c/">C#</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2012/02/04/html-codes-to-put-special-characters-on-your-web-page/">HTML codes to put special characters on your Web page</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p> 尝试了一下用 LinqPad 把各种诡异的字母转成 Html 编码～结果发现不是左右字符都能转过去～<br>.net 内置的工具并不能完美的处理所有的 Html 编码～</p>
<p><a href="http://webdesign.about.com/library/bl_htmlcodes.htm" target="_blank" rel="external"> 字符来源 </a></p>
<p><strong>Query</strong><br><figure class="highlight csharp"><figcaption><span>Get html escaped unicodes</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"A,a,À,à,Á,á,Â,â,Ã,ã,Ä,ä,Å,å,Ā,ā,Ă,ă,Ą,ą,Ǟ,ǟ,Ǻ,ǻ,Æ,æ,Ǽ,ǽ,B,b,Ḃ,ḃ,C,c,Ć,ć,Ç,ç,Č,č,Ĉ,ĉ,Ċ,ċ,D,d,Ḑ,ḑ,Ď,ď,Ḋ,ḋ,Đ,đ,Ð,ð,Ǳ,ǳ,Ǆ,ǆ,E,e,È,è,É,é,Ě,ě,Ê,ê,Ë,ë,Ē,ē,Ĕ,ĕ,Ę,ę,Ė,ė,Ʒ,ʒ,Ǯ,ǯ,F,f,Ḟ,ḟ,ƒ,ﬀ,ﬁ,ﬂ,ﬃ,ﬄ,ﬅ,G,g,Ǵ,ǵ,Ģ,ģ,Ǧ,ǧ,Ĝ,ĝ,Ğ,ğ,Ġ,ġ,Ǥ,ǥ,H,h,Ĥ,ĥ,Ħ,ħ,I,i,Ì,ì,Í,í,Î,î,Ĩ,ĩ,Ï,ï,Ī,ī,Ĭ,ĭ,Į,į,İ,ı,Ĳ,ĳ,J,j,Ĵ,ĵ,K,k,Ḱ,ḱ,Ķ,ķ,Ǩ,ǩ,ĸ,L,l,Ĺ,ĺ,Ļ,ļ,Ľ,ľ,Ŀ,ŀ,Ł,ł,Ǉ,ǉ,M,m,Ṁ,ṁ,N,n,Ń,ń,Ņ,ņ,Ň,ň,Ñ,ñ,ŉ,Ŋ,ŋ,Ǌ,ǌ,O,o,Ò,ò,Ó,ó,Ô,ô,Õ,õ,Ö,ö,Ō,ō,Ŏ,ŏ,Ø,ø,Ő,ő,Ǿ,ǿ,Œ,œ,P,p,Ṗ,ṗ,Q,q,R,r,Ŕ,ŕ,Ŗ,ŗ,Ř,ř,ɼ,S,s,Ś,ś,Ş,ş,Š,š,Ŝ,ŝ,Ṡ,ṡ,ſ,ß,T,t,Ţ,ţ,Ť,ť,Ṫ,ṫ,Ŧ,ŧ,Þ,þ,U,u,Ù,ù,Ú,ú,Û,û,Ũ,ũ,Ü,ü,Ů,ů,Ū,ū,Ŭ,ŭ,Ų,ų,Ű,ű,V,v,W,w,Ẁ,ẁ,Ẃ,ẃ,Ŵ,ŵ,Ẅ,ẅ,X,x,Y,y,Ỳ,ỳ,Ý,ý,Ŷ,ŷ,Ÿ,ÿ,Z,z,Ź,ź,Ž,ž,Ż,ż"</span></span><br><span class="line">.Split(<span class="string">','</span>)</span><br><span class="line">.ToDictionary(k=&gt;k,HttpUtility.HtmlEncode)</span><br></pre></td></tr></table></figure></p>
<p><strong>Result</strong></p>
<p><code>Dictionary&lt;String,String&gt;</code><br><code>(304 items)</code></p>
<table><br>    <tr><th>Key</th><th>Value</th></tr><br>    <tr><td>A</td><td>A</td></tr><br>    <tr><td>a</td><td>a</td></tr><br>    <tr><td>À</td><td>&amp;#192;</td></tr><br>    <tr><td>à</td><td>&amp;#224;</td></tr><br>    <tr><td>Á</td><td>&amp;#193;</td></tr><br>    <tr><td>á</td><td>&amp;#225;</td></tr><br>    <tr><td>Â</td><td>&amp;#194;</td></tr><br>    <tr><td>â</td><td>&amp;#226;</td></tr><br>    <tr><td>Ã</td><td>&amp;#195;</td></tr><br>    <tr><td>ã</td><td>&amp;#227;</td></tr><br>    <tr><td>Ä</td><td>&amp;#196;</td></tr><br>    <tr><td>ä</td><td>&amp;#228;</td></tr><br>    <tr><td>Å</td><td>&amp;#197;</td></tr><br>    <tr><td>å</td><td>&amp;#229;</td></tr><br>    <tr><td>Ā</td><td>Ā</td></tr><br>    <tr><td>ā</td><td>ā</td></tr><br>    <tr><td>Ă</td><td>Ă</td></tr><br>    <tr><td>ă</td><td>ă</td></tr><br>    <tr><td>Ą</td><td>Ą</td></tr><br>    <tr><td>ą</td><td>ą</td></tr><br>    <tr><td>Ǟ</td><td>Ǟ</td></tr><br>    <tr><td>ǟ</td><td>ǟ</td></tr><br>    <tr><td>Ǻ</td><td>Ǻ</td></tr><br>    <tr><td>ǻ</td><td>ǻ</td></tr><br>    <tr><td>Æ</td><td>&amp;#198;</td></tr><br>    <tr><td>æ</td><td>&amp;#230;</td></tr><br>    <tr><td>Ǽ</td><td>Ǽ</td></tr><br>    <tr><td>ǽ</td><td>ǽ</td></tr><br>    <tr><td>B</td><td>B</td></tr><br>    <tr><td>b</td><td>b</td></tr><br>    <tr><td>Ḃ</td><td>Ḃ</td></tr><br>    <tr><td>ḃ</td><td>ḃ</td></tr><br>    <tr><td>C</td><td>C</td></tr><br>    <tr><td>c</td><td>c</td></tr><br>    <tr><td>Ć</td><td>Ć</td></tr><br>    <tr><td>ć</td><td>ć</td></tr><br>    <tr><td>Ç</td><td>&amp;#199;</td></tr><br>    <tr><td>ç</td><td>&amp;#231;</td></tr><br>    <tr><td>Č</td><td>Č</td></tr><br>    <tr><td>č</td><td>č</td></tr><br>    <tr><td>Ĉ</td><td>Ĉ</td></tr><br>    <tr><td>ĉ</td><td>ĉ</td></tr><br>    <tr><td>Ċ</td><td>Ċ</td></tr><br>    <tr><td>ċ</td><td>ċ</td></tr><br>    <tr><td>D</td><td>D</td></tr><br>    <tr><td>d</td><td>d</td></tr><br>    <tr><td>Ḑ</td><td>Ḑ</td></tr><br>    <tr><td>ḑ</td><td>ḑ</td></tr><br>    <tr><td>Ď</td><td>Ď</td></tr><br>    <tr><td>ď</td><td>ď</td></tr><br>    <tr><td>Ḋ</td><td>Ḋ</td></tr><br>    <tr><td>ḋ</td><td>ḋ</td></tr><br>    <tr><td>Đ</td><td>Đ</td></tr><br>    <tr><td>đ</td><td>đ</td></tr><br>    <tr><td>Ð</td><td>&amp;#208;</td></tr><br>    <tr><td>ð</td><td>&amp;#240;</td></tr><br>    <tr><td>Ǳ</td><td>Ǳ</td></tr><br>    <tr><td>ǳ</td><td>ǳ</td></tr><br>    <tr><td>Ǆ</td><td>Ǆ</td></tr><br>    <tr><td>ǆ</td><td>ǆ</td></tr><br>    <tr><td>E</td><td>E</td></tr><br>    <tr><td>e</td><td>e</td></tr><br>    <tr><td>È</td><td>&amp;#200;</td></tr><br>    <tr><td>è</td><td>&amp;#232;</td></tr><br>    <tr><td>É</td><td>&amp;#201;</td></tr><br>    <tr><td>é</td><td>&amp;#233;</td></tr><br>    <tr><td>Ě</td><td>Ě</td></tr><br>    <tr><td>ě</td><td>ě</td></tr><br>    <tr><td>Ê</td><td>&amp;#202;</td></tr><br>    <tr><td>ê</td><td>&amp;#234;</td></tr><br>    <tr><td>Ë</td><td>&amp;#203;</td></tr><br>    <tr><td>ë</td><td>&amp;#235;</td></tr><br>    <tr><td>Ē</td><td>Ē</td></tr><br>    <tr><td>ē</td><td>ē</td></tr><br>    <tr><td>Ĕ</td><td>Ĕ</td></tr><br>    <tr><td>ĕ</td><td>ĕ</td></tr><br>    <tr><td>Ę</td><td>Ę</td></tr><br>    <tr><td>ę</td><td>ę</td></tr><br>    <tr><td>Ė</td><td>Ė</td></tr><br>    <tr><td>ė</td><td>ė</td></tr><br>    <tr><td>Ʒ</td><td>Ʒ</td></tr><br>    <tr><td>ʒ</td><td>ʒ</td></tr><br>    <tr><td>Ǯ</td><td>Ǯ</td></tr><br>    <tr><td>ǯ</td><td>ǯ</td></tr><br>    <tr><td>F</td><td>F</td></tr><br>    <tr><td>f</td><td>f</td></tr><br>    <tr><td>Ḟ</td><td>Ḟ</td></tr><br>    <tr><td>ḟ</td><td>ḟ</td></tr><br>    <tr><td>ƒ</td><td>ƒ</td></tr><br>    <tr><td>ﬀ</td><td>ﬀ</td></tr><br>    <tr><td>ﬁ</td><td>ﬁ</td></tr><br>    <tr><td>ﬂ</td><td>ﬂ</td></tr><br>    <tr><td>ﬃ</td><td>ﬃ</td></tr><br>    <tr><td>ﬄ</td><td>ﬄ</td></tr><br>    <tr><td>ﬅ</td><td>ﬅ</td></tr><br>    <tr><td>G</td><td>G</td></tr><br>    <tr><td>g</td><td>g</td></tr><br>    <tr><td>Ǵ</td><td>Ǵ</td></tr><br>    <tr><td>ǵ</td><td>ǵ</td></tr><br>    <tr><td>Ģ</td><td>Ģ</td></tr><br>    <tr><td>ģ</td><td>ģ</td></tr><br>    <tr><td>Ǧ</td><td>Ǧ</td></tr><br>    <tr><td>ǧ</td><td>ǧ</td></tr><br>    <tr><td>Ĝ</td><td>Ĝ</td></tr><br>    <tr><td>ĝ</td><td>ĝ</td></tr><br>    <tr><td>Ğ</td><td>Ğ</td></tr><br>    <tr><td>ğ</td><td>ğ</td></tr><br>    <tr><td>Ġ</td><td>Ġ</td></tr><br>    <tr><td>ġ</td><td>ġ</td></tr><br>    <tr><td>Ǥ</td><td>Ǥ</td></tr><br>    <tr><td>ǥ</td><td>ǥ</td></tr><br>    <tr><td>H</td><td>H</td></tr><br>    <tr><td>h</td><td>h</td></tr><br>    <tr><td>Ĥ</td><td>Ĥ</td></tr><br>    <tr><td>ĥ</td><td>ĥ</td></tr><br>    <tr><td>Ħ</td><td>Ħ</td></tr><br>    <tr><td>ħ</td><td>ħ</td></tr><br>    <tr><td>I</td><td>I</td></tr><br>    <tr><td>i</td><td>i</td></tr><br>    <tr><td>Ì</td><td>&amp;#204;</td></tr><br>    <tr><td>ì</td><td>&amp;#236;</td></tr><br>    <tr><td>Í</td><td>&amp;#205;</td></tr><br>    <tr><td>í</td><td>&amp;#237;</td></tr><br>    <tr><td>Î</td><td>&amp;#206;</td></tr><br>    <tr><td>î</td><td>&amp;#238;</td></tr><br>    <tr><td>Ĩ</td><td>Ĩ</td></tr><br>    <tr><td>ĩ</td><td>ĩ</td></tr><br>    <tr><td>Ï</td><td>&amp;#207;</td></tr><br>    <tr><td>ï</td><td>&amp;#239;</td></tr><br>    <tr><td>Ī</td><td>Ī</td></tr><br>    <tr><td>ī</td><td>ī</td></tr><br>    <tr><td>Ĭ</td><td>Ĭ</td></tr><br>    <tr><td>ĭ</td><td>ĭ</td></tr><br>    <tr><td>Į</td><td>Į</td></tr><br>    <tr><td>į</td><td>į</td></tr><br>    <tr><td>İ</td><td>İ</td></tr><br>    <tr><td>ı</td><td>ı</td></tr><br>    <tr><td>Ĳ</td><td>Ĳ</td></tr><br>    <tr><td>ĳ</td><td>ĳ</td></tr><br>    <tr><td>J</td><td>J</td></tr><br>    <tr><td>j</td><td>j</td></tr><br>    <tr><td>Ĵ</td><td>Ĵ</td></tr><br>    <tr><td>ĵ</td><td>ĵ</td></tr><br>    <tr><td>K</td><td>K</td></tr><br>    <tr><td>k</td><td>k</td></tr><br>    <tr><td>Ḱ</td><td>Ḱ</td></tr><br>    <tr><td>ḱ</td><td>ḱ</td></tr><br>    <tr><td>Ķ</td><td>Ķ</td></tr><br>    <tr><td>ķ</td><td>ķ</td></tr><br>    <tr><td>Ǩ</td><td>Ǩ</td></tr><br>    <tr><td>ǩ</td><td>ǩ</td></tr><br>    <tr><td>ĸ</td><td>ĸ</td></tr><br>    <tr><td>L</td><td>L</td></tr><br>    <tr><td>l</td><td>l</td></tr><br>    <tr><td>Ĺ</td><td>Ĺ</td></tr><br>    <tr><td>ĺ</td><td>ĺ</td></tr><br>    <tr><td>Ļ</td><td>Ļ</td></tr><br>    <tr><td>ļ</td><td>ļ</td></tr><br>    <tr><td>Ľ</td><td>Ľ</td></tr><br>    <tr><td>ľ</td><td>ľ</td></tr><br>    <tr><td>Ŀ</td><td>Ŀ</td></tr><br>    <tr><td>ŀ</td><td>ŀ</td></tr><br>    <tr><td>Ł</td><td>Ł</td></tr><br>    <tr><td>ł</td><td>ł</td></tr><br>    <tr><td>Ǉ</td><td>Ǉ</td></tr><br>    <tr><td>ǉ</td><td>ǉ</td></tr><br>    <tr><td>M</td><td>M</td></tr><br>    <tr><td>m</td><td>m</td></tr><br>    <tr><td>Ṁ</td><td>Ṁ</td></tr><br>    <tr><td>ṁ</td><td>ṁ</td></tr><br>    <tr><td>N</td><td>N</td></tr><br>    <tr><td>n</td><td>n</td></tr><br>    <tr><td>Ń</td><td>Ń</td></tr><br>    <tr><td>ń</td><td>ń</td></tr><br>    <tr><td>Ņ</td><td>Ņ</td></tr><br>    <tr><td>ņ</td><td>ņ</td></tr><br>    <tr><td>Ň</td><td>Ň</td></tr><br>    <tr><td>ň</td><td>ň</td></tr><br>    <tr><td>Ñ</td><td>&amp;#209;</td></tr><br>    <tr><td>ñ</td><td>&amp;#241;</td></tr><br>    <tr><td>ŉ</td><td>ŉ</td></tr><br>    <tr><td>Ŋ</td><td>Ŋ</td></tr><br>    <tr><td>ŋ</td><td>ŋ</td></tr><br>    <tr><td>Ǌ</td><td>Ǌ</td></tr><br>    <tr><td>ǌ</td><td>ǌ</td></tr><br>    <tr><td>O</td><td>O</td></tr><br>    <tr><td>o</td><td>o</td></tr><br>    <tr><td>Ò</td><td>&amp;#210;</td></tr><br>    <tr><td>ò</td><td>&amp;#242;</td></tr><br>    <tr><td>Ó</td><td>&amp;#211;</td></tr><br>    <tr><td>ó</td><td>&amp;#243;</td></tr><br>    <tr><td>Ô</td><td>&amp;#212;</td></tr><br>    <tr><td>ô</td><td>&amp;#244;</td></tr><br>    <tr><td>Õ</td><td>&amp;#213;</td></tr><br>    <tr><td>õ</td><td>&amp;#245;</td></tr><br>    <tr><td>Ö</td><td>&amp;#214;</td></tr><br>    <tr><td>ö</td><td>&amp;#246;</td></tr><br>    <tr><td>Ō</td><td>Ō</td></tr><br>    <tr><td>ō</td><td>ō</td></tr><br>    <tr><td>Ŏ</td><td>Ŏ</td></tr><br>    <tr><td>ŏ</td><td>ŏ</td></tr><br>    <tr><td>Ø</td><td>&amp;#216;</td></tr><br>    <tr><td>ø</td><td>&amp;#248;</td></tr><br>    <tr><td>Ő</td><td>Ő</td></tr><br>    <tr><td>ő</td><td>ő</td></tr><br>    <tr><td>Ǿ</td><td>Ǿ</td></tr><br>    <tr><td>ǿ</td><td>ǿ</td></tr><br>    <tr><td>Œ</td><td>Œ</td></tr><br>    <tr><td>œ</td><td>œ</td></tr><br>    <tr><td>P</td><td>P</td></tr><br>    <tr><td>p</td><td>p</td></tr><br>    <tr><td>Ṗ</td><td>Ṗ</td></tr><br>    <tr><td>ṗ</td><td>ṗ</td></tr><br>    <tr><td>Q</td><td>Q</td></tr><br>    <tr><td>q</td><td>q</td></tr><br>    <tr><td>R</td><td>R</td></tr><br>    <tr><td>r</td><td>r</td></tr><br>    <tr><td>Ŕ</td><td>Ŕ</td></tr><br>    <tr><td>ŕ</td><td>ŕ</td></tr><br>    <tr><td>Ŗ</td><td>Ŗ</td></tr><br>    <tr><td>ŗ</td><td>ŗ</td></tr><br>    <tr><td>Ř</td><td>Ř</td></tr><br>    <tr><td>ř</td><td>ř</td></tr><br>    <tr><td>ɼ</td><td>ɼ</td></tr><br>    <tr><td>S</td><td>S</td></tr><br>    <tr><td>s</td><td>s</td></tr><br>    <tr><td>Ś</td><td>Ś</td></tr><br>    <tr><td>ś</td><td>ś</td></tr><br>    <tr><td>Ş</td><td>Ş</td></tr><br>    <tr><td>ş</td><td>ş</td></tr><br>    <tr><td>Š</td><td>Š</td></tr><br>    <tr><td>š</td><td>š</td></tr><br>    <tr><td>Ŝ</td><td>Ŝ</td></tr><br>    <tr><td>ŝ</td><td>ŝ</td></tr><br>    <tr><td>Ṡ</td><td>Ṡ</td></tr><br>    <tr><td>ṡ</td><td>ṡ</td></tr><br>    <tr><td>ſ</td><td>ſ</td></tr><br>    <tr><td>ß</td><td>&amp;#223;</td></tr><br>    <tr><td>T</td><td>T</td></tr><br>    <tr><td>t</td><td>t</td></tr><br>    <tr><td>Ţ</td><td>Ţ</td></tr><br>    <tr><td>ţ</td><td>ţ</td></tr><br>    <tr><td>Ť</td><td>Ť</td></tr><br>    <tr><td>ť</td><td>ť</td></tr><br>    <tr><td>Ṫ</td><td>Ṫ</td></tr><br>    <tr><td>ṫ</td><td>ṫ</td></tr><br>    <tr><td>Ŧ</td><td>Ŧ</td></tr><br>    <tr><td>ŧ</td><td>ŧ</td></tr><br>    <tr><td>Þ</td><td>&amp;#222;</td></tr><br>    <tr><td>þ</td><td>&amp;#254;</td></tr><br>    <tr><td>U</td><td>U</td></tr><br>    <tr><td>u</td><td>u</td></tr><br>    <tr><td>Ù</td><td>&amp;#217;</td></tr><br>    <tr><td>ù</td><td>&amp;#249;</td></tr><br>    <tr><td>Ú</td><td>&amp;#218;</td></tr><br>    <tr><td>ú</td><td>&amp;#250;</td></tr><br>    <tr><td>Û</td><td>&amp;#219;</td></tr><br>    <tr><td>û</td><td>&amp;#251;</td></tr><br>    <tr><td>Ũ</td><td>Ũ</td></tr><br>    <tr><td>ũ</td><td>ũ</td></tr><br>    <tr><td>Ü</td><td>&amp;#220;</td></tr><br>    <tr><td>ü</td><td>&amp;#252;</td></tr><br>    <tr><td>Ů</td><td>Ů</td></tr><br>    <tr><td>ů</td><td>ů</td></tr><br>    <tr><td>Ū</td><td>Ū</td></tr><br>    <tr><td>ū</td><td>ū</td></tr><br>    <tr><td>Ŭ</td><td>Ŭ</td></tr><br>    <tr><td>ŭ</td><td>ŭ</td></tr><br>    <tr><td>Ų</td><td>Ų</td></tr><br>    <tr><td>ų</td><td>ų</td></tr><br>    <tr><td>Ű</td><td>Ű</td></tr><br>    <tr><td>ű</td><td>ű</td></tr><br>    <tr><td>V</td><td>V</td></tr><br>    <tr><td>v</td><td>v</td></tr><br>    <tr><td>W</td><td>W</td></tr><br>    <tr><td>w</td><td>w</td></tr><br>    <tr><td>Ẁ</td><td>Ẁ</td></tr><br>    <tr><td>ẁ</td><td>ẁ</td></tr><br>    <tr><td>Ẃ</td><td>Ẃ</td></tr><br>    <tr><td>ẃ</td><td>ẃ</td></tr><br>    <tr><td>Ŵ</td><td>Ŵ</td></tr><br>    <tr><td>ŵ</td><td>ŵ</td></tr><br>    <tr><td>Ẅ</td><td>Ẅ</td></tr><br>    <tr><td>ẅ</td><td>ẅ</td></tr><br>    <tr><td>X</td><td>X</td></tr><br>    <tr><td>x</td><td>x</td></tr><br>    <tr><td>Y</td><td>Y</td></tr><br>    <tr><td>y</td><td>y</td></tr><br>    <tr><td>Ỳ</td><td>Ỳ</td></tr><br>    <tr><td>ỳ</td><td>ỳ</td></tr><br>    <tr><td>Ý</td><td>&amp;#221;</td></tr><br>    <tr><td>ý</td><td>&amp;#253;</td></tr><br>    <tr><td>Ŷ</td><td>Ŷ</td></tr><br>    <tr><td>ŷ</td><td>ŷ</td></tr><br>    <tr><td>Ÿ</td><td>Ÿ</td></tr><br>    <tr><td>ÿ</td><td>&amp;#255;</td></tr><br>    <tr><td>Z</td><td>Z</td></tr><br>    <tr><td>z</td><td>z</td></tr><br>    <tr><td>Ź</td><td>Ź</td></tr><br>    <tr><td>ź</td><td>ź</td></tr><br>    <tr><td>Ž</td><td>Ž</td></tr><br>    <tr><td>ž</td><td>ž</td></tr><br>    <tr><td>Ż</td><td>Ż</td></tr><br>    <tr><td>ż</td><td>ż</td></tr><br></table>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2012/02/04/html-codes-to-put-special-characters-on-your-web-page/" data-id="cinedk6zr000qchsi9k5qvq5z" class="article-share-link">Partager</a>
      
        <a href="http://timnew.me/blog/2012/02/04/html-codes-to-put-special-characters-on-your-web-page/#disqus_thread" class="article-comment-link">Commentaires</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/encoding/">encoding</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/escape/">escape</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/html/">html</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/unicode/">unicode</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-fluentassertion-is-not-compatible-with-xunit-extensions" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2011/09/14/fluentassertion-is-not-compatible-with-xunit-extensions/" class="article-date">
  <time datetime="2011-09-14T00:00:00.000Z" itemprop="datePublished">2011-09-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/c/">C#</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2011/09/14/fluentassertion-is-not-compatible-with-xunit-extensions/">FluentAssertion is not compatible with xUnit.Extensions</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>I met a weird problem that I found the Resharper Test Runner hangs when I introduced theory test case in my unit test.<br>After some spikes, I found the problem seems caused by the incompatibility between <a href="http://fluentassertions.codeplex.com/" target="_blank" rel="external">Fluent Assertion</a> and <a href="http://xunit.codeplex.com/" target="_blank" rel="external">xUnit.Extension</a>.<br>It is wired, and there seems to be no quick fix.<br>So I replace the Fluent Assertion with Should and <a href="http://should.codeplex.com/" target="_blank" rel="external">Should.Fluent</a>, which is a port of <a href="http://code.google.com/p/shouldit/" target="_blank" rel="external">ShouldIt</a>.<br>After that, everything goes well except the syntax between Fluent Assertion and Should Fluent are not compatible with each other, although they’re really similar.<br>But Should.Fluent doesn’t support <code>something.Should.Be()</code>, it requires <code>something.Should.Be.Equals()</code>, which is really annoying to me.</p>
<p>According to the Fluent’s introduction, Fluent is a direct fork of xUnit. And I’m not sure what’s the impact caused by this.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2011/09/14/fluentassertion-is-not-compatible-with-xunit-extensions/" data-id="cinedk6zh000ichsiie7qk4bm" class="article-share-link">Partager</a>
      
        <a href="http://timnew.me/blog/2011/09/14/fluentassertion-is-not-compatible-with-xunit-extensions/#disqus_thread" class="article-comment-link">Commentaires</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/should-fluent/">Should.Fluent</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/shouldit/">ShouldIt</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/compatibility/">compatibility</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/extension/">extension</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/fluent-assertion/">fluent assertion</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/library/">library</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/test/">test</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/unit-test/">unit test</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/xunit/">xUnit</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-push-data-flow-model-in-c-4-0" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2011/05/25/push-data-flow-model-in-c-4-0/" class="article-date">
  <time datetime="2011-05-25T00:00:00.000Z" itemprop="datePublished">2011-05-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/c/">C#</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2011/05/25/push-data-flow-model-in-c-4-0/">Push Data Flow Model in C# 4.0</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>In the pre 4.0 era, there are two interfaces reveal a new world to .net world. The two hero are <code>IEnumerable&lt;T&gt;</code> and <code>IEnumerator&lt;T&gt;</code>.<br>Based on these two interfaces, .net introduced a lot of amazing staffs that dramatically simplified the development related to data flow, these well known features are: foreach loop, yield keyword, and LINQ.<br>These 2 interfaces provide an common abstraction layer for the operation that pull data from the data source. And with this abstraction, you can apply foreach loop to almost every kind of data source in the .net world.<br><code>IEnumerable&lt;T&gt;</code> and <code>IEnumerator&lt;T&gt;</code> are cool, but they are somehow not so convenient to use in some cases, such as in asynchronous context or in obvious latency environment.<br>And the pull data flow model also has a capable brother, the push data flow, which can fill up the gap that pull model left for us.</p>
<p>So in .net 4.0, Microsoft introduce another 2 great interfaces, called <code>IObservable&lt;T&gt;</code> and <code>IObserver&lt;T&gt;</code>. These two interfaces, just as <code>IEnumerable&lt;T&gt;</code> and <code>IEnumerator&lt;T&gt;</code>, also open a door to the new world for every .net developer. With these 2 interfaces, people can setup a lot of features that corresponding to <code>IEnumerable&lt;T&gt;</code> and <code>IEnumerator&lt;T&gt;</code>.</p>
<p>Now Microsoft has a great library that called Rx(which stands for “Reactive Extension”), which provided a lot of features that similar to LINQ and more based on <code>IObserable&lt;T&gt;</code> and <code>IObserver&lt;T&gt;</code>.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2011/05/25/push-data-flow-model-in-c-4-0/" data-id="cinedk6ze000fchsib2htw02d" class="article-share-link">Partager</a>
      
        <a href="http://timnew.me/blog/2011/05/25/push-data-flow-model-in-c-4-0/#disqus_thread" class="article-comment-link">Commentaires</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/c/">C#</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/fp/">FP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linq/">LINQ</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/rx/">Rx</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/data-flow/">data flow</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/library/">library</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/push/">push</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/reactive/">reactive</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-sync-notify-pattern-for-wpf-cross-thread-view-model" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2011/04/29/sync-notify-pattern-for-wpf-cross-thread-view-model/" class="article-date">
  <time datetime="2011-04-29T00:00:00.000Z" itemprop="datePublished">2011-04-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/wpf/">WPF</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2011/04/29/sync-notify-pattern-for-wpf-cross-thread-view-model/">Sync Notify Pattern for WPF Cross Thread View Model</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>WPF has a powerful data binding mechanism, by which it is easy to implement MVVM and MVC pattern for UI application.<br>But thing gets not so beautiful once you introduced multi-thread into the app. Somehow, it means you have to manually call dispatcher method to synchronize the thread context, or else INotifyPropertyChanged contract causes cross thread violation, which is likely to drive UI component throw exception. But tons of calls to Dispatcher.Invoke or Dispatcher.BeginInvoke make you code ugly and hard to maintain. And it is boring to call dispatcher every time you try to write view model properties.</p>
<p>Is there any solution to this embarrassed situation?<br>The answer is Sync Notify pattern.</p>
<p>By analyzing the WPF data binding data flow, you can find the best point to behave the thread synchronization is at the boundary of your code and WPF implementation, which is the property changed  event raiser. To sync the thread context here makes your code clean and effective.</p>
<p>Typically, you might implement the <code>INotifyPropertyChanged</code> in following way:</p>
<figure class="highlight csharp"><figcaption><span>INofityPropertyChanged Implementation</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">region</span> INotifyPropertyChanged Members</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">event</span> PropertyChangedEventHandler PropertyChanged;</span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">Notify</span>(<span class="params"><span class="keyword">string</span> propertyName</span>)</span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (PropertyChanged != <span class="literal">null</span>)</span><br><span class="line">        PropertyChanged(<span class="keyword">this</span>, <span class="keyword">new</span> PropertyChangedEventArgs(propertyName));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endregion</span></span></span><br></pre></td></tr></table></figure>
<p>And you might implement the property of view model as following:</p>
<figure class="highlight csharp"><figcaption><span>Notify Property Decalration</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">region</span> Notify Property ViewModelProperty</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">string</span> viewModelPropertyBackField;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">string</span> ViewModelProperty</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">get</span> &#123; <span class="keyword">return</span> viewModelPropertyBackField; &#125;</span><br><span class="line">    <span class="keyword">set</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (viewModelPropertyBackField == <span class="keyword">value</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        viewModelPropertyBackField = <span class="keyword">value</span>;</span><br><span class="line">        Notify(<span class="string">"ViewModelProperty"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endregion</span></span></span><br></pre></td></tr></table></figure>
<p>This implementation works perfect in single thread context , but fails in multi-thread context. So we introduce a new event raiser implementation, which synchronize the thread context before raising the event:</p>
<figure class="highlight csharp"><figcaption><span>SyncNotify</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">region</span> Sync INotifyPropertyChanged Members</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">SyncNotify</span>(<span class="params"><span class="keyword">string</span> propertyName, <span class="keyword">bool</span> wait = <span class="literal">false</span>, Dispatcher dispatcher = <span class="literal">null</span></span>)</span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (PropertyChanged == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    dispatcher = dispatcher ?? System.Windows.Threading.Dispatcher.CurrentDispatcher;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (dispatcher.Thread == Thread.CurrentThread)</span><br><span class="line">    &#123;</span><br><span class="line">        PropertyChanged(<span class="keyword">this</span>, <span class="keyword">new</span> PropertyChangedEventArgs(propertyName));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (wait)</span><br><span class="line">        &#123;</span><br><span class="line">            dispatcher.Invoke(PropertyChanged, <span class="keyword">this</span>, <span class="keyword">new</span> PropertyChangedEventArgs(propertyName));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            dispatcher.BeginInvoke(PropertyChanged, <span class="keyword">this</span>, <span class="keyword">new</span> PropertyChangedEventArgs(propertyName));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endregion</span></span></span><br></pre></td></tr></table></figure>
<p>This method check the whether it is running on the same thread as dispatcher, it not it synchronize the thread.  It works perfect in most common cases.<br>But this implementation requires you to add some new code to the view model, and requires the event works as a delegate. This restriction sometime hurt, such as when you try to derive your view model from <code>ObservableCollection&lt;T&gt;</code>.<br><code>ObservableCollection&lt;T&gt;</code> declared PropertyChanged event, but implemented it explicitly, which means you won’t be able to raise the event by calling PropertyChanged directly. Instead, you need to call protected method OnPropertyChanged.</p>
<p>In such cases, you need the following implementation powered by extension method:</p>
<figure class="highlight csharp"><figcaption><span>SyncNotifyExtension</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">SyncNotifyExtension</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">SyncNotify</span>(<span class="params"><span class="keyword">this</span> INotifyPropertyChanged host, <span class="keyword">string</span> propertyName, Action&lt;PropertyChangedEventArgs&gt; eventRaiser, <span class="keyword">bool</span> wait = <span class="literal">false</span>, Dispatcher dispatcher = <span class="literal">null</span></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        Contract.Requires&lt;ArgumentNullException&gt;(host != <span class="literal">null</span>);</span><br><span class="line">        Contract.Requires&lt;ArgumentException&gt;(<span class="keyword">string</span>.IsNullOrWhiteSpace(propertyName));</span><br><span class="line">        Contract.Requires&lt;ArgumentNullException&gt;(eventRaiser != <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        dispatcher = dispatcher ?? System.Windows.Threading.Dispatcher.CurrentDispatcher;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (dispatcher.Thread == Thread.CurrentThread)</span><br><span class="line">        &#123;</span><br><span class="line">            eventRaiser(<span class="keyword">new</span> PropertyChangedEventArgs(propertyName));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (wait)</span><br><span class="line">            &#123;</span><br><span class="line">                dispatcher.Invoke(eventRaiser, <span class="keyword">new</span> PropertyChangedEventArgs(propertyName));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                dispatcher.BeginInvoke(eventRaiser, <span class="keyword">new</span> PropertyChangedEventArgs(propertyName));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">SyncNotify</span>(<span class="params"><span class="keyword">this</span> INotifyPropertyChanged host, <span class="keyword">string</span> propertyName, Action&lt;<span class="keyword">string</span>&gt; eventRaiser, <span class="keyword">bool</span> wait = <span class="literal">false</span>, Dispatcher dispatcher = <span class="literal">null</span></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        Contract.Requires&lt;ArgumentNullException&gt;(host != <span class="literal">null</span>);</span><br><span class="line">        Contract.Requires&lt;ArgumentException&gt;(<span class="keyword">string</span>.IsNullOrWhiteSpace(propertyName));</span><br><span class="line">        Contract.Requires&lt;ArgumentNullException&gt;(eventRaiser != <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        dispatcher = dispatcher ?? System.Windows.Threading.Dispatcher.CurrentDispatcher;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (dispatcher.Thread == Thread.CurrentThread)</span><br><span class="line">        &#123;</span><br><span class="line">            eventRaiser(propertyName);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (wait)</span><br><span class="line">            &#123;</span><br><span class="line">                dispatcher.Invoke(eventRaiser, propertyName);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                dispatcher.BeginInvoke(eventRaiser, propertyName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">SyncNotify</span>(<span class="params"><span class="keyword">this</span> INotifyPropertyChanged host, <span class="keyword">string</span> propertyName, Action&lt;<span class="keyword">object</span>, PropertyChangedEventArgs&gt; eventRaiser, <span class="keyword">bool</span> wait = <span class="literal">false</span>, Dispatcher dispatcher = <span class="literal">null</span></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        Contract.Requires&lt;ArgumentNullException&gt;(host != <span class="literal">null</span>);</span><br><span class="line">        Contract.Requires&lt;ArgumentException&gt;(<span class="keyword">string</span>.IsNullOrWhiteSpace(propertyName));</span><br><span class="line">        Contract.Requires&lt;ArgumentNullException&gt;(eventRaiser != <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        dispatcher = dispatcher ?? System.Windows.Threading.Dispatcher.CurrentDispatcher;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (dispatcher.Thread == Thread.CurrentThread)</span><br><span class="line">        &#123;</span><br><span class="line">            eventRaiser(host, <span class="keyword">new</span> PropertyChangedEventArgs(propertyName));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (wait)</span><br><span class="line">            &#123;</span><br><span class="line">                dispatcher.Invoke(eventRaiser, host, <span class="keyword">new</span> PropertyChangedEventArgs(propertyName));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                dispatcher.BeginInvoke(eventRaiser, host, <span class="keyword">new</span> PropertyChangedEventArgs(propertyName));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">SyncNotify</span>(<span class="params"><span class="keyword">this</span> INotifyPropertyChanged host, <span class="keyword">string</span> propertyName, Action&lt;<span class="keyword">object</span>, <span class="keyword">string</span>&gt; eventRaiser, <span class="keyword">bool</span> wait = <span class="literal">false</span>, Dispatcher dispatcher = <span class="literal">null</span></span>)</span><br><span class="line">    </span>&#123;</span><br><span class="line">        Contract.Requires&lt;ArgumentNullException&gt;(host != <span class="literal">null</span>);</span><br><span class="line">        Contract.Requires&lt;ArgumentException&gt;(<span class="keyword">string</span>.IsNullOrWhiteSpace(propertyName));</span><br><span class="line">        Contract.Requires&lt;ArgumentNullException&gt;(eventRaiser != <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        dispatcher = dispatcher ?? System.Windows.Threading.Dispatcher.CurrentDispatcher;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (dispatcher.Thread == Thread.CurrentThread)</span><br><span class="line">        &#123;</span><br><span class="line">            eventRaiser(host, propertyName);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (wait)</span><br><span class="line">            &#123;</span><br><span class="line">                dispatcher.Invoke(eventRaiser, host, propertyName);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                dispatcher.BeginInvoke(eventRaiser, host, propertyName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>These extension methods can be called inside the view model, and it ensures that the event is raised on the dispatcher thread.<br>Since these extension methods uses delegate to invoke the event raiser, so it is unnecessary to worry about the accessibility of the event raiser, event it is declared as protected or private. And 4 overloads can handle most common event raisers.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2011/04/29/sync-notify-pattern-for-wpf-cross-thread-view-model/" data-id="cinedk6zd000echsixxb33jll" class="article-share-link">Partager</a>
      
        <a href="http://timnew.me/blog/2011/04/29/sync-notify-pattern-for-wpf-cross-thread-view-model/#disqus_thread" class="article-comment-link">Commentaires</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/c/">C#</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mvvm/">MVVM</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ui/">UI</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wpf/">WPF</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/binding/">binding</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/multithread/">multithread</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/thread/">thread</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/view-model/">view model</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <a class="extend prev" rel="prev" href="/categories/programming/blog/6/">&laquo; __('prev')</a><a class="page-number" href="/categories/programming/">1</a><span class="space">&hellip;</span><a class="page-number" href="/categories/programming/blog/5/">5</a><a class="page-number" href="/categories/programming/blog/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/categories/programming/blog/8/">8</a><a class="extend next" rel="next" href="/categories/programming/blog/8/">__('next') &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    <div class="widget-wrap"><h3 class="widget-title">About Me</h3><div class="widget self-intro"><img src="/images/avatar.png"/><p>Tim is</p><ul class="description"><li>a<span>geek</span></li><li>an spare-time<span>web developer</span></li><li>a part-time<span>mobile developer</span></li><li>a night-time<span>photographer</span></li><li>an early-time<span>pcb solderer</span></li></ul><ul class="social-links"><li><a href="https://linkedin.com/in/timwen" target="_blank" class="linked-in"></a></li><li><a href="https://twitter.com/timnew" target="_blank" class="twitter"></a></li><li><a href="https://github.com/timnew" target="_blank" class="github"></a></li></ul></div></div>
  
    
  <div class="widget-wrap">
    <a href="/posts">
      <h3 class="widget-title">Articles récents</h3>
    </a>
    <div class="widget recent-posts">
      <ul>
        
          <li>
            <a href="/blog/2016/04/23/collection-filtering-algorithm-with-bit-operation-part-1/">Collection Filtering Algorithm with Bit Operation - Part.1</a>
          </li>
        
          <li>
            <a href="/blog/2015/08/14/a-clean-way-to-test-rejected-promise/">A clean way to test rejected promise</a>
          </li>
        
          <li>
            <a href="/blog/2014/12/06/typical-eventbus-design-patterns/">Typical EventBus Design Patterns</a>
          </li>
        
          <li>
            <a href="/blog/2014/11/09/understand-styles-in-android-part-1-what-it-is-for-and-how-to-used-it/">Understand Styles in Android - Part 1. What it is for and how to used it</a>
          </li>
        
          <li>
            <a href="/blog/2014/11/07/walkthrough-untrusted-the-continuing-adventures-of-dr-eval/">Walkthrough: Untrusted - the Continuing Adventures of Dr. Eval</a>
          </li>
        
      </ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <a href="/tags">
      <h3 class="widget-title">Nuage de mot-clés</h3>
    </a>
    <div class="widget tagcloud">
      <a href="/tags/net/" style="font-size: 10px;">.net</a> <a href="/tags/alfred/" style="font-size: 10px;">Alfred</a> <a href="/tags/algorithm/" style="font-size: 10px;">Algorithm</a> <a href="/tags/android/" style="font-size: 20px;">Android</a> <a href="/tags/android-studio/" style="font-size: 10px;">Android Studio</a> <a href="/tags/automation/" style="font-size: 10px;">Automation</a> <a href="/tags/binary/" style="font-size: 10px;">Binary</a> <a href="/tags/bit-operation/" style="font-size: 10px;">Bit Operation</a> <a href="/tags/bit-slicer/" style="font-size: 10px;">Bit Slicer</a> <a href="/tags/bloom-filter/" style="font-size: 10px;">Bloom Filter</a> <a href="/tags/boilerplate/" style="font-size: 10px;">Boilerplate</a> <a href="/tags/c/" style="font-size: 20px;">C#</a> <a href="/tags/ci/" style="font-size: 15px;">CI</a> <a href="/tags/css/" style="font-size: 10px;">CSS</a> <a href="/tags/cheat/" style="font-size: 10px;">Cheat</a> <a href="/tags/cheat-engine/" style="font-size: 10px;">Cheat Engine</a> <a href="/tags/class/" style="font-size: 10px;">Class</a> <a href="/tags/cocoa/" style="font-size: 10px;">Cocoa</a> <a href="/tags/collection/" style="font-size: 10px;">Collection</a> <a href="/tags/command/" style="font-size: 10px;">Command</a> <a href="/tags/continues-delivery/" style="font-size: 10px;">Continues Delivery</a> <a href="/tags/continues-integration/" style="font-size: 10px;">Continues Integration</a> <a href="/tags/crack/" style="font-size: 10px;">Crack</a> <a href="/tags/d/" style="font-size: 10px;">D</a> <a href="/tags/debugger/" style="font-size: 10px;">Debugger</a> <a href="/tags/deploy/" style="font-size: 10px;">Deploy</a> <a href="/tags/deployment/" style="font-size: 10px;">Deployment</a> <a href="/tags/design/" style="font-size: 10px;">Design</a> <a href="/tags/design-pattern/" style="font-size: 10px;">Design Pattern</a> <a href="/tags/event/" style="font-size: 10px;">Event</a>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <a href="/categories">
      <h3 class="widget-title">Catégories</h3>
    </a>
    <div class="widget category-list">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/cracking/">Cracking</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/cracking/game/">Game</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/design/">Design</a><span class="category-list-count">3</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/design/visual/">Visual</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/design/web/">Web</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/game/">Game</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/game/programming-game/">Programming Game</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/geek-toy/">Geek Toy</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/package/">Package</a><span class="category-list-count">4</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/package/chrome-extension/">Chrome Extension</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/package/hexo/">Hexo</a><span class="category-list-count">3</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/">Practice</a><span class="category-list-count">22</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/practice/atom/">Atom</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/chrome/">Chrome</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/continues-integration/">Continues Integration</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/devops/">DevOps</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/hexo/">Hexo</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/mac/">Mac</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/shell/">Shell</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/textmate/">TextMate</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/web/">Web</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/windows/">Windows</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/git/">git</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/">Programming</a><span class="category-list-count">73</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/programming/algorithm/">Algorithm</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/android/">Android</a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/arduino/">Arduino</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/c/">C#</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/chrome/">Chrome</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/design-patterns/">Design Patterns</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/java/">Java</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/javascript/">JavaScript</a><span class="category-list-count">8</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/programming/javascript/coffeescript/">CoffeeScript</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/postgressql/">PostgresSql</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/powershell/">PowerShell</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/regular-expression/">Regular Expression</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/ruby/">Ruby</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/shell/">Shell</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/wpf/">WPF</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/web/">Web</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/node-js/">node.js</a><span class="category-list-count">10</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/thinking/">Thinking</a><span class="category-list-count">5</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <a href="/archives">
      <h3 class="widget-title">Archives</h3>
    </a>
    <div class="widget archive-list">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">December 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">November 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10/">October 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">September 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/08/">August 2014</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/07/">July 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/06/">June 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/05/">May 2014</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/04/">April 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/12/">December 2013</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/10/">October 2013</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/07/">July 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/06/">June 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/04/">April 2013</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/03/">March 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/02/">February 2013</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/01/">January 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/11/">November 2012</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/10/">October 2012</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/08/">August 2012</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/07/">July 2012</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/06/">June 2012</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/05/">May 2012</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/04/">April 2012</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/03/">March 2012</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/02/">February 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/10/">October 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/09/">September 2011</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/05/">May 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/04/">April 2011</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/11/">November 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/09/">September 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/04/">April 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/03/">March 2010</a><span class="archive-list-count">2</span></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 TimNew<br>
      Propulsé by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/#main" class="mobile-nav-link">Home</a>
  
    <a href="/archives/" class="mobile-nav-link">Archives</a>
  
    <a href="/photos/500px.html" class="mobile-nav-link">Photos</a>
  
</nav>
    
<script>
  var disqus_shortname = 'timnew-github';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<!-- <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script> -->
<script src="//code.jquery.com/jquery-2.1.1.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>