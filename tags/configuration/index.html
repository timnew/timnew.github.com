<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Mot-clé: configuration | ThoughtWorkshop</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="timnew programming code software">
<meta property="og:type" content="website">
<meta property="og:title" content="ThoughtWorkshop">
<meta property="og:url" content="http://timnew.me/tags/configuration/index.html">
<meta property="og:site_name" content="ThoughtWorkshop">
<meta property="og:description" content="timnew programming code software">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ThoughtWorkshop">
<meta name="twitter:description" content="timnew programming code software">
<meta name="twitter:creator" content="@timnew">
<link rel="publisher" href="108780866821209050000">
  
    <link rel="alternate" href="/atom.xml" title="ThoughtWorkshop" type="application/atom+xml">
  
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
<link rel="icon" type="image/png" href="/favicon-196x196.png" sizes="196x196">
<link rel="icon" type="image/png" href="/favicon-160x160.png" sizes="160x160">
<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-TileImage" content="/mstile-144x144.png">

  <!-- <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css"> -->
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-30567867-1', 'auto');

  ga('require', 'displayfeatures');

ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">ThoughtWorkshop</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Digital Bigs in my thought</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/#main">Home</a>
        
          <a class="main-nav-link" href="/archives/">Archives</a>
        
          <a class="main-nav-link" href="/photos/500px.html">Photos</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="Flux RSS"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Rechercher"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://timnew.me"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-node-over-express-configuration" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2013/04/25/node-over-express-configuration/" class="article-date">
  <time datetime="2013-04-25T00:00:00.000Z" itemprop="datePublished">2013-04-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/node-js/">node.js</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2013/04/25/node-over-express-configuration/">Node over Express - Configuration</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h2><p>I have been working on Node.js related projects for quite a while, and have built apps with node both for the clients or personal projects, such as <a href="https://live-hall.herokuapp.com" target="_blank" rel="external">LiveHall</a>, <a href="https://github.com/timnew/CiMonitor" target="_blank" rel="external">CiMonitor</a>, etc. I have promised some one to share my experience on node. Today I’ll begin to work on this. This will be the first blog of the series.</p>
<h2 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h2><p>In this blog, I would like to talk about the configuration in node, which is common problem we need to solve in apps.</p>
<p>Problems related to configuration aren’t new, and there have been a dozens of mature solutions, but for Node.js apps, there is still something worth to be discussed.</p>
<p>Perhaps configuration could be treated as a kind of special data. Usually developers prefer to use data language to describe their configurations. Here are some examples:</p>
<ul>
<li>.net and Java developer usually uses Xml to describe their configuration</li>
<li>Ruby developer prefers Yaml as the configuration language</li>
<li>JavaScript developer tend to use Json</li>
</ul>
<p>Data languages are convenient, because developers can easily build DSL on it, then they describe the configuration with the DSL. But is the data language the best option available? Is it really suitable to be used in all scnearios?</p>
<p>Before we answer the questions, I would like to say something about the problem we’re facing. There is one common requirement to all kinds of configuration solutions, which is default values and overriding.</p>
<p>For example, as a Web app default, we use port 80; but in development environment, we prefer to use a port number over 1024, 3000 is a popular choice. That means we need to provide 80 as the default value of the port, but we wish to override the value with 3000 in the development environment.</p>
<p>For the languages I mentioned above, except for Yaml, Xml and Json, doesn’t provide native support of inheritance and overriding. It means we need to implement the mechanism by our own. Take Json as example, we might write the configuration in this way:</p>
<figure class="highlight json"><figcaption><span>Sample Json configuration</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"default"</span>: &#123;</span><br><span class="line">    <span class="attr">"port"</span>: <span class="number">80</span>,</span><br><span class="line">    <span class="attr">"serveAssets"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"development"</span>: &#123;</span><br><span class="line">    <span class="attr">"port"</span>: <span class="number">3000</span>,</span><br><span class="line">    <span class="attr">"database"</span>: <span class="string">"mongodb://localhost/development"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"test"</span>: &#123;</span><br><span class="line">    <span class="attr">"database"</span>: <span class="string">"mongodb://localhost/test"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"production"</span>: &#123;</span><br><span class="line">    <span class="attr">"serveAssets"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"database"</span>: <span class="string">"mongodb://ds0123456.mongolab.com:43487/my_sample_app"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The previous Json snippet is a typical example of web app configuration; it has a default section to provide the default values for all environments. Three sections for specific environments. To apply it corecctly to our app, we need to load and parse the Json file to get all data first, then load the values of the default section, then override the value with the values from specific environment.  In addition, we might wish to have the validation that yields error when the provided environment doesn’t exist.</p>
<p>This solution looks simple and seems to work, but when you try to apply this approach to your app in real life, you need to watch out some pitfalls.</p>
<h2 id="Issue-1-Confidential-Values"><a href="#Issue-1-Confidential-Values" class="headerlink" title="Issue 1: Confidential Values"></a>Issue 1: Confidential Values</h2><p>In the real world, values in configuration sometimes could be sensitive and need to be kept confidential. It could contain the credential to access your database, Or it could contain the key to decrypt the cookies. It may also contain private certificate that identifies and authenticates the app to other services. In these scenarios, you need to protect your configuration in order to avoid big trouble!</p>
<p>To solve the issue, you might think about adding new feature that enable you to to encrypt confidential values or to load it from a different safe source.  To achieve it, you might need to add another layer of DSL which add more complexities to your app and make your code harder to debug or to maintain.</p>
<h2 id="Issue-2-Dynamic-Data"><a href="#Issue-2-Dynamic-Data" class="headerlink" title="Issue 2: Dynamic Data"></a>Issue 2: Dynamic Data</h2><p>A solution to first issue,  one could store the environment related but sensitive data in the environment variables. The solution is simple and works perfectly, so I highly recommend it. However, to do this means you need the capability to load the value not only from Json directly but also from the environment variables.</p>
<p>Sometimes, such as deploying your app to Heroku/Nojitsu, might give rise that make the case trickier. After deployed the app to Heroku/Nojitsu, the default values are provided in Json directly, and some of which need to be overrode with the values from environment variables or you need to do it vice versa. These tricky requirements might blow your mind and your code away easily. It causes complicated DSL design and hundreds lines of implementation, but just to load your configuration properly. Obviously it is not a good idea.</p>
<h2 id="Issue-3-Complicated-Inheritance-Relationship"><a href="#Issue-3-Complicated-Inheritance-Relationship" class="headerlink" title="Issue 3: Complicated Inheritance Relationship"></a>Issue 3: Complicated Inheritance Relationship</h2><p>Scared about above cases? No, then how about complicated inheritance relationship between environments?</p>
<p>In some big and complicated web apps, there might be more than 3 basic environments, such as:</p>
<ul>
<li>Development: for developers to develop the app locally</li>
<li>Test: for developers to run unit or function test locally, such as mocha tests</li>
<li>Regression: for developers or QAs to run regression tests, such as cucumber tests</li>
<li>Integration: for QAs or Ops to test the integration with other apps</li>
<li>Staging: for ops and QAs to test the app in production like environment before it really goes live</li>
<li>Production: the environment serves your real users</li>
<li>…</li>
</ul>
<p>When try to write configurations for these environments, one might find there are only a few differences between environments. To make life easier,  to avoid the redundancy, introducing the inheritance between configurations might be a good idea.</p>
<p>As the consequence, the whole configuration becomes environments with complex inheritance relationship. And to support this kind of configuration inheritance,  a more complex DSL and hundreds lines of codes are needed.</p>
<h2 id="Some-Comments"><a href="#Some-Comments" class="headerlink" title="Some Comments"></a>Some Comments</h2><p>My assumption above seems to be a little too complex.  From some people, it might be the “WORST CASE SCENERIO” and hard to come by. But according to my experience, it is very common when building real web app with node. So if to solve it isn’t too hard, it could be better to consider it seriously and solve it gracefully.</p>
<p>Ruby developer might think they’re lucky because Yaml supports inheritance natively. But confidential data and dynamic data still troubles.  </p>
<h2 id="My-Solution"><a href="#My-Solution" class="headerlink" title="My Solution"></a>My Solution</h2><p>After learnt a number of painful lessons, I figured out a simple but working solution: Configuration as Code - describe the configuration with the same language that the business logic is described!</p>
<p>Configuration as code isn’t a new concept, but it is extremely handy when you use it in node applications! Let me explain why and how it works:</p>
<p>To protect the confidential configuration values, one should store them with environment variables, which are only accessible in the specific server.<br>Then one can load these values from the environment variables as dynamically values.</p>
<p>To do it in a data language such as Xml, Json or Yaml could be hard, but it will become as easy as taking a candy from a baby if it is done in the programming language that application applied/used, such as ruby or javascript.</p>
<p>To the configuration inheritance, OO languages have already provided very handy inheritance mechanism. Why do we need to invent one? Why not just use it? To the value overriding, OO programming tells us that it is called polymorphism. The only difference here from the typical scenario is that we override the values instead of the behaviors. But it isn’t an issue, because the value could be the result of the behavior, right?</p>
<p>Now I assume that everyone got a pretty good idea of what I am saying. If that is the case, then the below code should be able to be understood quite clearly,  which is a standard Node.js file written in <code>coffee script</code>:</p>
<figure class="highlight coffeescript"><figcaption><span>Configuration as Code Example</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">process.env.NODE_ENV = process.env.NODE_ENV?.toLowerCase() ? <span class="string">'development'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Config</span></span></span><br><span class="line">  port: <span class="number">80</span></span><br><span class="line">  cookieSecret: <span class="string">'!J@IOH$!BFBEI#KLjfelajf792fjdksi23989HKHD&amp;&amp;#^@'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Config</span>.<span class="title">development</span> <span class="keyword">extends</span> <span class="title">Config</span></span></span><br><span class="line">  port: <span class="number">3009</span></span><br><span class="line">  redis:</span><br><span class="line">    uri: <span class="string">'redis://localhost:6379'</span></span><br><span class="line">  mongo:</span><br><span class="line">    uri: <span class="string">'mongodb://localhost'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Config</span>.<span class="title">test</span> <span class="keyword">extends</span> <span class="title">Config</span>.<span class="title">development</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Config</span>.<span class="title">heroku</span> <span class="keyword">extends</span> <span class="title">Config</span></span></span><br><span class="line">  cookieSecret: process.env.COOKIE_SECRET</span><br><span class="line">  redis:</span><br><span class="line">    uri: process.env.REDISCLOUD_URL</span><br><span class="line">  mongo:</span><br><span class="line">    uri: process.env.MONGOLAB_URI</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="keyword">new</span> Config[process.env.NODE_ENV]()</span><br></pre></td></tr></table></figure>
<p>See, with the approach, one can describe the configuration easily and clearly in a few lines of code, but with built-in loading dynamical values capability and configuration inheritance and overriding capability.</p>
<p>In fact, with my suggestions, it might work better than expected! Here are the additional free benefits:</p>
<ol>
<li>Only one configuration is needed when  the app deployed to the cloud. Because all the host specific configurations are usually provided via the environment variables in Paas.</li>
<li>Have some simple and straightforward logic in the configuration, which could be very useful, especially if there is some naming convention in the configuration. But complicated or tricky logic should be strictly avoided, because it is hurts the readability and maintainability.</li>
<li>Easy to write tests for configurations, to ensure the values are properly set. It could be very handy when there are complicated inheritance relationships between configurations, or have some simple logic in your configuration.</li>
<li>Avoid to instantiate and execute the code that isn’t related to the current environment, which could be helpful to avoid overhead to instantiate unused expensive resources or to avoid errors caused because of incompatibility between environments.</li>
<li>Get runtime error when the configuration for the environment doesn’t exist.</li>
</ol>
<hr>

<p>Besides of the content, I want to say thank you to my English teacher Marina Sarg, who helped me on this series of blog a lot. Without her, there won’t be this series of blogs. Marina, thank you very much.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2013/04/25/node-over-express-configuration/" data-id="cinedk738005achsisiit4gn6" class="article-share-link">Partager</a>
      
        <a href="http://timnew.me/blog/2013/04/25/node-over-express-configuration/#disqus_thread" class="article-comment-link">Commentaires</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/configuration/">configuration</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/express/">express</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/node/">node</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/node-over-express/">node over express</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-manage-configuration-in-rails-way-on-node-js-by-using-inheritance" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2013/02/22/manage-configuration-in-rails-way-on-node-js-by-using-inheritance/" class="article-date">
  <time datetime="2013-02-22T00:00:00.000Z" itemprop="datePublished">2013-02-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/node-js/">node.js</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2013/02/22/manage-configuration-in-rails-way-on-node-js-by-using-inheritance/">Manage configuration in Rails way on node.js by using inheritance</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Application is usually required to run in different environments. To manage the differences between the environments, we usually introduce the concept of Environment Specific Configuration.<br>In Rails application, by default, Rails have provided 3 different environments, they are the well known, <code>development</code>, <code>test</code> and <code>production</code>.<br>And we can use the environment variable <code>RAILS_ENV</code> to tell Rails which environment to be loaded, if the <code>RAILS_ENV</code> is not provided, Rails will load the app in <code>development</code> env by default.</p>
<p>This approach is very convenient, so we want to apply it to anywhere. But in node.js, Express doesn’t provide any configuration management. So we need to built the feature by ourselves.</p>
<p>The environment management usually provide the following functionalities:</p>
<ul>
<li>Allow us to provide some configuration values as the default, which will be loaded in all environments, usually we call it <code>common</code>.</li>
<li>Specific configuration will be loaded according to the environment variable, and will override some values in the <code>common</code> if necessary.</li>
</ul>
<p>Rails uses <code>YAML</code> to hold these configurations, which is concise but powerful enough for this purpose. And YAML provided inheritance mechanism by default, so you can reduce the duplication by using inheritance.</p>
<figure class="highlight yaml"><figcaption><span>Inheritance in Rails YAML Configuration</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="attr">development:</span> <span class="meta">&amp;defaults</span></span><br><span class="line"><span class="attr">  adapter:</span> mysql</span><br><span class="line"><span class="attr">  encoding:</span> utf8</span><br><span class="line"><span class="attr">  database:</span> sample_app_development</span><br><span class="line"><span class="attr">  username:</span> root</span><br><span class="line"></span><br><span class="line"><span class="attr">test:</span></span><br><span class="line">  &lt;&lt;: <span class="meta">*defaults</span></span><br><span class="line"><span class="attr">  database:</span> sample_app_test</span><br><span class="line"></span><br><span class="line"><span class="attr">cucumber:</span></span><br><span class="line">  &lt;&lt;: <span class="meta">*defaults</span></span><br><span class="line"><span class="attr">  database:</span> sample_app_cucumber</span><br><span class="line"></span><br><span class="line"><span class="attr">production:</span></span><br><span class="line">  &lt;&lt;: <span class="meta">*defaults</span></span><br><span class="line"><span class="attr">  database:</span> sample_app_production</span><br><span class="line"><span class="attr">  username:</span> sample_app</span><br><span class="line"><span class="attr">  password:</span> secret_word</span><br><span class="line"><span class="attr">  host:</span> ec2<span class="bullet">-10</span><span class="bullet">-18</span><span class="bullet">-1</span><span class="bullet">-115.</span>us-west<span class="bullet">-2.</span>compute.amazonaws.com</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>In <code>express</code> and <code>node.js</code>, if we follow the same approach, comparing to <code>YAML</code>, we prefer <code>JSON</code>, which is supported natively by <code>Javascript</code>.<br>But to me, <code>JSON</code> isn’t the best option, there are some disadvantages of <code>JSON</code>:</p>
<ul>
<li>JSON Syntax is not concise enough</li>
<li>Matching the brackets and appending commas to the line end are distractions</li>
<li>Lack of flexility</li>
</ul>
<p>As an answer to these issues, I chose <code>coffee-script</code> instead of <code>JSON</code>.<br><code>Coffee</code> is concise. And similar to <code>YAML</code>, <code>coffee</code> uses indention to indicate the nested level. And <code>coffee</code> is executable, which provides a lot of flexibilities to the configuration. So we can implement a Domain Specific Language form</p>
<p>To do it, we need to solve 4 problems:</p>
<ol>
<li>Allow dev to declare default configuration.</li>
<li>Load specific configuration besides of default one.</li>
<li>Specific configuration can overrides the values in the default one.</li>
<li>Code is concise, clean and reading-friendly.</li>
</ol>
<p>Inspired by the YAML solution, I work out my first solution:</p>
<figure class="highlight coffeescript"><figcaption><span>Configuration in coffee script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">_ = <span class="built_in">require</span>(<span class="string">'underscore'</span>)</span><br><span class="line"></span><br><span class="line">config = &#123;&#125;</span><br><span class="line"></span><br><span class="line">config[<span class="string">'common'</span>] =</span><br><span class="line">  adapter: <span class="string">"mysql"</span></span><br><span class="line">  encoding: <span class="string">"utf8"</span></span><br><span class="line">  database: <span class="string">"sample_app_development"</span></span><br><span class="line">  username: <span class="string">"root"</span></span><br><span class="line"></span><br><span class="line">config[<span class="string">'development'</span>] = &#123;&#125;</span><br><span class="line"></span><br><span class="line">config[<span class="string">'test] =</span><br><span class="line">  database:"sample_app_test"</span><br><span class="line"></span><br><span class="line">config['</span>cucumber<span class="string">'] =</span><br><span class="line">  database:"sample_app_cucumber"</span><br><span class="line"></span><br><span class="line">config['</span>production<span class="string">'] =</span><br><span class="line">  database:"sample_app_production"</span><br><span class="line">  username:"sample_app"</span><br><span class="line">  password:"secret_word"</span><br><span class="line">  host:"ec2-10-18-1-115.us-west-2.compute.amazonaws.com"</span><br><span class="line"></span><br><span class="line">_.extend exports, config.common</span><br><span class="line"></span><br><span class="line">specificConfig = config[process.env.NODE_ENV ?'</span>development<span class="string">']</span><br><span class="line"></span><br><span class="line">if specificConfig?</span><br><span class="line">  _.extend exports, specificConfig</span><br><span class="line"></span></span><br></pre></td></tr></table></figure>
<p><code>YAML</code> is data centric language, so its inheritance is more like “mixin” another piece of data. So I uses <code>underscore</code> to help me to mixin the specific configuration over the default one, which overrides the overlapped values.</p>
<p>But if we jump out of the YAML’s box, let us think about the <code>Javascript</code> itself, Javascript is a prototype language, which means it had already provide an overriding mechanism natively. Each object inherits and overrides the value from its prototype.<br>So I worked out the 2nd solution:</p>
<figure class="highlight coffeescript"><figcaption><span>Prototype based Configuration</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">config = &#123;&#125;</span><br><span class="line"></span><br><span class="line">config[<span class="string">'common'</span>] =</span><br><span class="line">  adapter: <span class="string">"mysql"</span></span><br><span class="line">  encoding: <span class="string">"utf8"</span></span><br><span class="line">  database: <span class="string">"sample_app_development"</span></span><br><span class="line">  username: <span class="string">"root"</span></span><br><span class="line"></span><br><span class="line">config[<span class="string">'development'</span>] = &#123;&#125;</span><br><span class="line">config[<span class="string">'development'</span>].__proto__ = config[<span class="string">'common'</span>]</span><br><span class="line"></span><br><span class="line">config[<span class="string">'test] =</span><br><span class="line">  __proto__: config['</span>common<span class="string">']</span><br><span class="line">  database:"sample_app_test"</span><br><span class="line"></span><br><span class="line">config['</span>cucumber<span class="string">'] =</span><br><span class="line">  __proto__: config['</span>test<span class="string">']</span><br><span class="line">  database:"sample_app_cucumber"</span><br><span class="line"></span><br><span class="line">config['</span>production<span class="string">'] =</span><br><span class="line">  __proto__: config['</span>common<span class="string">']</span><br><span class="line">  database:"sample_app_production"</span><br><span class="line">  username:"sample_app"</span><br><span class="line">  password:"secret_word"</span><br><span class="line">  host:"ec2-10-18-1-115.us-west-2.compute.amazonaws.com"</span><br><span class="line"></span><br><span class="line">process.env.NODE_ENV = process.env.NODE_ENV?.toLowerCase() ?'</span>development<span class="string">'</span><br><span class="line"></span><br><span class="line">module.exports = config[process.env.NODE_ENV]</span><br><span class="line"></span></span><br></pre></td></tr></table></figure>
<p>This approach works, but looks kind of ugly. Since we’re using <code>coffee</code>, which provides the syntax sugar for class and class inheritance.<br>So we have the 3rd version:</p>
<figure class="highlight coffeescript"><figcaption><span>Class based configuration</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">process.env.NODE_ENV = process.env.NODE_ENV?.toLowerCase() ? <span class="string">'development'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Config</span></span></span><br><span class="line">  adapter: <span class="string">"mysql"</span></span><br><span class="line">  encoding: <span class="string">"utf8"</span></span><br><span class="line">  database: <span class="string">"sample_app_development"</span></span><br><span class="line">  username: <span class="string">"root"</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Config</span>.<span class="title">development</span> <span class="keyword">extends</span> <span class="title">Config</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Config</span>.<span class="title">test</span> <span class="keyword">extends</span> <span class="title">Config</span></span></span><br><span class="line">  database: <span class="string">"sample_app_test"</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Config</span>.<span class="title">cucumber</span> <span class="keyword">extends</span> <span class="title">Config</span></span></span><br><span class="line">  database: <span class="string">"sample_app_cucumber"</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Config</span>.<span class="title">common</span> <span class="keyword">extends</span> <span class="title">Config</span></span></span><br><span class="line">  database: <span class="string">"sample_app_production"</span></span><br><span class="line">  username: <span class="string">"sample_app"</span></span><br><span class="line">  password: <span class="string">"secret_word"</span></span><br><span class="line">  host: <span class="string">"ec2-10-18-1-115.us-west-2.compute.amazonaws.com"</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="keyword">new</span> Config[process.env.NODE_ENV]()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Now the code looks clean, and we can improve it a step further if necessary. We can try to separate the configurations into files, and required by the file name:</p>
<figure class="highlight coffeescript"><figcaption><span>Class based configuration</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># config/config.coffee</span></span><br><span class="line">configName = process.env.NODE_ENV = process.env.NODE_ENV?.toLowerCase() ? <span class="string">'development'</span></span><br><span class="line"></span><br><span class="line">SpecificConfig  = requrie(<span class="string">"./envs/<span class="subst">#&#123;configName&#125;</span>"</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="keyword">new</span> SpecificConfig()</span><br><span class="line"></span><br><span class="line"><span class="comment"># config/envs/commmon.coffee</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Common</span></span></span><br><span class="line">  adapter: <span class="string">"mysql"</span></span><br><span class="line">  encoding: <span class="string">"utf8"</span></span><br><span class="line">  database: <span class="string">"sample_app_development"</span></span><br><span class="line">  username: <span class="string">"root"</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = Common</span><br><span class="line"></span><br><span class="line"><span class="comment"># config/envs/development.coffee</span></span><br><span class="line">Common = <span class="built_in">require</span>(<span class="string">'./common'</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Development</span> <span class="keyword">extends</span> <span class="title">Common</span></span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = Development</span><br><span class="line"></span><br><span class="line"><span class="comment"># config/envs/test.coffee</span></span><br><span class="line">Common = <span class="built_in">require</span>(<span class="string">'./common'</span>)  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> <span class="keyword">extends</span> <span class="title">Common</span></span></span><br><span class="line">  database: <span class="string">"sample_app_test"</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = Test</span><br><span class="line"></span><br><span class="line"><span class="comment"># config/envs/cucumber.coffee</span></span><br><span class="line">Test = <span class="built_in">require</span>(<span class="string">'./common'</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cucumber</span> <span class="keyword">extends</span> <span class="title">Test</span></span></span><br><span class="line">  database: <span class="string">"sample_app_cucumber"</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = Cucumber</span><br><span class="line"></span><br><span class="line"><span class="comment"># config/envs/production.coffee</span></span><br><span class="line">Common = <span class="built_in">require</span>(<span class="string">'./common'</span>)  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Production</span> <span class="keyword">extends</span> <span class="title">Common</span></span></span><br><span class="line">  database: <span class="string">"sample_app_production"</span></span><br><span class="line">  username: <span class="string">"sample_app"</span></span><br><span class="line">  password: <span class="string">"secret_word"</span></span><br><span class="line">  host: <span class="string">"ec2-10-18-1-115.us-west-2.compute.amazonaws.com"</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = Production</span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2013/02/22/manage-configuration-in-rails-way-on-node-js-by-using-inheritance/" data-id="cinedk72q004fchsiiwexxsih" class="article-share-link">Partager</a>
      
        <a href="http://timnew.me/blog/2013/02/22/manage-configuration-in-rails-way-on-node-js-by-using-inheritance/#disqus_thread" class="article-comment-link">Commentaires</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/configuration/">configuration</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/environment/">environment</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/express/">express</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/inheritance/">inheritance</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/node-js/">node.js</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/rails/">rails</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ruby/">ruby</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/scheme/">scheme</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-how-to-launch-mac-os-terminal-as-interactive-shell-rather-than-log-in-shell" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2012/05/04/how-to-launch-mac-os-terminal-as-interactive-shell-rather-than-log-in-shell/" class="article-date">
  <time datetime="2012-05-04T00:00:00.000Z" itemprop="datePublished">2012-05-04</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/practice/">Practice</a>►<a class="article-category-link" href="/categories/practice/mac/">Mac</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #0A3;"  >
      <a href="http://timnew.me/categories/practice/">Practice</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2012/05/04/how-to-launch-mac-os-terminal-as-interactive-shell-rather-than-log-in-shell/">How to launch Mac OS Terminal as Interactive Shell rather than Log-in Shell</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>As described in <a href="/blog/2012/04/26/bash-profile-on-mac-os-x/">previous post</a>, Mac OS launch its terminal as Log-In shell rather than Interactive Shell, which is different to default behavior of Unix and Linux. As a result, Terminal will load “bash_profile” as its profile rather than the normal “bashrc”.</p>
<p>This unique behavior might cause some problem when you try to port CLI tool from Unix or Linux.<br>Because basically, the ported app infers that the bash_profile should be loaded only once, and only when user just logged in. But in Mac OS, this inference is wrong, which can cause some weird problem.</p>
<p>This default behavior sometimes is annoying, and in fact, this Mac OS Terminal’s “unique” behavior can be configured. And even more, you can use other shell program, such as ksh, rather than the default bash.</p>
<p>Mac user can customize this behavior in Terminal’s Preferences dialog of Terminal app.<br><img src="/blog/2012/05/04/how-to-launch-mac-os-terminal-as-interactive-shell-rather-than-log-in-shell/PreferencesDialog.png" alt="Terminal Preferences Dialog" title="Terminal Preferences Dialog"></p>
<p>If you choose the command to launch bash, the launched shell will become a interactive shell, which will load .bashrc file rather than .bash_profile file.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2012/05/04/how-to-launch-mac-os-terminal-as-interactive-shell-rather-than-log-in-shell/" data-id="cinedk70y001vchsilzxihuna" class="article-share-link">Partager</a>
      
        <a href="http://timnew.me/blog/2012/05/04/how-to-launch-mac-os-terminal-as-interactive-shell-rather-than-log-in-shell/#disqus_thread" class="article-comment-link">Commentaires</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mac/">Mac</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bash/">bash</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/configuration/">configuration</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/shell/">shell</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/terminal/">terminal</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-bash-profile-on-mac-os-x" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2012/04/26/bash-profile-on-mac-os-x/" class="article-date">
  <time datetime="2012-04-26T00:00:00.000Z" itemprop="datePublished">2012-04-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/practice/">Practice</a>►<a class="article-category-link" href="/categories/practice/mac/">Mac</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #0A3;"  >
      <a href="http://timnew.me/categories/practice/">Practice</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2012/04/26/bash-profile-on-mac-os-x/">Bash Profile on Mac OS X</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>In Linux and Unix world, there are 2 common used shell profiles: <code>~/.bashrc</code> and <code>~/.bash_profile</code>. These two profiles are usually used to initialize user bash environment, but there still are some slightly differences between them two.<br>According to <a href="http://linux.die.net/man/1/bash" target="_blank" rel="external">bash manual</a>, <code>.bashrc</code> is “interactive-shell startup file”, and <code>.bash_profile</code> is “login-shell startup file”.</p>
<h3 id="What’s-the-difference-between-interactive-shell-and-login-shell"><a href="#What’s-the-difference-between-interactive-shell-and-login-shell" class="headerlink" title="What’s the difference between interactive-shell and login-shell"></a>What’s the difference between <code>interactive-shell</code> and <code>login-shell</code></h3><p>Basically, the <code>login-shell</code> means the shell opened when user log in via console. It could be the shell opened on local computer after you entered correct user name and password, or the shell opened when you ssh to a remote host.<br>So according to the <code>bash_profile</code> will be loaded only once, that’s right after you logged into a computer, either locally or remotely.</p>
<p>And, on the other hand, the <code>interactive-shell</code> could be more widely used, be seen more often. It is the shell opened after you logged in, such as the shell opened from KDE or Gnome.</p>
<h3 id="Mac-Terminal’s-Pitfall"><a href="#Mac-Terminal’s-Pitfall" class="headerlink" title="Mac Terminal’s Pitfall"></a>Mac Terminal’s Pitfall</h3><p>According to the manual, the Terminal App on Mac is the typical “interactive-shell”, so theoretically Terminal should load “.bashrc” to initialize the shell environment. But the fact is Terminal doesn’t load the “.bashrc”, instead it load “.bash_profile” for initialization.<br>So in a word, Mac’s Terminal doesn’t follow the routine strictly. We need to be aware it.</p>
<p>And not all the shell are interactive! If the shell is not interactive, the Terminal App won’t load the profile file to initialize the environment.<br>A typical non-interactive shell in the shell that TextMate used to run command script, which means in TextMate’s shell, these environment variables, path and even alias you used in you daily life might not be available for TextMate’s command.<br>And also the most hurt one, the rvm function also won’t be available in TextMate’s command shell, which means if you call rake or rails in TextMate’s command script, you are very possibly got error because it cannot find proper gem or other resources.<br>So you should always remember to source and run the “.bash_profile” file or setup these values once again.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2012/04/26/bash-profile-on-mac-os-x/" data-id="cinedk70t001rchsiios6xov6" class="article-share-link">Partager</a>
      
        <a href="http://timnew.me/blog/2012/04/26/bash-profile-on-mac-os-x/#disqus_thread" class="article-comment-link">Commentaires</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mac/">Mac</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bash/">bash</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/configuration/">configuration</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/profile/">profile</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/shell/">shell</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/terminal/">terminal</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-powershell-script-to-serialize-and-deserialize-hash-object-to-and-from-ini-like-text" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2012/04/13/powershell-script-to-serialize-and-deserialize-hash-object-to-and-from-ini-like-text/" class="article-date">
  <time datetime="2012-04-13T00:00:00.000Z" itemprop="datePublished">2012-04-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/powershell/">PowerShell</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2012/04/13/powershell-script-to-serialize-and-deserialize-hash-object-to-and-from-ini-like-text/">Powershell script to serialize and deserialize hash-object to and from ini-like text</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Powershell and .net fx provides a dozen of approaches to manipulate hash-object. And it is really easy and convenient to initialize hash-object with values from environment variables, registry or cli arguments.<br>And Hash-Object can be accessed and built into hierarchy easily, so to use powershell hash-object as deploy configuration is really powerful and convenient.</p>
<p>But in our system, the application uses the ini-like key-value pair plain text as the initial configuration file. So our deploy script need the ability to serialize and deserialize hash-object to and from ini-like config.</p>
<p>So I composed this piece of script.</p>
<script src="//gist.github.com/2373809.js"></script>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2012/04/13/powershell-script-to-serialize-and-deserialize-hash-object-to-and-from-ini-like-text/" data-id="cinedk70n001jchsirsqd3aml" class="article-share-link">Partager</a>
      
        <a href="http://timnew.me/blog/2012/04/13/powershell-script-to-serialize-and-deserialize-hash-object-to-and-from-ini-like-text/#disqus_thread" class="article-comment-link">Commentaires</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/configuration/">configuration</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hash/">hash</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ini/">ini</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/powershell/">powershell</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/script/">script</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/serialization/">serialization</a></li></ul>

    </footer>
  </div>
  
</article>


  


</section>
        
          <aside id="sidebar">
  
    <div class="widget-wrap"><h3 class="widget-title">About Me</h3><div class="widget self-intro"><img src="/images/avatar.png"/><p>Tim is</p><ul class="description"><li>a<span>geek</span></li><li>an spare-time<span>web developer</span></li><li>a part-time<span>mobile developer</span></li><li>a night-time<span>photographer</span></li><li>an early-time<span>pcb solderer</span></li></ul><ul class="social-links"><li><a href="https://linkedin.com/in/timwen" target="_blank" class="linked-in"></a></li><li><a href="https://twitter.com/timnew" target="_blank" class="twitter"></a></li><li><a href="https://github.com/timnew" target="_blank" class="github"></a></li></ul></div></div>
  
    
  <div class="widget-wrap">
    <a href="/posts">
      <h3 class="widget-title">Articles récents</h3>
    </a>
    <div class="widget recent-posts">
      <ul>
        
          <li>
            <a href="/blog/2016/04/23/collection-filtering-algorithm-with-bit-operation-part-1/">Collection Filtering Algorithm with Bit Operation - Part.1</a>
          </li>
        
          <li>
            <a href="/blog/2015/08/14/a-clean-way-to-test-rejected-promise/">A clean way to test rejected promise</a>
          </li>
        
          <li>
            <a href="/blog/2014/12/06/typical-eventbus-design-patterns/">Typical EventBus Design Patterns</a>
          </li>
        
          <li>
            <a href="/blog/2014/11/09/understand-styles-in-android-part-1-what-it-is-for-and-how-to-used-it/">Understand Styles in Android - Part 1. What it is for and how to used it</a>
          </li>
        
          <li>
            <a href="/blog/2014/11/07/walkthrough-untrusted-the-continuing-adventures-of-dr-eval/">Walkthrough: Untrusted - the Continuing Adventures of Dr. Eval</a>
          </li>
        
      </ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <a href="/tags">
      <h3 class="widget-title">Nuage de mot-clés</h3>
    </a>
    <div class="widget tagcloud">
      <a href="/tags/net/" style="font-size: 10px;">.net</a> <a href="/tags/alfred/" style="font-size: 10px;">Alfred</a> <a href="/tags/algorithm/" style="font-size: 10px;">Algorithm</a> <a href="/tags/android/" style="font-size: 20px;">Android</a> <a href="/tags/android-studio/" style="font-size: 10px;">Android Studio</a> <a href="/tags/automation/" style="font-size: 10px;">Automation</a> <a href="/tags/binary/" style="font-size: 10px;">Binary</a> <a href="/tags/bit-operation/" style="font-size: 10px;">Bit Operation</a> <a href="/tags/bit-slicer/" style="font-size: 10px;">Bit Slicer</a> <a href="/tags/bloom-filter/" style="font-size: 10px;">Bloom Filter</a> <a href="/tags/boilerplate/" style="font-size: 10px;">Boilerplate</a> <a href="/tags/c/" style="font-size: 20px;">C#</a> <a href="/tags/ci/" style="font-size: 15px;">CI</a> <a href="/tags/css/" style="font-size: 10px;">CSS</a> <a href="/tags/cheat/" style="font-size: 10px;">Cheat</a> <a href="/tags/cheat-engine/" style="font-size: 10px;">Cheat Engine</a> <a href="/tags/class/" style="font-size: 10px;">Class</a> <a href="/tags/cocoa/" style="font-size: 10px;">Cocoa</a> <a href="/tags/collection/" style="font-size: 10px;">Collection</a> <a href="/tags/command/" style="font-size: 10px;">Command</a> <a href="/tags/continues-delivery/" style="font-size: 10px;">Continues Delivery</a> <a href="/tags/continues-integration/" style="font-size: 10px;">Continues Integration</a> <a href="/tags/crack/" style="font-size: 10px;">Crack</a> <a href="/tags/d/" style="font-size: 10px;">D</a> <a href="/tags/debugger/" style="font-size: 10px;">Debugger</a> <a href="/tags/deploy/" style="font-size: 10px;">Deploy</a> <a href="/tags/deployment/" style="font-size: 10px;">Deployment</a> <a href="/tags/design/" style="font-size: 10px;">Design</a> <a href="/tags/design-pattern/" style="font-size: 10px;">Design Pattern</a> <a href="/tags/event/" style="font-size: 10px;">Event</a>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <a href="/categories">
      <h3 class="widget-title">Catégories</h3>
    </a>
    <div class="widget category-list">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/cracking/">Cracking</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/cracking/game/">Game</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/design/">Design</a><span class="category-list-count">3</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/design/visual/">Visual</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/design/web/">Web</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/game/">Game</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/game/programming-game/">Programming Game</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/geek-toy/">Geek Toy</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/package/">Package</a><span class="category-list-count">4</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/package/chrome-extension/">Chrome Extension</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/package/hexo/">Hexo</a><span class="category-list-count">3</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/">Practice</a><span class="category-list-count">22</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/practice/atom/">Atom</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/chrome/">Chrome</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/continues-integration/">Continues Integration</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/devops/">DevOps</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/hexo/">Hexo</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/mac/">Mac</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/shell/">Shell</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/textmate/">TextMate</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/web/">Web</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/windows/">Windows</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/git/">git</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/">Programming</a><span class="category-list-count">73</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/programming/algorithm/">Algorithm</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/android/">Android</a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/arduino/">Arduino</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/c/">C#</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/chrome/">Chrome</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/design-patterns/">Design Patterns</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/java/">Java</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/javascript/">JavaScript</a><span class="category-list-count">8</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/programming/javascript/coffeescript/">CoffeeScript</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/postgressql/">PostgresSql</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/powershell/">PowerShell</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/regular-expression/">Regular Expression</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/ruby/">Ruby</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/shell/">Shell</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/wpf/">WPF</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/web/">Web</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/node-js/">node.js</a><span class="category-list-count">10</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/thinking/">Thinking</a><span class="category-list-count">5</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <a href="/archives">
      <h3 class="widget-title">Archives</h3>
    </a>
    <div class="widget archive-list">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">December 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">November 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10/">October 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">September 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/08/">August 2014</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/07/">July 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/06/">June 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/05/">May 2014</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/04/">April 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/12/">December 2013</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/10/">October 2013</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/07/">July 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/06/">June 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/04/">April 2013</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/03/">March 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/02/">February 2013</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/01/">January 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/11/">November 2012</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/10/">October 2012</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/08/">August 2012</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/07/">July 2012</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/06/">June 2012</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/05/">May 2012</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/04/">April 2012</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/03/">March 2012</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/02/">February 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/10/">October 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/09/">September 2011</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/05/">May 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/04/">April 2011</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/11/">November 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/09/">September 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/04/">April 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/03/">March 2010</a><span class="archive-list-count">2</span></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 TimNew<br>
      Propulsé by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/#main" class="mobile-nav-link">Home</a>
  
    <a href="/archives/" class="mobile-nav-link">Archives</a>
  
    <a href="/photos/500px.html" class="mobile-nav-link">Photos</a>
  
</nav>
    
<script>
  var disqus_shortname = 'timnew-github';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<!-- <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script> -->
<script src="//code.jquery.com/jquery-2.1.1.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>