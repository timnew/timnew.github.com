<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Archives: 2014/9 | ThoughtWorkshop</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="timnew programming code software">
<meta property="og:type" content="website">
<meta property="og:title" content="ThoughtWorkshop">
<meta property="og:url" content="http://timnew.me/archives/2014/09/index.html">
<meta property="og:site_name" content="ThoughtWorkshop">
<meta property="og:description" content="timnew programming code software">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ThoughtWorkshop">
<meta name="twitter:description" content="timnew programming code software">
<meta name="twitter:creator" content="@timnew">
<link rel="publisher" href="108780866821209050000">
  
    <link rel="alternate" href="/atom.xml" title="ThoughtWorkshop" type="application/atom+xml">
  
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
<link rel="icon" type="image/png" href="/favicon-196x196.png" sizes="196x196">
<link rel="icon" type="image/png" href="/favicon-160x160.png" sizes="160x160">
<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-TileImage" content="/mstile-144x144.png">

  <!-- <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css"> -->
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', '[object Object]', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">ThoughtWorkshop</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Digital Bigs in my thought</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/#main">Home</a>
        
          <a class="main-nav-link" href="/archives/">Archives</a>
        
          <a class="main-nav-link" href="/photos/500px.html">Photos</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="Flux RSS"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Rechercher"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://timnew.me"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-2-modules-android-project-with-robolectric-gradle-android-studio" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2014/09/30/2-modules-android-project-with-robolectric-gradle-android-studio/" class="article-date">
  <time datetime="2014-09-30T05:00:58.000Z" itemprop="datePublished">2014-09-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/android/">Android</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2014/09/30/2-modules-android-project-with-robolectric-gradle-android-studio/">2 Modules Android project with Robolectric, Gradle, Android Studio</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Start a new Android project this week, so I started to setup the development environment. To be honest, it is not an easy experience to me.</p>
<h2 id="Features"><a href="#Features" class="headerlink" title="Features"></a>Features</h2><p>Here are the features I got now:</p>
<ul>
<li>Unit test with Robolectric. (Very fundamental requirement)</li>
<li>Unit tests are separated into an independent module. (Provide flexibility when project growing larger. And provide a more clear view of code organization)</li>
<li>Running unit tests recognized by Android Studio/IntelliJ unit test plugin and debug UTs in IDE. (This is very important when diagnose failure UT)</li>
<li>Running unit tests via CLI with <code>gradle wrapper</code>. (This is necessary requirement for CI servers)</li>
<li>Using resources in Robolectric test. (Avoid <code>Resource Not Found</code> exception in unit tests)</li>
<li>Test Android Annotation powered async implementation. (AA introduces new Async implementation, which is not supported by Robolectric by default)</li>
<li>AssertJ core support. (Fest has been deprecated since no one is maintain it now.)</li>
</ul>
<h2 id="Versions"><a href="#Versions" class="headerlink" title="Versions"></a>Versions</h2><p>The major difficulties that I met are version compatibility, I almost tried all available version combinations to make them all works. Here are the versions that I uses</p>
<ul>
<li>Gradle: 2.1</li>
<li>Groovy: 2.3.6</li>
<li>Ant: 1.9.3</li>
<li>JVM: 1.6.0_65 (Apple Inc. 20.65-b04-462)</li>
<li>OS: Mac OS X 10.9.5 x86_64</li>
<li>Android Studio: 0.8.11 (build AI-135.1446794)</li>
<li>IntelliJ: IDEA 14 CE EAP, build IC-138.2458.8</li>
<li>Android gradle plugin: com.android.tools.build:gradle:0.13.0</li>
<li>Android ADT gradle plugin: com.neenbedankt.gradle.plugins:android-apt:1.4+</li>
<li>Compile SDK version: 20</li>
<li>Build tool version: 20.0.0</li>
<li>Robolectric: 2.3</li>
</ul>
<h1 id="Known-Issues"><a href="#Known-Issues" class="headerlink" title="Known Issues"></a>Known Issues</h1><p>My current solution isn’t perfect. But for now, I haven’t working solution for them. Hope it could be fixed in the future</p>
<ul>
<li><code>AAR</code> is not supported in Unit Test. (A tricky issue, I’ll explain more in detail later)</li>
<li><a href="https://github.com/square/assertj-android" target="_blank" rel="external">AssertJ-Android</a> is not supported. (Cause by AAR support issue, alternative available.)</li>
</ul>
<h2 id="Project-Structure-and-configurations"><a href="#Project-Structure-and-configurations" class="headerlink" title="Project Structure and configurations"></a>Project Structure and configurations</h2><p>Here are the project structure:<br><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">RootProject</span><br><span class="line"><span class="string">|- settings.gradle</span></span><br><span class="line"><span class="string">|- build.gradle</span></span><br><span class="line"><span class="string">|- Launcher</span></span><br><span class="line">   \- builde.gradle</span><br><span class="line">\- UnitTest</span><br><span class="line">   <span class="string">|- build.gradle</span></span><br><span class="line">   \- UnitTest.iml</span><br></pre></td></tr></table></figure></p>
<p>Here are the contents</p>
<figure class="highlight gradle"><figcaption><span>\Settings.gradle</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span> <span class="string">':Launcher'</span>, <span class="string">':UnitTest'</span></span><br></pre></td></tr></table></figure>
<figure class="highlight gradle"><figcaption><span>\build.gradle</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">buildscript</span> &#123;</span><br><span class="line">    <span class="keyword">repositories</span> &#123;</span><br><span class="line">        mavenCentral()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">dependencies</span> &#123;</span><br><span class="line">        <span class="keyword">classpath</span> <span class="string">'com.android.tools.build:gradle:0.13.0'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">allprojects</span> &#123;</span><br><span class="line">    <span class="keyword">repositories</span> &#123;</span><br><span class="line">        mavenLocal()</span><br><span class="line">        mavenCentral()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight gradle"><figcaption><span>\Launcher\build.gradle</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">buildscript</span> &#123;</span><br><span class="line">    <span class="keyword">repositories</span> &#123;</span><br><span class="line">        mavenCentral()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">dependencies</span> &#123;</span><br><span class="line">        <span class="keyword">classpath</span> <span class="string">'com.android.tools.build:gradle:0.13.0'</span></span><br><span class="line">        <span class="keyword">classpath</span> <span class="string">'com.neenbedankt.gradle.plugins:android-apt:1.4+'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">repositories</span> &#123;</span><br><span class="line">    mavenLocal()</span><br><span class="line">    mavenCentral()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">apply plugin: <span class="string">'com.android.application'</span></span><br><span class="line">apply plugin: <span class="string">'android-apt'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">android &#123;</span><br><span class="line">    compileSdkVersion <span class="number">20</span></span><br><span class="line">    buildToolsVersion <span class="string">'20.0.0'</span></span><br><span class="line"></span><br><span class="line">    defaultConfig &#123;</span><br><span class="line">        minSdkVersion <span class="number">9</span></span><br><span class="line">        targetSdkVersion <span class="number">19</span></span><br><span class="line">        versionCode <span class="number">1</span></span><br><span class="line">        versionName <span class="string">"1.0"</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    buildTypes &#123;</span><br><span class="line">        debug &#123;</span><br><span class="line">            runProguard <span class="keyword">false</span></span><br><span class="line">            proguardFiles getDefaultProguardFile(<span class="string">'proguard-android.txt'</span>), <span class="string">'proguard-rules.txt'</span></span><br><span class="line">        &#125;</span><br><span class="line">        release &#123;</span><br><span class="line">            runProguard <span class="keyword">false</span></span><br><span class="line">            proguardFiles getDefaultProguardFile(<span class="string">'proguard-android.txt'</span>), <span class="string">'proguard-rules.txt'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">apt &#123;</span><br><span class="line">    arguments &#123;</span><br><span class="line">        androidManifestFile variant.processResources.manifestFile</span><br><span class="line">        resourcePackageName <span class="string">'me.timnew.game.launcher'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> AAVersion = <span class="string">'3.1'</span></span><br><span class="line"><span class="keyword">dependencies</span> &#123;</span><br><span class="line">    apt <span class="string">"org.androidannotations:androidannotations:$AAVersion"</span>         <span class="comment">// Process AA annotations</span></span><br><span class="line">    <span class="comment">/*</span><br><span class="line">    * Android Studio will remove this line if you try to edit project configuration with GUI.</span><br><span class="line">    * It seems it is a bug of Android Studio since it does not understand DSL `apt`</span><br><span class="line">    */</span></span><br><span class="line">    <span class="keyword">compile</span> <span class="string">"org.androidannotations:androidannotations-api:$AAVersion"</span> <span class="comment">// AA Runtime API. Becareful</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">compile</span> <span class="string">'de.greenrobot:eventbus:2.2.1'</span></span><br><span class="line">    <span class="keyword">compile</span> <span class="string">'org.easytesting:fest-reflect:1.4.1'</span></span><br><span class="line">    <span class="keyword">compile</span> <span class="string">'com.google.guava:guava:18.0'</span></span><br><span class="line">    <span class="keyword">compile</span> <span class="string">'com.koushikdutta.ion:ion:1.3.8'</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">compile</span> <span class="keyword">fileTree</span>(dir: <span class="string">'libs'</span>, <span class="keyword">include</span>: [<span class="string">'*.jar'</span>, <span class="string">'*.aar'</span>]) <span class="comment">// Well although I mentioned aar here, but it doesn't load correctly.</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">compile</span> <span class="string">'com.android.support:support-v4:20.0.0'</span></span><br><span class="line">    <span class="keyword">compile</span> <span class="string">'com.android.support:support-annotations:20.0.0'</span></span><br><span class="line">    <span class="keyword">compile</span> <span class="string">'com.android.support:appcompat-v7:20.0.0'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight gradle"><figcaption><span>\UnitTest\build.gradle</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">buildscript</span> &#123;</span><br><span class="line">    <span class="keyword">repositories</span> &#123;</span><br><span class="line">        mavenCentral()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">dependencies</span> &#123;</span><br><span class="line">        <span class="keyword">classpath</span> <span class="string">'com.android.tools.build:gradle:0.13.0'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">apply plugin: <span class="string">'java'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">repositories</span> &#123;</span><br><span class="line">    mavenLocal()</span><br><span class="line">    maven &#123; url <span class="string">"$System.env.ANDROID_HOME/extras/android/m2repository"</span> &#125; <span class="comment">// Fix 'com.android.support:*' package not found issue</span></span><br><span class="line">    mavenCentral()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">dependencies</span> &#123;</span><br><span class="line">    <span class="keyword">def</span> appModule = <span class="keyword">project</span>(<span class="string">':Launcher'</span>)</span><br><span class="line">    <span class="keyword">compile</span> appModule</span><br><span class="line"></span><br><span class="line">    testCompile appModule.android.applicationVariants.<span class="keyword">toList</span>().first().javaCompile.<span class="keyword">classpath</span>       <span class="comment">// Include classes from main project</span></span><br><span class="line">    testCompile appModule.android.applicationVariants.<span class="keyword">toList</span>().first().javaCompile.outputs.files</span><br><span class="line">    testCompile files(appModule.plugins.findPlugin(<span class="string">"com.android.application"</span>).getBootClasspath())</span><br><span class="line"></span><br><span class="line">    testCompile(<span class="string">'junit:junit:4.+'</span>) &#123;</span><br><span class="line">        <span class="keyword">exclude</span> module: <span class="string">'hamcrest-core'</span>                                                            <span class="comment">// Exclude problematic 'hamcrest'</span></span><br><span class="line">    &#125;</span><br><span class="line">    testCompile <span class="string">'org.robolectric:robolectric:2.3'</span></span><br><span class="line">    testCompile <span class="string">'org.mockito:mockito-core:1.9.5'</span></span><br><span class="line">    testCompile <span class="string">'org.assertj:assertj-core:1.6.1'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">tasks.withType(Test) &#123;</span><br><span class="line">    scanForTestClasses = <span class="keyword">false</span></span><br><span class="line">    <span class="keyword">include</span> <span class="string">"**/*Should.class"</span></span><br><span class="line">    <span class="keyword">include</span> <span class="string">"**/*Test.class"</span></span><br><span class="line">    <span class="keyword">include</span> <span class="string">"**/*Tests.class"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Why-uses-java-plug-in-instead-of-android-unit-test-plug-ins"><a href="#Why-uses-java-plug-in-instead-of-android-unit-test-plug-ins" class="headerlink" title="Why uses java plug-in instead of android unit test plug-ins"></a>Why uses <code>java</code> plug-in instead of <code>android unit test</code> plug-ins</h2><p>Well, Gradle DSL provides a lot of flexibility to developer. But it also brought a lot complexity to IDE implementation. To figure out project configuration, IDE need to parse and understand the gradle scripts. Not only DSLs provided by gradle but all stuff come with plug-ins. From IDE, this is almost an impossible mission. So IDE need to figure out a way to simplify the process, such as support a subset of DSL.</p>
<p>For Android project, IntelliJ has difficulties to understand the all variations of <code>android unit test</code> plug-ins. So it is not easy to make unit test runnable from IDE. To solve the issue, you either try to teach IDE about the DSL by providing plug-in to IDE, or uses some languages that IDE understood.</p>
<p>I tried some plug-in available today, but none of them works for me. So I decide to use <code>java</code> DSL, which IntelliJ understood natively. As a trade off, since <code>java</code> gradle plugin doesn’t understand <code>Android Library</code>, so it cannot import <code>.aar</code> libries.</p>
<p>Besides I tried all <code>android unit test</code> gradle plugins, I found all of them depends on <code>android</code> gradle plugin. And <code>android</code> plugin depends on <code>AndroidManifest.xml</code> and some other stuff. It is wield to provide an manifest for your unit test.</p>
<p>So as the final solution, I uses <code>java</code> plug-in, avoid using <code>aar</code> in the test.</p>
<h2 id="Why-so-complicate"><a href="#Why-so-complicate" class="headerlink" title="Why so complicate"></a>Why so complicate</h2><p>Configurate an working Android project isn’t as easy as it sounds. Differ from iOS community, Google isn’t strong-minded as Apple. As a consequence that Android community is fragmented and lack of unified solution. There are tons of solutions available, but you might need to try them one by one to figure out which fits your requirement.</p>
<p>To make your tool chain, dependencies, IDE work together, compatibility is always your enemy. Even Google has to publish <a href="http://tools.android.com/tech-docs/new-build-system/version-compatibility" target="_blank" rel="external">Version Compatibility Table</a> to mitigate the pain.</p>
<p>What a mess!!!!!</p>
<h2 id="References-posts-plugins-or-template-projects"><a href="#References-posts-plugins-or-template-projects" class="headerlink" title="References posts, plugins or template projects"></a>References posts, plugins or template projects</h2><p>Here is a list of things that I tried but failed to fit my requirement. List here since it might be helpful to other people.</p>
<ul>
<li><a href="http://blog.blundell-apps.com/android-gradle-app-with-robolectric-junit-tests/" target="_blank" rel="external">Android Gradle App with Robolectric JUnit tests</a></li>
<li><a href="https://github.com/blundell/tests-app-robolectric-junit" target="_blank" rel="external">tests-app-robolectric-junit</a> template project</li>
<li><a href="https://github.com/robolectric/deckard-gradle" target="_blank" rel="external">deckard-gradle</a> template project</li>
<li><a href="https://github.com/JCAndKSolutions/android-unit-test" target="_blank" rel="external">android-unit-test</a> gradle plug in</li>
<li><a href="https://github.com/evant/android-studio-unit-test-plugin" target="_blank" rel="external">android-studio-unit-test-plugin</a> android studio/intellij plugin</li>
<li><a href="https://github.com/robolectric/robolectric-gradle-plugin" target="_blank" rel="external">robolectric-gradle-plugin</a></li>
<li><a href="https://github.com/novoda/robolectric-plugin" target="_blank" rel="external">robolectric-plugin</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2014/09/30/2-modules-android-project-with-robolectric-gradle-android-studio/" data-id="cinedk75k0095chsiknacm3hi" class="article-share-link">Partager</a>
      
        <a href="http://timnew.me/blog/2014/09/30/2-modules-android-project-with-robolectric-gradle-android-studio/#disqus_thread" class="article-comment-link">Commentaires</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android-studio/">Android Studio</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/boilerplate/">Boilerplate</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/gradle/">Gradle</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/project/">Project</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/robolectric/">Robolectric</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/structure/">Structure</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/unit-test/">Unit Test</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-trello-confetti-effect" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2014/09/24/trello-confetti-effect/" class="article-date">
  <time datetime="2014-09-24T05:13:33.000Z" itemprop="datePublished">2014-09-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/web/">Web</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2014/09/24/trello-confetti-effect/">Trello Confetti Effect</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://trello.com" target="_blank" rel="external">Trello</a> just created a <a href="https://trello.com/5m" target="_blank" rel="external">page</a> to celebrate their user number reaches 5 million. In their celebration page, they introduce an interesting effect, a number of blue squares rotating and falling from the sky.</p>
<p>By inspecting their source code, I extracted the effect implementation from the page.</p>
<iframe id="cp_embed_tlEBe" src="//codepen.io/timnew/embed/tlEBe?height=500&theme-id=7928&slug-hash=tlEBe&default-tab=result" scrolling="no" frameborder="no" height="500" allowtransparency="true" allowfullscreen="true" class="cp_embed_iframe" style="width: 100%; overflow: hidden;"></iframe>
<p>As you can see, the effect is implemented with Canvas animation. Trello guys created a light weight particle system.</p>
<ul>
<li><code>ConfettiMachine</code> is the particle system controller, which takes the responsibility to create new particles and call <code>draw</code> method on them one by one.</li>
<li><code>Particle</code> is the representation of the blue square, it takes the rotation, fading out and rendering.</li>
</ul>
<p>The source code is extracted for study purpose, all code and credits belongs to Trello guys.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2014/09/24/trello-confetti-effect/" data-id="cinedk75i0091chsilokb3u71" class="article-share-link">Partager</a>
      
        <a href="http://timnew.me/blog/2014/09/24/trello-confetti-effect/#disqus_thread" class="article-comment-link">Commentaires</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/animation/">animation</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/canvas/">canvas</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/confetti/">confetti</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/draw/">draw</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/effect/">effect</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/particle/">particle</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/trello/">trello</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-otto-and-android-annotations-compatibility-issue-analysis" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2014/09/14/otto-and-android-annotations-compatibility-issue-analysis/" class="article-date">
  <time datetime="2014-09-14T08:14:22.000Z" itemprop="datePublished">2014-09-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/programming/">Programming</a>►<a class="article-category-link" href="/categories/programming/android/">Android</a>
  </div>

  </div>
  <div class="article-inner">
    
  
  <div class="ribbon-wrapper relative right">
    <div class="ribbon "  style="background-color: #40A;"  >
      <a href="http://timnew.me/categories/programming/">Programming</a>
    </div>
  </div>


    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/blog/2014/09/14/otto-and-android-annotations-compatibility-issue-analysis/">Otto and Android Annotations Compatibility Issue Analysis</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p><a href="https://github.com/square/otto" target="_blank" rel="external">Otto</a> is a great Android event bus solution developed by <a href="http://square.github.io/" target="_blank" rel="external">SquareUp</a> guys. These guys extract the event bus related classes from <a href="https://code.google.com/p/guava-libraries/" target="_blank" rel="external">Google’s Guava</a>, and optimized it for Android. Event Bus is a great solution to keep your code away from messy anonymous or internal classes only used for event handling! And Otto’s simplicity and performance makes it used to be the most popular event bus solution in Android development.</p>
<p><a href="http://androidannotations.org/" target="_blank" rel="external">Android Annotations</a>, as known as <code>AA</code>, is another great library that makes Android developers’ lives a lot easier. Just annotating the code, AA helps developer handles the most boring or error-proning tasks for you, including binding widgets binding, asynchronous tasks, life time management, etc…</p>
<h2 id="Issue"><a href="#Issue" class="headerlink" title="Issue"></a>Issue</h2><p>Otto and AA are the libraries focusing on different aspects. Theoretically speaking, there shouldn’t be any compatibility issue between them. But the reality Otto event is never delivered to AA annotated classes. By inspecting the code with step by step debugging, I found the root cause of the issue is Otto failed to located <code>@Produce</code> and <code>@Subscribe</code> annotated methods in AA generated code.</p>
<h2 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h2><p>After a few study work, I finally understood what is the reason behind:</p>
<p>For performance consideration, Android Annotations actually does it work during the compilation time instead of Runtime. AA will derive the annotated classes, and generate some code according to the annotations applied. During the runtime, the classes got instantiated is actually the derived classes instead of the original one, although in the code is accessed via the original class as interface.</p>
<p>Here is a simple example:</p>
<p>I have the class <code>ServerListAdapter</code>, which is used to provide data for a grid view.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EBean</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServerListAdapter</span> <span class="keyword">extends</span> <span class="title">AdvBaseAdapter</span>&lt;<span class="title">InetAddress</span>, <span class="title">ServerView</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RootContext</span></span><br><span class="line">    <span class="keyword">protected</span> Context context;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@SystemService</span></span><br><span class="line">    <span class="keyword">protected</span> LayoutInflater inflater;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">protected</span> Bus bus;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ServerListAdapter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(<span class="keyword">new</span> ArrayList&lt;InetAddress&gt;());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterInject</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">afterInject</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        bus.register(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> ServerView <span class="title">createView</span><span class="params">(ViewGroup parent)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ServerView_.build(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> ServerView <span class="title">updateView</span><span class="params">(ServerView itemView, InetAddress item)</span> </span>&#123;</span><br><span class="line">        itemView.update(item);</span><br><span class="line">        <span class="keyword">return</span> itemView;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Subscribe</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fetchServerStatus</span><span class="params">(DiscoveryStatusEvent event)</span> </span>&#123;</span><br><span class="line">        setItems(event.addresses);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Subscribe</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onServerStatusUpdated</span><span class="params">(DiscoveryStatusChangedEvent event)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (event.type) &#123;</span><br><span class="line">            <span class="keyword">case</span> SERVER_ONLINE:</span><br><span class="line">                getItems().add(event.address);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> SERVER_OFFLINE:</span><br><span class="line">                getItems().remove(event.address);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        notifyDataSetChanged();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>And this is the derived class generated by <code>AA</code> during the compiling-time:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">ServerListAdapter_</span></span><br><span class="line">    <span class="keyword">extends</span> <span class="title">ServerListAdapter</span></span><br><span class="line"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Context context_;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">ServerListAdapter_</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        context_ = context;</span><br><span class="line">        init_();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ServerListAdapter_ <span class="title">getInstance_</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ServerListAdapter_(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init_</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        inflater = ((LayoutInflater) context_.getSystemService(Context.LAYOUT_INFLATER_SERVICE));</span><br><span class="line">        context = context_;</span><br><span class="line">        bus = Bus_.getInstance_(context_);</span><br><span class="line">        afterInject();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rebind</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        context_ = context;</span><br><span class="line">        init_();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>And here is how it is consumed:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EFragment</span>(R.layout.fragment_server_list)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServerListFragment</span> <span class="keyword">extends</span> <span class="title">Fragment</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">protected</span> DiscoveryService discoveryService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">protected</span> ServerListAdapter adapter;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ViewById</span>(R.id.server_list)</span><br><span class="line">    <span class="keyword">protected</span> GridView serverGridView;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterViews</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">afterViews</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        serverGridView.setAdapter(adapter);</span><br><span class="line"></span><br><span class="line">        discoveryService.start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDetach</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onDetach();</span><br><span class="line">        discoveryService.stop();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>As you can see, in the <code>ServerListFragment</code>, the <code>ServerListAdapter</code> instance injected into <code>bean</code> is actually the instance of <code>ServerListAdapter_</code>. And due to polymorphic, the instance just behaves like a <code>ServerListAdapter</code> instance.</p>
<p>On the other hand, according to the description on <a href="http://square.github.io/otto/" target="_blank" rel="external">Otto’s Home Page</a>:</p>
<blockquote><p>In order to receive events, a class instance needs to register with the bus.<br>…<br>Registering will only find methods on the immediate class type. Unlike the Guava event bus, Otto will not traverse the class hierarchy and add methods from base classes or interfaces that are annotated. This is an explicit design decision to improve performance of the library as well as keep your code simple and unambiguous.</p>
<footer><strong>@Otto</strong><cite><a href="http://square.github.io/otto/" target="_blank" rel="external">Otto Homepage</a></cite></footer></blockquote>
<p>Otto only search annotations in direct class, which is <code>ServerListAdapter_</code> in instance, and there isn’t any annotation included. As a consequence, all the <code>@Subscribe</code> annotated methods are ignored by <code>com.squareup.otto.AnnotatedHandlerFinder</code>. So the posted events become <code>dead event</code> due to no subscriber found.</p>
<h2 id="Comments"><a href="#Comments" class="headerlink" title="Comments"></a>Comments</h2><p>There is <a href="https://github.com/square/otto/issues/61" target="_blank" rel="external">rumor</a> that this issue will be fixed in <code>Otto 2.0</code>. But according to the <a href="https://github.com/square/otto/issues/61#issuecomment-44453104" target="_blank" rel="external">comment</a> from <a href="https://github.com/JakeWharton" target="_blank" rel="external">Jake Wharton</a>, Otto’s developer, <code>Otto 2.0</code> will take forever to release.</p>
<p>In fact <a href="https://github.com/square/otto/tree/2.0-wip" target="_blank" rel="external">Otto 2.0 Repo</a> has been not touched for 2 years already. Although we could check out the code and build Otto 2.0 by ourselves, but it takes efforts. Especially when some bug is found.</p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Luckily, although <code>Otto</code> turns into “maintenance mode”, the compatibility issue takes forever to resolve. I found a great Otto alternative, EventBus from GreenRobot. A boring name, but great library.</p>
<p>According to <code>EventBus</code>‘s document, it provides richer feature and better performance than <code>Otto</code>.<br>The most important <code>EventBus</code> is friendly to <code>AndroidAnnoations</code>. They two works well together.</p>
<h3 id="EventBus-and-Otto-Feature-Comparison"><a href="#EventBus-and-Otto-Feature-Comparison" class="headerlink" title="EventBus and Otto Feature Comparison"></a>EventBus and Otto Feature Comparison</h3><table>
<thead>
<tr>
<th></th>
<th>EventBus</th>
<th>Otto</th>
</tr>
</thead>
<tbody>
<tr>
<td>Declare event handling methods</td>
<td>Name conventions</td>
<td>Annotations</td>
</tr>
<tr>
<td>Event inheritance</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td>Subscriber inheritance</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td>Cache most recent events</td>
<td>Yes, sticky events</td>
<td>No</td>
</tr>
<tr>
<td>Event producers (e.g. for coding cached events)</td>
<td>No</td>
<td>Yes</td>
</tr>
<tr>
<td>Event delivery in posting thread</td>
<td>Yes (Default)</td>
<td>Yes</td>
</tr>
<tr>
<td>Event delivery in main thread</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td>Event delivery in background thread</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td>Asynchronous event delivery</td>
<td>Yes</td>
<td>No</td>
</tr>
</tbody>
</table>
<h3 id="EventBus-and-Otto-Performance-Comparison"><a href="#EventBus-and-Otto-Performance-Comparison" class="headerlink" title="EventBus and Otto Performance Comparison"></a>EventBus and Otto Performance Comparison</h3><table>
<thead>
<tr>
<th></th>
<th>EventBus over Otto</th>
</tr>
</thead>
<tbody>
<tr>
<td>Posting 1000 events, Android 2.3 emulator</td>
<td>~70% faster</td>
</tr>
<tr>
<td>Posting 1000 events, S3 Android 4.0</td>
<td>~110% faster</td>
</tr>
<tr>
<td>Register 1000 subscribers, Android 2.3 emulator</td>
<td>~10% faster</td>
</tr>
<tr>
<td>Register 1000 subscribers, S3 Android 4.0</td>
<td>~70% faster</td>
</tr>
<tr>
<td>Register subscribers cold start, Android 2.3 emulator</td>
<td>~350% faster</td>
</tr>
<tr>
<td>Register subscribers cold start, S3 Android 4.0</td>
<td>About the same</td>
</tr>
</tbody>
</table>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://timnew.me/blog/2014/09/14/otto-and-android-annotations-compatibility-issue-analysis/" data-id="cinedk75g008xchsiyjsqu937" class="article-share-link">Partager</a>
      
        <a href="http://timnew.me/blog/2014/09/14/otto-and-android-annotations-compatibility-issue-analysis/#disqus_thread" class="article-comment-link">Commentaires</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android-annotations/">android annotations</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/event/">event</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/event-bus/">event bus</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/google/">google</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/greenbot/">greenbot</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/guava/">guava</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/otto/">otto</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/programming/">programming</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pub-sub/">pub & sub</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/squareup/">squareUp</a></li></ul>

    </footer>
  </div>
  
</article>


  


</section>
        
          <aside id="sidebar">
  
    <div class="widget-wrap"><h3 class="widget-title">About Me</h3><div class="widget self-intro"><img src="/images/avatar.png"/><p>Tim is</p><ul class="description"><li>a<span>geek</span></li><li>an spare-time<span>web developer</span></li><li>a part-time<span>mobile developer</span></li><li>a night-time<span>photographer</span></li><li>an early-time<span>pcb solderer</span></li></ul><ul class="social-links"><li><a href="https://linkedin.com/in/timwen" target="_blank" class="linked-in"></a></li><li><a href="https://twitter.com/timnew" target="_blank" class="twitter"></a></li><li><a href="https://github.com/timnew" target="_blank" class="github"></a></li></ul></div></div>
  
    
  <div class="widget-wrap">
    <a href="/posts">
      <h3 class="widget-title">Articles récents</h3>
    </a>
    <div class="widget recent-posts">
      <ul>
        
          <li>
            <a href="/blog/2016/04/23/collection-filtering-algorithm-with-bit-operation-part-1/">Collection Filtering Algorithm with Bit Operation - Part.1</a>
          </li>
        
          <li>
            <a href="/blog/2015/08/14/a-clean-way-to-test-rejected-promise/">A clean way to test rejected promise</a>
          </li>
        
          <li>
            <a href="/blog/2014/12/06/typical-eventbus-design-patterns/">Typical EventBus Design Patterns</a>
          </li>
        
          <li>
            <a href="/blog/2014/11/09/understand-styles-in-android-part-1-what-it-is-for-and-how-to-used-it/">Understand Styles in Android - Part 1. What it is for and how to used it</a>
          </li>
        
          <li>
            <a href="/blog/2014/11/07/walkthrough-untrusted-the-continuing-adventures-of-dr-eval/">Walkthrough: Untrusted - the Continuing Adventures of Dr. Eval</a>
          </li>
        
      </ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <a href="/tags">
      <h3 class="widget-title">Nuage de mot-clés</h3>
    </a>
    <div class="widget tagcloud">
      <a href="/tags/net/" style="font-size: 10px;">.net</a> <a href="/tags/alfred/" style="font-size: 10px;">Alfred</a> <a href="/tags/algorithm/" style="font-size: 10px;">Algorithm</a> <a href="/tags/android/" style="font-size: 20px;">Android</a> <a href="/tags/android-studio/" style="font-size: 10px;">Android Studio</a> <a href="/tags/automation/" style="font-size: 10px;">Automation</a> <a href="/tags/binary/" style="font-size: 10px;">Binary</a> <a href="/tags/bit-operation/" style="font-size: 10px;">Bit Operation</a> <a href="/tags/bit-slicer/" style="font-size: 10px;">Bit Slicer</a> <a href="/tags/bloom-filter/" style="font-size: 10px;">Bloom Filter</a> <a href="/tags/boilerplate/" style="font-size: 10px;">Boilerplate</a> <a href="/tags/c/" style="font-size: 20px;">C#</a> <a href="/tags/ci/" style="font-size: 15px;">CI</a> <a href="/tags/css/" style="font-size: 10px;">CSS</a> <a href="/tags/cheat/" style="font-size: 10px;">Cheat</a> <a href="/tags/cheat-engine/" style="font-size: 10px;">Cheat Engine</a> <a href="/tags/class/" style="font-size: 10px;">Class</a> <a href="/tags/cocoa/" style="font-size: 10px;">Cocoa</a> <a href="/tags/collection/" style="font-size: 10px;">Collection</a> <a href="/tags/command/" style="font-size: 10px;">Command</a> <a href="/tags/continues-delivery/" style="font-size: 10px;">Continues Delivery</a> <a href="/tags/continues-integration/" style="font-size: 10px;">Continues Integration</a> <a href="/tags/crack/" style="font-size: 10px;">Crack</a> <a href="/tags/d/" style="font-size: 10px;">D</a> <a href="/tags/debugger/" style="font-size: 10px;">Debugger</a> <a href="/tags/deploy/" style="font-size: 10px;">Deploy</a> <a href="/tags/deployment/" style="font-size: 10px;">Deployment</a> <a href="/tags/design/" style="font-size: 10px;">Design</a> <a href="/tags/design-pattern/" style="font-size: 10px;">Design Pattern</a> <a href="/tags/event/" style="font-size: 10px;">Event</a>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <a href="/categories">
      <h3 class="widget-title">Catégories</h3>
    </a>
    <div class="widget category-list">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/cracking/">Cracking</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/cracking/game/">Game</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/design/">Design</a><span class="category-list-count">3</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/design/visual/">Visual</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/design/web/">Web</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/game/">Game</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/game/programming-game/">Programming Game</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/geek-toy/">Geek Toy</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/package/">Package</a><span class="category-list-count">4</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/package/chrome-extension/">Chrome Extension</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/package/hexo/">Hexo</a><span class="category-list-count">3</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/">Practice</a><span class="category-list-count">22</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/practice/atom/">Atom</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/chrome/">Chrome</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/continues-integration/">Continues Integration</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/devops/">DevOps</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/hexo/">Hexo</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/mac/">Mac</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/shell/">Shell</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/textmate/">TextMate</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/web/">Web</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/windows/">Windows</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/practice/git/">git</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/">Programming</a><span class="category-list-count">73</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/programming/algorithm/">Algorithm</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/android/">Android</a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/arduino/">Arduino</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/c/">C#</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/chrome/">Chrome</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/design-patterns/">Design Patterns</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/java/">Java</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/javascript/">JavaScript</a><span class="category-list-count">8</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/programming/javascript/coffeescript/">CoffeeScript</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/postgressql/">PostgresSql</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/powershell/">PowerShell</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/regular-expression/">Regular Expression</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/ruby/">Ruby</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/shell/">Shell</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/wpf/">WPF</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/web/">Web</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming/node-js/">node.js</a><span class="category-list-count">10</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/thinking/">Thinking</a><span class="category-list-count">5</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <a href="/archives">
      <h3 class="widget-title">Archives</h3>
    </a>
    <div class="widget archive-list">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">December 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">November 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10/">October 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">September 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/08/">August 2014</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/07/">July 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/06/">June 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/05/">May 2014</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/04/">April 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/12/">December 2013</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/10/">October 2013</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/07/">July 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/06/">June 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/04/">April 2013</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/03/">March 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/02/">February 2013</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/01/">January 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/11/">November 2012</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/10/">October 2012</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/08/">August 2012</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/07/">July 2012</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/06/">June 2012</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/05/">May 2012</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/04/">April 2012</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/03/">March 2012</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/02/">February 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/10/">October 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/09/">September 2011</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/05/">May 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/04/">April 2011</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/11/">November 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/09/">September 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/04/">April 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/03/">March 2010</a><span class="archive-list-count">2</span></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 TimNew<br>
      Propulsé by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/#main" class="mobile-nav-link">Home</a>
  
    <a href="/archives/" class="mobile-nav-link">Archives</a>
  
    <a href="/photos/500px.html" class="mobile-nav-link">Photos</a>
  
</nav>
    
<script>
  var disqus_shortname = 'timnew-github';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<!-- <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script> -->
<script src="//code.jquery.com/jquery-2.1.1.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>